import{U as b,r as k,a as J,j as a}from"./index-DotS8Uwj.js";import{H as ft}from"./Helmet-BBvg7tzo.js";import{C as yt}from"./calendar-Ccc7XiXZ.js";import{D as vt}from"./dollar-sign-WXM3KTdc.js";import{P as xt}from"./package-BA-G3ErA.js";import{T as gt}from"./trending-up-k-iJ-K1w.js";import{j as bt,D as jt,p as At,E as St,L as G,f as z,a as wt,A as Pt,b as F,e as Nt,c as H,h as kt,g as Et,k as ot,u as Ot,G as Dt,l as Q,n as st,X as M,Y,o as lt,B as ct,R as Z,C as tt,T as et}from"./generateCategoricalChart-BFH-mkhI.js";import{c as rt}from"./clsx-B-dksMZM.js";import"./createLucideIcon-D9q1tf3H.js";import"./tiny-invariant-CopsF_GD.js";var _t=["type","layout","connectNulls","ref"],Ct=["key"];function _(t){"@babel/helpers - typeof";return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_(t)}function nt(t,r){if(t==null)return{};var n=Lt(t,r),e,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)e=l[i],!(r.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(t,e)&&(n[e]=t[e])}return n}function Lt(t,r){if(t==null)return{};var n={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){if(r.indexOf(e)>=0)continue;n[e]=t[e]}return n}function $(){return $=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t},$.apply(this,arguments)}function at(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,e)}return n}function A(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?at(Object(n),!0).forEach(function(e){S(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function D(t){return Ft(t)||It(t)||Bt(t)||Tt()}function Tt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bt(t,r){if(t){if(typeof t=="string")return X(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(t,r)}}function It(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ft(t){if(Array.isArray(t))return X(t)}function X(t,r){(r==null||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}function $t(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function it(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,dt(e.key),e)}}function Rt(t,r,n){return r&&it(t.prototype,r),n&&it(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wt(t,r,n){return r=U(r),Kt(t,ut()?Reflect.construct(r,n||[],U(t).constructor):r.apply(t,n))}function Kt(t,r){if(r&&(_(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zt(t)}function zt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ut=function(){return!!t})()}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},U(t)}function Mt(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&q(t,r)}function q(t,r){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},q(t,r)}function S(t,r,n){return r=dt(r),r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function dt(t){var r=Yt(t,"string");return _(r)=="symbol"?r:r+""}function Yt(t,r){if(_(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var e=n.call(t,r);if(_(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var R=function(t){function r(){var n;$t(this,r);for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];return n=Wt(this,r,[].concat(i)),S(n,"state",{isAnimationFinished:!0,totalLength:0}),S(n,"generateSimpleStrokeDasharray",function(o,c){return"".concat(c,"px ").concat(o-c,"px")}),S(n,"getStrokeDasharray",function(o,c,h){var m=h.reduce(function(u,g){return u+g});if(!m)return n.generateSimpleStrokeDasharray(c,o);for(var y=Math.floor(o/m),v=o%m,d=c-o,f=[],p=0,x=0;p<h.length;x+=h[p],++p)if(x+h[p]>v){f=[].concat(D(h.slice(0,p)),[v-x]);break}var s=f.length%2===0?[0,d]:[d];return[].concat(D(r.repeat(h,y)),D(f),s).map(function(u){return"".concat(u,"px")}).join(", ")}),S(n,"id",Ot("recharts-line-")),S(n,"pathRef",function(o){n.mainCurve=o}),S(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),S(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Mt(r,t),Rt(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();this.setState({totalLength:e})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();e!==this.state.totalLength&&this.setState({totalLength:e})}}},{key:"getTotalLength",value:function(){var e=this.mainCurve;try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(e,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,o=l.points,c=l.xAxis,h=l.yAxis,m=l.layout,y=l.children,v=At(y,St);if(!v)return null;var d=function(x,s){return{x:x.x,y:x.y,value:x.value,errorVal:ot(x.payload,s)}},f={clipPath:e?"url(#clipPath-".concat(i,")"):null};return b.createElement(G,f,v.map(function(p){return b.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:o,xAxis:c,yAxis:h,layout:m,dataPointFormatter:d})}))}},{key:"renderDots",value:function(e,i,l){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,h=c.dot,m=c.points,y=c.dataKey,v=z(this.props,!1),d=z(h,!0),f=m.map(function(x,s){var u=A(A(A({key:"dot-".concat(s),r:3},v),d),{},{index:s,cx:x.x,cy:x.y,value:x.value,dataKey:y,payload:x.payload,points:m});return r.renderDotItem(h,u)}),p={clipPath:e?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return b.createElement(G,$({className:"recharts-line-dots",key:"dots"},p),f)}},{key:"renderCurveStatically",value:function(e,i,l,o){var c=this.props,h=c.type,m=c.layout,y=c.connectNulls;c.ref;var v=nt(c,_t),d=A(A(A({},z(v,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(l,")"):null,points:e},o),{},{type:h,layout:m,connectNulls:y});return b.createElement(wt,$({},d,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(e,i){var l=this,o=this.props,c=o.points,h=o.strokeDasharray,m=o.isAnimationActive,y=o.animationBegin,v=o.animationDuration,d=o.animationEasing,f=o.animationId,p=o.animateNewValues,x=o.width,s=o.height,u=this.state,g=u.prevPoints,P=u.totalLength;return b.createElement(Pt,{begin:y,duration:v,isActive:m,easing:d,from:{t:0},to:{t:1},key:"line-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(E){var w=E.t;if(g){var C=g.length/c.length,N=c.map(function(j,V){var B=Math.floor(V*C);if(g[B]){var I=g[B],O=F(I.x,j.x),pt=F(I.y,j.y);return A(A({},j),{},{x:O(w),y:pt(w)})}if(p){var ht=F(x*2,j.x),mt=F(s/2,j.y);return A(A({},j),{},{x:ht(w),y:mt(w)})}return A(A({},j),{},{x:j.x,y:j.y})});return l.renderCurveStatically(N,e,i)}var W=F(0,P),L=W(w),T;if(h){var K="".concat(h).split(/[,\s]+/gim).map(function(j){return parseFloat(j)});T=l.getStrokeDasharray(L,P,K)}else T=l.generateSimpleStrokeDasharray(P,L);return l.renderCurveStatically(c,e,i,{strokeDasharray:T})})}},{key:"renderCurve",value:function(e,i){var l=this.props,o=l.points,c=l.isAnimationActive,h=this.state,m=h.prevPoints,y=h.totalLength;return c&&o&&o.length&&(!m&&y>0||!Nt(m,o))?this.renderCurveWithAnimation(e,i):this.renderCurveStatically(o,e,i)}},{key:"render",value:function(){var e,i=this.props,l=i.hide,o=i.dot,c=i.points,h=i.className,m=i.xAxis,y=i.yAxis,v=i.top,d=i.left,f=i.width,p=i.height,x=i.isAnimationActive,s=i.id;if(l||!c||!c.length)return null;var u=this.state.isAnimationFinished,g=c.length===1,P=rt("recharts-line",h),E=m&&m.allowDataOverflow,w=y&&y.allowDataOverflow,C=E||w,N=H(s)?this.id:s,W=(e=z(o,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},L=W.r,T=L===void 0?3:L,K=W.strokeWidth,j=K===void 0?2:K,V=kt(o)?o:{},B=V.clipDot,I=B===void 0?!0:B,O=T*2+j;return b.createElement(G,{className:P},E||w?b.createElement("defs",null,b.createElement("clipPath",{id:"clipPath-".concat(N)},b.createElement("rect",{x:E?d:d-f/2,y:w?v:v-p/2,width:E?f:f*2,height:w?p:p*2})),!I&&b.createElement("clipPath",{id:"clipPath-dots-".concat(N)},b.createElement("rect",{x:d-O/2,y:v-O/2,width:f+O,height:p+O}))):null,!g&&this.renderCurve(C,N),this.renderErrorBar(C,N),(g||o)&&this.renderDots(C,I,N),(!x||u)&&Et.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(e,i){return e.animationId!==i.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:i.curPoints}:e.points!==i.curPoints?{curPoints:e.points}:null}},{key:"repeat",value:function(e,i){for(var l=e.length%2!==0?[].concat(D(e),[0]):e,o=[],c=0;c<i;++c)o=[].concat(D(o),D(l));return o}},{key:"renderDotItem",value:function(e,i){var l;if(b.isValidElement(e))l=b.cloneElement(e,i);else if(bt(e))l=e(i);else{var o=i.key,c=nt(i,Ct),h=rt("recharts-line-dot",typeof e!="boolean"?e.className:"");l=b.createElement(jt,$({key:o},c,{className:h}))}return l}}])}(k.PureComponent);S(R,"displayName","Line");S(R,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Dt.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});S(R,"getComposedData",function(t){var r=t.props,n=t.xAxis,e=t.yAxis,i=t.xAxisTicks,l=t.yAxisTicks,o=t.dataKey,c=t.bandSize,h=t.displayedData,m=t.offset,y=r.layout,v=h.map(function(d,f){var p=ot(d,o);return y==="horizontal"?{x:Q({axis:n,ticks:i,bandSize:c,entry:d,index:f}),y:H(p)?null:e.scale(p),value:p,payload:d}:{x:H(p)?null:n.scale(p),y:Q({axis:e,ticks:l,bandSize:c,entry:d,index:f}),value:p,payload:d}});return A({points:v,layout:y},m)});var Ut=st({chartName:"LineChart",GraphicalChild:R,axisComponents:[{axisType:"xAxis",AxisComp:M},{axisType:"yAxis",AxisComp:Y}],formatAxisMap:lt}),Vt=st({chartName:"BarChart",GraphicalChild:ct,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:M},{axisType:"yAxis",AxisComp:Y}],formatAxisMap:lt});function ne(){const[t,r]=k.useState([]),[n,e]=k.useState(!0),[i,l]=k.useState(null),[o,c]=k.useState(new Date().getFullYear()),[h,m]=k.useState([]);k.useEffect(()=>{y(),v()},[o]);const y=async()=>{var s,u;try{const g=localStorage.getItem("token"),P=await J.get(`/api/seller/sales-report/${o}`,{headers:{Authorization:`Bearer ${g}`}});r(P.data.sales||[])}catch(g){console.error("Error fetching sales report:",g),l(((u=(s=g.response)==null?void 0:s.data)==null?void 0:u.message)||"Failed to fetch sales report")}finally{e(!1)}},v=async()=>{try{const s=localStorage.getItem("token"),u=await J.get("/api/seller/best-selling",{headers:{Authorization:`Bearer ${s}`}});m(u.data.products||[])}catch(s){console.error("Error fetching best selling products:",s)}},d=["يناير","فبراير","مارس","إبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"];if(n)return a.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})});if(i)return a.jsxs("div",{className:"text-red-600 text-center",children:[a.jsx("p",{className:"text-xl font-semibold mb-2",children:"خطأ"}),a.jsx("p",{children:i})]});const f=t.reduce((s,u)=>s+u.revenue,0),p=t.reduce((s,u)=>s+u.total_sales,0),x=f/t.filter(s=>s.revenue>0).length||0;return a.jsxs(a.Fragment,{children:[a.jsx(ft,{children:a.jsx("title",{children:"تقرير المبيعات (بائع)"})}),a.jsxs("div",{className:"animate-fadeIn p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"تقرير المبيعات"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"تحليل أداء المبيعات والإيرادات"})]}),a.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200 px-3 py-2",children:[a.jsx(yt,{className:"h-5 w-5 text-gray-400"}),a.jsx("select",{value:o,onChange:s=>c(Number(s.target.value)),className:"border-0 py-1 text-gray-900 focus:ring-0 text-sm",children:[...Array(5)].map((s,u)=>{const g=new Date().getFullYear()-u;return a.jsx("option",{value:g,children:g},g)})})]})]}),a.jsxs("div",{className:"grid gap-6 md:grid-cols-3 mb-8",children:[a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:a.jsx(vt,{className:"h-6 w-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"إجمالي الإيرادات"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[f.toLocaleString()," ر.س"]})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:a.jsx(xt,{className:"h-6 w-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"إجمالي المبيعات"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[p.toLocaleString()," قطعة"]})]})]})}),a.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:a.jsx(gt,{className:"h-6 w-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"متوسط الإيرادات الشهرية"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[x.toLocaleString()," ر.س"]})]})]})})]}),a.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-8",children:[a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"الإيرادات الشهرية"}),a.jsx("div",{className:"h-[300px]",children:a.jsx(Z,{width:"100%",height:"100%",children:a.jsxs(Ut,{data:t,children:[a.jsx(tt,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),a.jsx(M,{dataKey:"month",tickFormatter:s=>{const u=s-1;return u>=0&&u<d.length?d[u]:String(s)},stroke:"#6B7280"}),a.jsx(Y,{stroke:"#6B7280",tickFormatter:s=>`${s.toLocaleString()} ر.س`}),a.jsx(et,{formatter:s=>[`${s.toLocaleString()} ر.س`,"الإيرادات"],labelFormatter:s=>{const u=s-1;return u>=0&&u<d.length?d[u]:String(s)},contentStyle:{textAlign:"right",direction:"rtl"}}),a.jsx(R,{type:"monotone",dataKey:"revenue",stroke:"#4F46E5",strokeWidth:2,dot:{fill:"#4F46E5",strokeWidth:2},activeDot:{r:6,fill:"#4F46E5"}})]})})})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"text-lg font-semibold mb-6",children:"المبيعات الشهرية"}),a.jsx("div",{className:"h-[300px]",children:a.jsx(Z,{width:"100%",height:"100%",children:a.jsxs(Vt,{data:t,children:[a.jsx(tt,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),a.jsx(M,{dataKey:"month",tickFormatter:s=>{const u=s-1;return u>=0&&u<d.length?d[u]:String(s)},stroke:"#6B7280"}),a.jsx(Y,{stroke:"#6B7280",tickFormatter:s=>`${s} قطعة`}),a.jsx(et,{formatter:s=>[`${s} قطعة`,"المبيعات"],labelFormatter:s=>{const u=s-1;return u>=0&&u<d.length?d[u]:String(s)},contentStyle:{textAlign:"right",direction:"rtl"}}),a.jsx(ct,{dataKey:"total_sales",fill:"#10B981",radius:[4,4,0,0]})]})})})]})]})]})]})}export{ne as default};
