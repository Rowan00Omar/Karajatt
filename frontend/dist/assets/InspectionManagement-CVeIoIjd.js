var Vt=Object.defineProperty;var Tt=v=>{throw TypeError(v)};var Xt=(v,s,b)=>s in v?Vt(v,s,{enumerable:!0,configurable:!0,writable:!0,value:b}):v[s]=b;var ke=(v,s,b)=>Xt(v,typeof s!="symbol"?s+"":s,b),ot=(v,s,b)=>s.has(v)||Tt("Cannot "+b);var D=(v,s,b)=>(ot(v,s,"read from private field"),b?b.call(v):s.get(v)),pe=(v,s,b)=>s.has(v)?Tt("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(v):s.set(v,b),fe=(v,s,b,e)=>(ot(v,s,"write to private field"),e?e.call(v,b):s.set(v,b),b),he=(v,s,b)=>(ot(v,s,"access private method"),b);var lt=(v,s,b,e)=>({set _(c){fe(v,s,c,b)},get _(){return D(v,s,e)}});import{g as getAugmentedNamespace,r as reactExports,U,a as axios,j as jsxRuntimeExports}from"./index-DotS8Uwj.js";import{P as PropTypes,H as HelmetExport}from"./Helmet-BBvg7tzo.js";import{i as invariant}from"./tiny-invariant-CopsF_GD.js";import{F as ForwardRef$6,a as ForwardRef$7}from"./MagnifyingGlassIcon-BL2pTQFN.js";function _extends(){return _extends=Object.assign?Object.assign.bind():function(v){for(var s=1;s<arguments.length;s++){var b=arguments[s];for(var e in b)({}).hasOwnProperty.call(b,e)&&(v[e]=b[e])}return v},_extends.apply(null,arguments)}function _objectWithoutPropertiesLoose(v,s){if(v==null)return{};var b={};for(var e in v)if({}.hasOwnProperty.call(v,e)){if(s.indexOf(e)!==-1)continue;b[e]=v[e]}return b}function _setPrototypeOf(v,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(b,e){return b.__proto__=e,b},_setPrototypeOf(v,s)}function _assertThisInitialized(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function commonjsRequire(v){throw new Error('Could not dynamically require "'+v+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(s,b){module.exports=b()})(globalThis,()=>(()=>{var __webpack_modules__=[,(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.VerbosityLevel=s.Util=s.UnknownErrorException=s.UnexpectedResponseException=s.UNSUPPORTED_FEATURES=s.TextRenderingMode=s.StreamType=s.RenderingIntentFlag=s.PermissionFlag=s.PasswordResponses=s.PasswordException=s.PageActionEventType=s.OPS=s.MissingPDFException=s.LINE_FACTOR=s.LINE_DESCENT_FACTOR=s.InvalidPDFException=s.ImageKind=s.IDENTITY_MATRIX=s.FormatError=s.FontType=s.FeatureTest=s.FONT_IDENTITY_MATRIX=s.DocumentActionEventType=s.CMapCompressionType=s.BaseException=s.AnnotationType=s.AnnotationStateModelType=s.AnnotationReviewState=s.AnnotationReplyType=s.AnnotationMode=s.AnnotationMarkedState=s.AnnotationFlag=s.AnnotationFieldFlag=s.AnnotationEditorType=s.AnnotationEditorPrefix=s.AnnotationEditorParamsType=s.AnnotationBorderStyleType=s.AnnotationActionEventType=s.AbortException=void 0,s.arrayByteLength=j,s.arraysToBytes=K,s.assert=f,s.bytesToString=M,s.createPromiseCapability=We,s.createValidAbsoluteUrl=I,s.escapeString=xe,s.getModificationDate=Be,s.getVerbosityLevel=ie,s.info=de,s.isArrayBuffer=Te,s.isArrayEqual=Le,s.isAscii=we,s.objectFromMap=Z,s.objectSize=Y,s.setVerbosityLevel=Q,s.shadow=q,s.string32=B,s.stringToBytes=y,s.stringToPDFString=ve,s.stringToUTF16BEString=Ee,s.stringToUTF8String=Re,s.unreachable=V,s.utf8StringToString=Pe,s.warn=ge,b(2);const e=[1,0,0,1,0,0];s.IDENTITY_MATRIX=e;const c=[.001,0,0,.001,0,0];s.FONT_IDENTITY_MATRIX=c;const O=1.35;s.LINE_FACTOR=O;const L=.35;s.LINE_DESCENT_FACTOR=L;const F={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};s.RenderingIntentFlag=F;const S={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};s.AnnotationMode=S;const m="pdfjs_internal_editor_";s.AnnotationEditorPrefix=m;const R={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};s.AnnotationEditorType=R;const N={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};s.AnnotationEditorParamsType=N;const w={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};s.PermissionFlag=w;const P={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};s.TextRenderingMode=P;const h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};s.ImageKind=h;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};s.AnnotationType=t;const l={MARKED:"Marked",REVIEW:"Review"};s.AnnotationStateModelType=l;const u={MARKED:"Marked",UNMARKED:"Unmarked"};s.AnnotationMarkedState=u;const T={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};s.AnnotationReviewState=T;const _={GROUP:"Group",REPLY:"R"};s.AnnotationReplyType=_;const p={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};s.AnnotationFlag=p;const a={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};s.AnnotationFieldFlag=a;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};s.AnnotationBorderStyleType=o;const n={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};s.AnnotationActionEventType=n;const x={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};s.DocumentActionEventType=x;const C={O:"PageOpen",C:"PageClose"};s.PageActionEventType=C;const z={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};s.StreamType=z;const G={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};s.FontType=G;const oe={ERRORS:0,WARNINGS:1,INFOS:5};s.VerbosityLevel=oe;const le={NONE:0,BINARY:1,STREAM:2};s.CMapCompressionType=le;const se={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};s.OPS=se;const ne={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};s.UNSUPPORTED_FEATURES=ne;const X={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};s.PasswordResponses=X;let J=oe.WARNINGS;function Q(ce){Number.isInteger(ce)&&(J=ce)}function ie(){return J}function de(ce){J>=oe.INFOS&&console.log(`Info: ${ce}`)}function ge(ce){J>=oe.WARNINGS&&console.log(`Warning: ${ce}`)}function V(ce){throw new Error(ce)}function f(ce,ee){ce||V(ee)}function d(ce){if(!ce)return!1;switch(ce.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function I(ce,ee=null,te=null){if(!ce)return null;try{if(te&&typeof ce=="string"){if(te.addDefaultProtocol&&ce.startsWith("www.")){const Ae=ce.match(/\./g);Ae&&Ae.length>=2&&(ce=`http://${ce}`)}if(te.tryConvertEncoding)try{ce=Re(ce)}catch{}}const ye=ee?new URL(ce,ee):new URL(ce);if(d(ye))return ye}catch{}return null}function q(ce,ee,te){return Object.defineProperty(ce,ee,{value:te,enumerable:!0,configurable:!0,writable:!1}),te}const $=function(){function ee(te,ye){this.constructor===ee&&V("Cannot initialize BaseException."),this.message=te,this.name=ye}return ee.prototype=new Error,ee.constructor=ee,ee}();s.BaseException=$;class H extends ${constructor(ee,te){super(ee,"PasswordException"),this.code=te}}s.PasswordException=H;class i extends ${constructor(ee,te){super(ee,"UnknownErrorException"),this.details=te}}s.UnknownErrorException=i;class g extends ${constructor(ee){super(ee,"InvalidPDFException")}}s.InvalidPDFException=g;class E extends ${constructor(ee){super(ee,"MissingPDFException")}}s.MissingPDFException=E;class A extends ${constructor(ee,te){super(ee,"UnexpectedResponseException"),this.status=te}}s.UnexpectedResponseException=A;class k extends ${constructor(ee){super(ee,"FormatError")}}s.FormatError=k;class W extends ${constructor(ee){super(ee,"AbortException")}}s.AbortException=W;function M(ce){(typeof ce!="object"||ce===null||ce.length===void 0)&&V("Invalid argument for bytesToString");const ee=ce.length,te=8192;if(ee<te)return String.fromCharCode.apply(null,ce);const ye=[];for(let Ae=0;Ae<ee;Ae+=te){const Ce=Math.min(Ae+te,ee),Se=ce.subarray(Ae,Ce);ye.push(String.fromCharCode.apply(null,Se))}return ye.join("")}function y(ce){typeof ce!="string"&&V("Invalid argument for stringToBytes");const ee=ce.length,te=new Uint8Array(ee);for(let ye=0;ye<ee;++ye)te[ye]=ce.charCodeAt(ye)&255;return te}function j(ce){if(ce.length!==void 0)return ce.length;if(ce.byteLength!==void 0)return ce.byteLength;V("Invalid argument for arrayByteLength")}function K(ce){const ee=ce.length;if(ee===1&&ce[0]instanceof Uint8Array)return ce[0];let te=0;for(let Ce=0;Ce<ee;Ce++)te+=j(ce[Ce]);let ye=0;const Ae=new Uint8Array(te);for(let Ce=0;Ce<ee;Ce++){let Se=ce[Ce];Se instanceof Uint8Array||(typeof Se=="string"?Se=y(Se):Se=new Uint8Array(Se));const Ne=Se.byteLength;Ae.set(Se,ye),ye+=Ne}return Ae}function B(ce){return String.fromCharCode(ce>>24&255,ce>>16&255,ce>>8&255,ce&255)}function Y(ce){return Object.keys(ce).length}function Z(ce){const ee=Object.create(null);for(const[te,ye]of ce)ee[te]=ye;return ee}function ae(){const ce=new Uint8Array(4);return ce[0]=1,new Uint32Array(ce.buffer,0,1)[0]===1}function ue(){try{return new Function(""),!0}catch{return!1}}class re{static get isLittleEndian(){return q(this,"isLittleEndian",ae())}static get isEvalSupported(){return q(this,"isEvalSupported",ue())}static get isOffscreenCanvasSupported(){return q(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}s.FeatureTest=re;const be=[...Array(256).keys()].map(ce=>ce.toString(16).padStart(2,"0"));class _e{static makeHexColor(ee,te,ye){return`#${be[ee]}${be[te]}${be[ye]}`}static scaleMinMax(ee,te){let ye;ee[0]?(ee[0]<0&&(ye=te[0],te[0]=te[1],te[1]=ye),te[0]*=ee[0],te[1]*=ee[0],ee[3]<0&&(ye=te[2],te[2]=te[3],te[3]=ye),te[2]*=ee[3],te[3]*=ee[3]):(ye=te[0],te[0]=te[2],te[2]=ye,ye=te[1],te[1]=te[3],te[3]=ye,ee[1]<0&&(ye=te[2],te[2]=te[3],te[3]=ye),te[2]*=ee[1],te[3]*=ee[1],ee[2]<0&&(ye=te[0],te[0]=te[1],te[1]=ye),te[0]*=ee[2],te[1]*=ee[2]),te[0]+=ee[4],te[1]+=ee[4],te[2]+=ee[5],te[3]+=ee[5]}static transform(ee,te){return[ee[0]*te[0]+ee[2]*te[1],ee[1]*te[0]+ee[3]*te[1],ee[0]*te[2]+ee[2]*te[3],ee[1]*te[2]+ee[3]*te[3],ee[0]*te[4]+ee[2]*te[5]+ee[4],ee[1]*te[4]+ee[3]*te[5]+ee[5]]}static applyTransform(ee,te){const ye=ee[0]*te[0]+ee[1]*te[2]+te[4],Ae=ee[0]*te[1]+ee[1]*te[3]+te[5];return[ye,Ae]}static applyInverseTransform(ee,te){const ye=te[0]*te[3]-te[1]*te[2],Ae=(ee[0]*te[3]-ee[1]*te[2]+te[2]*te[5]-te[4]*te[3])/ye,Ce=(-ee[0]*te[1]+ee[1]*te[0]+te[4]*te[1]-te[5]*te[0])/ye;return[Ae,Ce]}static getAxialAlignedBoundingBox(ee,te){const ye=_e.applyTransform(ee,te),Ae=_e.applyTransform(ee.slice(2,4),te),Ce=_e.applyTransform([ee[0],ee[3]],te),Se=_e.applyTransform([ee[2],ee[1]],te);return[Math.min(ye[0],Ae[0],Ce[0],Se[0]),Math.min(ye[1],Ae[1],Ce[1],Se[1]),Math.max(ye[0],Ae[0],Ce[0],Se[0]),Math.max(ye[1],Ae[1],Ce[1],Se[1])]}static inverseTransform(ee){const te=ee[0]*ee[3]-ee[1]*ee[2];return[ee[3]/te,-ee[1]/te,-ee[2]/te,ee[0]/te,(ee[2]*ee[5]-ee[4]*ee[3])/te,(ee[4]*ee[1]-ee[5]*ee[0])/te]}static apply3dTransform(ee,te){return[ee[0]*te[0]+ee[1]*te[1]+ee[2]*te[2],ee[3]*te[0]+ee[4]*te[1]+ee[5]*te[2],ee[6]*te[0]+ee[7]*te[1]+ee[8]*te[2]]}static singularValueDecompose2dScale(ee){const te=[ee[0],ee[2],ee[1],ee[3]],ye=ee[0]*te[0]+ee[1]*te[2],Ae=ee[0]*te[1]+ee[1]*te[3],Ce=ee[2]*te[0]+ee[3]*te[2],Se=ee[2]*te[1]+ee[3]*te[3],Ne=(ye+Se)/2,qe=Math.sqrt((ye+Se)**2-4*(ye*Se-Ce*Ae))/2,Ue=Ne+qe||1,Me=Ne-qe||1;return[Math.sqrt(Ue),Math.sqrt(Me)]}static normalizeRect(ee){const te=ee.slice(0);return ee[0]>ee[2]&&(te[0]=ee[2],te[2]=ee[0]),ee[1]>ee[3]&&(te[1]=ee[3],te[3]=ee[1]),te}static intersect(ee,te){const ye=Math.max(Math.min(ee[0],ee[2]),Math.min(te[0],te[2])),Ae=Math.min(Math.max(ee[0],ee[2]),Math.max(te[0],te[2]));if(ye>Ae)return null;const Ce=Math.max(Math.min(ee[1],ee[3]),Math.min(te[1],te[3])),Se=Math.min(Math.max(ee[1],ee[3]),Math.max(te[1],te[3]));return Ce>Se?null:[ye,Ce,Ae,Se]}static bezierBoundingBox(ee,te,ye,Ae,Ce,Se,Ne,qe){const Ue=[],Me=[[],[]];let $e,je,Ke,Fe,Je,Qe,st,it;for(let at=0;at<2;++at){if(at===0?(je=6*ee-12*ye+6*Ce,$e=-3*ee+9*ye-9*Ce+3*Ne,Ke=3*ye-3*ee):(je=6*te-12*Ae+6*Se,$e=-3*te+9*Ae-9*Se+3*qe,Ke=3*Ae-3*te),Math.abs($e)<1e-12){if(Math.abs(je)<1e-12)continue;Fe=-Ke/je,0<Fe&&Fe<1&&Ue.push(Fe);continue}st=je*je-4*Ke*$e,it=Math.sqrt(st),!(st<0)&&(Je=(-je+it)/(2*$e),0<Je&&Je<1&&Ue.push(Je),Qe=(-je-it)/(2*$e),0<Qe&&Qe<1&&Ue.push(Qe))}let ze=Ue.length,Oe;const Ve=ze;for(;ze--;)Fe=Ue[ze],Oe=1-Fe,Me[0][ze]=Oe*Oe*Oe*ee+3*Oe*Oe*Fe*ye+3*Oe*Fe*Fe*Ce+Fe*Fe*Fe*Ne,Me[1][ze]=Oe*Oe*Oe*te+3*Oe*Oe*Fe*Ae+3*Oe*Fe*Fe*Se+Fe*Fe*Fe*qe;return Me[0][Ve]=ee,Me[1][Ve]=te,Me[0][Ve+1]=Ne,Me[1][Ve+1]=qe,Me[0].length=Me[1].length=Ve+2,[Math.min(...Me[0]),Math.min(...Me[1]),Math.max(...Me[0]),Math.max(...Me[1])]}}s.Util=_e;const me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ve(ce){if(ce[0]>="ï"){let te;if(ce[0]==="þ"&&ce[1]==="ÿ"?te="utf-16be":ce[0]==="ÿ"&&ce[1]==="þ"?te="utf-16le":ce[0]==="ï"&&ce[1]==="»"&&ce[2]==="¿"&&(te="utf-8"),te)try{const ye=new TextDecoder(te,{fatal:!0}),Ae=y(ce);return ye.decode(Ae)}catch(ye){ge(`stringToPDFString: "${ye}".`)}}const ee=[];for(let te=0,ye=ce.length;te<ye;te++){const Ae=me[ce.charCodeAt(te)];ee.push(Ae?String.fromCharCode(Ae):ce.charAt(te))}return ee.join("")}function xe(ce){return ce.replace(/([()\\\n\r])/g,ee=>ee===`
`?"\\n":ee==="\r"?"\\r":`\\${ee}`)}function we(ce){return/^[\x00-\x7F]*$/.test(ce)}function Ee(ce){const ee=["þÿ"];for(let te=0,ye=ce.length;te<ye;te++){const Ae=ce.charCodeAt(te);ee.push(String.fromCharCode(Ae>>8&255),String.fromCharCode(Ae&255))}return ee.join("")}function Re(ce){return decodeURIComponent(escape(ce))}function Pe(ce){return unescape(encodeURIComponent(ce))}function Te(ce){return typeof ce=="object"&&ce!==null&&ce.byteLength!==void 0}function Le(ce,ee){if(ce.length!==ee.length)return!1;for(let te=0,ye=ce.length;te<ye;te++)if(ce[te]!==ee[te])return!1;return!0}function Be(ce=new Date){return[ce.getUTCFullYear().toString(),(ce.getUTCMonth()+1).toString().padStart(2,"0"),ce.getUTCDate().toString().padStart(2,"0"),ce.getUTCHours().toString().padStart(2,"0"),ce.getUTCMinutes().toString().padStart(2,"0"),ce.getUTCSeconds().toString().padStart(2,"0")].join("")}function We(){const ce=Object.create(null);let ee=!1;return Object.defineProperty(ce,"settled",{get(){return ee}}),ce.promise=new Promise(function(te,ye){ce.resolve=function(Ae){ee=!0,te(Ae)},ce.reject=function(Ae){ee=!0,ye(Ae)}}),ce}},(v,s,b)=>{b(3)},(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isNodeJS=void 0;const b=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");s.isNodeJS=b},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var v,b,e,c,O,L,F,S,m,ct,N,w;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:h,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:l}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=h,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=l}let createPDFNetworkStream;function setPDFNetworkStreamFactory(h){createPDFNetworkStream=h}function getDocument(h){const t=new PDFDocumentLoadingTask;let l;if(typeof h=="string"||h instanceof URL)l={url:h};else if((0,_util.isArrayBuffer)(h))l={data:h};else if(h instanceof PDFDataRangeTransport)l={range:h};else{if(typeof h!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!h.url&&!h.data&&!h.range)throw new Error("Invalid parameter object: need either .data, .range or .url");l=h}const u=Object.create(null);let T=null,_=null;for(const a in l){const o=l[a];switch(a){case"url":if(typeof window<"u")try{u[a]=new URL(o,window.location).href;continue}catch(n){(0,_util.warn)(`Cannot create valid URL: "${n}".`)}else if(typeof o=="string"||o instanceof URL){u[a]=o.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":T=o;continue;case"worker":_=o;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)u[a]=new Uint8Array(o);else{if(o instanceof Uint8Array)break;if(typeof o=="string")u[a]=(0,_util.stringToBytes)(o);else if(typeof o=="object"&&o!==null&&!isNaN(o.length))u[a]=new Uint8Array(o);else if((0,_util.isArrayBuffer)(o))u[a]=new Uint8Array(o);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}u[a]=o}if(u.CMapReaderFactory=u.CMapReaderFactory||DefaultCMapReaderFactory,u.StandardFontDataFactory=u.StandardFontDataFactory||DefaultStandardFontDataFactory,u.ignoreErrors=u.stopAtErrors!==!0,u.fontExtraProperties=u.fontExtraProperties===!0,u.pdfBug=u.pdfBug===!0,u.enableXfa=u.enableXfa===!0,(!Number.isInteger(u.rangeChunkSize)||u.rangeChunkSize<1)&&(u.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof u.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(u.docBaseUrl))&&(u.docBaseUrl=null),(!Number.isInteger(u.maxImageSize)||u.maxImageSize<-1)&&(u.maxImageSize=-1),typeof u.cMapUrl!="string"&&(u.cMapUrl=null),typeof u.standardFontDataUrl!="string"&&(u.standardFontDataUrl=null),typeof u.useWorkerFetch!="boolean"&&(u.useWorkerFetch=u.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&u.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof u.isEvalSupported!="boolean"&&(u.isEvalSupported=!0),typeof u.disableFontFace!="boolean"&&(u.disableFontFace=_is_node.isNodeJS),typeof u.useSystemFonts!="boolean"&&(u.useSystemFonts=!_is_node.isNodeJS&&!u.disableFontFace),(typeof u.ownerDocument!="object"||u.ownerDocument===null)&&(u.ownerDocument=globalThis.document),typeof u.disableRange!="boolean"&&(u.disableRange=!1),typeof u.disableStream!="boolean"&&(u.disableStream=!1),typeof u.disableAutoFetch!="boolean"&&(u.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(u.verbosity),!_){const a={verbosity:u.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};_=a.port?PDFWorker.fromPort(a):new PDFWorker(a),t._worker=_}const p=t.docId;return _.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const a=_fetchDocument(_,u,T,p),o=new Promise(function(n){let x;T?x=new _transport_stream.PDFDataTransportStream({length:u.length,initialData:u.initialData,progressiveDone:u.progressiveDone,contentDispositionFilename:u.contentDispositionFilename,disableRange:u.disableRange,disableStream:u.disableStream},T):u.data||(x=createPDFNetworkStream({url:u.url,length:u.length,httpHeaders:u.httpHeaders,withCredentials:u.withCredentials,rangeChunkSize:u.rangeChunkSize,disableRange:u.disableRange,disableStream:u.disableStream})),n(x)});return Promise.all([a,o]).then(function([n,x]){if(t.destroyed)throw new Error("Loading aborted");const C=new _message_handler.MessageHandler(p,n,_.port),z=new WorkerTransport(C,t,x,u);t._transport=z,C.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(h,t,l,u){if(h.destroyed)throw new Error("Worker was destroyed");l&&(t.length=l.length,t.initialData=l.initialData,t.progressiveDone=l.progressiveDone,t.contentDispositionFilename=l.contentDispositionFilename);const T=await h.messageHandler.sendWithPromise("GetDocRequest",{docId:u,apiVersion:"2.16.105",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),h.destroyed)throw new Error("Worker was destroyed");return T}const s=class s{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${lt(s,v)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};v=new WeakMap,pe(s,v,0);let PDFDocumentLoadingTask=s;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,l,u=!1,T=null){this.length=t,this.initialData=l,this.progressiveDone=u,this.contentDispositionFilename=T,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,l){for(const u of this._rangeListeners)u(t,l)}onDataProgress(t,l){this._readyCapability.promise.then(()=>{for(const u of this._progressListeners)u(t,l)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const l of this._progressiveReadListeners)l(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,l){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,l){this._pdfInfo=t,this._transport=l,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,l,u,T,_=!1){this._pageIndex=t,this._pageInfo=l,this._ownerDocument=T,this._transport=u,this._stats=_?new _display_utils.StatTimer:null,this._pdfBug=_,this.commonObjs=u.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:l=this.rotate,offsetX:u=0,offsetY:T=0,dontFlip:_=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:l,offsetX:u,offsetY:T,dontFlip:_})}getAnnotations({intent:t="display"}={}){const l=this._transport.getRenderingIntent(t);let u=this._annotationPromises.get(l.cacheKey);return u||(u=this._transport.getAnnotations(this._pageIndex,l.renderingIntent),this._annotationPromises.set(l.cacheKey,u),u=u.then(T=>{for(const _ of T)_.titleObj!==void 0&&Object.defineProperty(_,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),_.titleObj.str}}),_.contentsObj!==void 0&&Object.defineProperty(_,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),_.contentsObj.str}});return T})),u}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:l,intent:u="display",annotationMode:T=_util.AnnotationMode.ENABLE,transform:_=null,imageLayer:p=null,canvasFactory:a=null,background:o=null,optionalContentConfigPromise:n=null,annotationCanvasMap:x=null,pageColors:C=null,printAnnotationStorage:z=null}){var Q,ie;((Q=arguments[0])==null?void 0:Q.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&T===_util.AnnotationMode.ENABLE&&(T=_util.AnnotationMode.ENABLE_FORMS)),((ie=arguments[0])==null?void 0:ie.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&T===_util.AnnotationMode.ENABLE&&(T=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const G=this._transport.getRenderingIntent(u,T,z);this.pendingCleanup=!1,n||(n=this._transport.getOptionalContentConfig());let oe=this._intentStates.get(G.cacheKey);oe||(oe=Object.create(null),this._intentStates.set(G.cacheKey,oe)),oe.streamReaderCancelTimeout&&(clearTimeout(oe.streamReaderCancelTimeout),oe.streamReaderCancelTimeout=null);const le=a||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),se=!!(G.renderingIntent&_util.RenderingIntentFlag.PRINT);oe.displayReadyCapability||(oe.displayReadyCapability=(0,_util.createPromiseCapability)(),oe.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(G));const ne=de=>{oe.renderTasks.delete(X),(this.cleanupAfterRender||se)&&(this.pendingCleanup=!0),this._tryCleanup(),de?(X.capability.reject(de),this._abortOperatorList({intentState:oe,reason:de instanceof Error?de:new Error(de)})):X.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},X=new InternalRenderTask({callback:ne,params:{canvasContext:t,viewport:l,transform:_,imageLayer:p,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:oe.operatorList,pageIndex:this._pageIndex,canvasFactory:le,useRequestAnimationFrame:!se,pdfBug:this._pdfBug,pageColors:C});(oe.renderTasks||(oe.renderTasks=new Set)).add(X);const J=X.task;return Promise.all([oe.displayReadyCapability.promise,n]).then(([de,ge])=>{if(this.pendingCleanup){ne();return}this._stats&&this._stats.time("Rendering"),X.initializeGraphics({transparency:de,optionalContentConfig:ge}),X.operatorListChanged()}).catch(ne),J}getOperatorList({intent:t="display",annotationMode:l=_util.AnnotationMode.ENABLE,printAnnotationStorage:u=null}={}){function T(){p.operatorList.lastChunk&&(p.opListReadCapability.resolve(p.operatorList),p.renderTasks.delete(a))}const _=this._transport.getRenderingIntent(t,l,u,!0);let p=this._intentStates.get(_.cacheKey);p||(p=Object.create(null),this._intentStates.set(_.cacheKey,p));let a;return p.opListReadCapability||(a=Object.create(null),a.operatorListChanged=T,p.opListReadCapability=(0,_util.createPromiseCapability)(),(p.renderTasks||(p.renderTasks=new Set)).add(a),p.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(_)),p.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:l=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:l===!0},{highWaterMark:100,size(T){return T.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(u=>_xfa_text.XfaText.textContent(u));const l=this.streamTextContent(t);return new Promise(function(u,T){function _(){p.read().then(function({value:o,done:n}){if(n){u(a);return}Object.assign(a.styles,o.styles),a.items.push(...o.items),_()},T)}const p=l.getReader(),a={items:[],styles:Object.create(null)};_()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const l of this._intentStates.values())if(this._abortOperatorList({intentState:l,reason:new Error("Page was destroyed."),force:!0}),!l.opListReadCapability)for(const u of l.renderTasks)t.push(u.completed),u.cancel();this.objs.clear();for(const l of this._bitmaps)l.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:l,operatorList:u}of this._intentStates.values())if(l.size>0||!u.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const l of this._bitmaps)l.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,l){const u=this._intentStates.get(l);u&&(this._stats&&this._stats.timeEnd("Page Request"),u.displayReadyCapability&&u.displayReadyCapability.resolve(t))}_renderPageChunk(t,l){for(let u=0,T=t.length;u<T;u++)l.operatorList.fnArray.push(t.fnArray[u]),l.operatorList.argsArray.push(t.argsArray[u]);l.operatorList.lastChunk=t.lastChunk,l.operatorList.separateAnnots=t.separateAnnots;for(const u of l.renderTasks)u.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:l,annotationStorageMap:u}){const _=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:l,annotationStorage:u}).getReader(),p=this._intentStates.get(l);p.streamReader=_;const a=()=>{_.read().then(({value:o,done:n})=>{if(n){p.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(o,p),a())},o=>{if(p.streamReader=null,!this._transport.destroyed){if(p.operatorList){p.operatorList.lastChunk=!0;for(const n of p.renderTasks)n.operatorListChanged();this._tryCleanup()}if(p.displayReadyCapability)p.displayReadyCapability.reject(o);else if(p.opListReadCapability)p.opListReadCapability.reject(o);else throw o}})};a()}_abortOperatorList({intentState:t,reason:l,force:u=!1}){if(t.streamReader){if(!u){if(t.renderTasks.size>0)return;if(l instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:l,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(l.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[T,_]of this._intentStates)if(_===t){this._intentStates.delete(T);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,l){const u={data:structuredClone(t,l)};this._deferred.then(()=>{for(const T of this._listeners)T.call(this,u)})}addEventListener(t,l){this._listeners.push(l)}removeEventListener(t,l){const u=this._listeners.indexOf(l);this._listeners.splice(u,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const h=(b=document==null?void 0:document.currentScript)==null?void 0:b.src;h&&(PDFWorkerUtil.fallbackWorkerSrc=h.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(h,t){let l;try{if(l=new URL(h),!l.origin||l.origin==="null")return!1}catch{return!1}const u=new URL(t,l);return l.origin===u.origin},PDFWorkerUtil.createCDNWrapper=function(h){const t=`importScripts("${h}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class _PDFWorker{constructor({name:h=null,port:t=null,verbosity:l=(0,_util.getVerbosityLevel)()}={}){if(t&&D(_PDFWorker,e).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=h,this.destroyed=!1,this.verbosity=l,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){D(_PDFWorker,e).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(h){this._port=h,this._messageHandler=new _message_handler.MessageHandler("main","worker",h),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:h}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,h)||(h=PDFWorkerUtil.createCDNWrapper(new URL(h,window.location).href));const t=new Worker(h),l=new _message_handler.MessageHandler("main","worker",t),u=()=>{t.removeEventListener("error",T),l.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},T=()=>{this._webWorker||u()};t.addEventListener("error",T),l.on("test",p=>{if(t.removeEventListener("error",T),this.destroyed){u();return}p?(this._messageHandler=l,this._port=t,this._webWorker=t,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),l.destroy(),t.terminate())}),l.on("ready",p=>{if(t.removeEventListener("error",T),this.destroyed){u();return}try{_()}catch{this._setupFakeWorker()}});const _=()=>{const p=new Uint8Array;l.send("test",p,[p.buffer])};_();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(h=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const l=`fake${PDFWorkerUtil.fakeWorkerId++}`,u=new _message_handler.MessageHandler(l+"_worker",l,t);h.setup(u,t);const T=new _message_handler.MessageHandler(l,l+"_worker",t);this._messageHandler=T,this._readyCapability.resolve(),T.send("configure",{verbosity:this.verbosity})}).catch(h=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${h.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),D(_PDFWorker,e).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(h){if(!(h!=null&&h.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return D(this,e).has(h.port)?D(this,e).get(h.port):new _PDFWorker(h)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var h;try{return((h=globalThis.pdfjsWorker)==null?void 0:h.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};e=new WeakMap,pe(_PDFWorker,e,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,l,u,T){pe(this,c,null);pe(this,O,new Map);pe(this,L,new Map);pe(this,F,null);this.messageHandler=t,this.loadingTask=l,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:l.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:T.ownerDocument,styleElement:T.styleElement}),this._params=T,T.useWorkerFetch||(this.CMapReaderFactory=new T.CMapReaderFactory({baseUrl:T.cMapUrl,isCompressed:T.cMapPacked}),this.StandardFontDataFactory=new T.StandardFontDataFactory({baseUrl:T.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=u,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return D(this,c)}getRenderingIntent(t,l=_util.AnnotationMode.ENABLE,u=null,T=!1){let _=_util.RenderingIntentFlag.DISPLAY,p=null;switch(t){case"any":_=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":_=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(l){case _util.AnnotationMode.DISABLE:_+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:_+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:_+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,p=(_&_util.RenderingIntentFlag.PRINT&&u instanceof _annotation_storage.PrintAnnotationStorage?u:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${l}`)}return T&&(_+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:_,cacheKey:`${_}_${_annotation_storage.AnnotationStorage.getHash(p)}`,annotationStorageMap:p}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const u of D(this,O).values())t.push(u._destroy());D(this,O).clear(),D(this,L).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const l=this.messageHandler.sendWithPromise("Terminate",null);return t.push(l),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),fe(this,F,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:l}=this;t.on("GetReader",(u,T)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=_=>{this._lastProgress={loaded:_.loaded,total:_.total}},T.onPull=()=>{this._fullReader.read().then(function({value:_,done:p}){if(p){T.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(_),"GetReader - expected an ArrayBuffer."),T.enqueue(new Uint8Array(_),1,[_])}).catch(_=>{T.error(_)})},T.onCancel=_=>{this._fullReader.cancel(_),T.ready.catch(p=>{if(!this.destroyed)throw p})}}),t.on("ReaderHeadersReady",u=>{const T=(0,_util.createPromiseCapability)(),_=this._fullReader;return _.headersReady.then(()=>{var p;(!_.isStreamingSupported||!_.isRangeSupported)&&(this._lastProgress&&((p=l.onProgress)==null||p.call(l,this._lastProgress)),_.onProgress=a=>{var o;(o=l.onProgress)==null||o.call(l,{loaded:a.loaded,total:a.total})}),T.resolve({isStreamingSupported:_.isStreamingSupported,isRangeSupported:_.isRangeSupported,contentLength:_.contentLength})},T.reject),T.promise}),t.on("GetRangeReader",(u,T)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const _=this._networkStream.getRangeReader(u.begin,u.end);if(!_){T.close();return}T.onPull=()=>{_.read().then(function({value:p,done:a}){if(a){T.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(p),"GetRangeReader - expected an ArrayBuffer."),T.enqueue(new Uint8Array(p),1,[p])}).catch(p=>{T.error(p)})},T.onCancel=p=>{_.cancel(p),T.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("GetDoc",({pdfInfo:u})=>{this._numPages=u.numPages,this._htmlForXfa=u.htmlForXfa,delete u.htmlForXfa,l._capability.resolve(new PDFDocumentProxy(u,this))}),t.on("DocException",function(u){let T;switch(u.name){case"PasswordException":T=new _util.PasswordException(u.message,u.code);break;case"InvalidPDFException":T=new _util.InvalidPDFException(u.message);break;case"MissingPDFException":T=new _util.MissingPDFException(u.message);break;case"UnexpectedResponseException":T=new _util.UnexpectedResponseException(u.message,u.status);break;case"UnknownErrorException":T=new _util.UnknownErrorException(u.message,u.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}l._capability.reject(T)}),t.on("PasswordRequest",u=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),l.onPassword){const T=_=>{_ instanceof Error?this._passwordCapability.reject(_):this._passwordCapability.resolve({password:_})};try{l.onPassword(T,u.code)}catch(_){this._passwordCapability.reject(_)}}else this._passwordCapability.reject(new _util.PasswordException(u.message,u.code));return this._passwordCapability.promise}),t.on("DataLoaded",u=>{var T;(T=l.onProgress)==null||T.call(l,{loaded:u.length,total:u.length}),this.downloadInfoCapability.resolve(u)}),t.on("StartRenderPage",u=>{if(this.destroyed)return;D(this,O).get(u.pageIndex)._startRenderPage(u.transparency,u.cacheKey)}),t.on("commonobj",([u,T,_])=>{var p;if(!this.destroyed&&!this.commonObjs.has(u))switch(T){case"Font":const a=this._params;if("error"in _){const x=_.error;(0,_util.warn)(`Error during font loading: ${x}`),this.commonObjs.resolve(u,x);break}let o=null;a.pdfBug&&((p=globalThis.FontInspector)!=null&&p.enabled)&&(o={registerFont(x,C){globalThis.FontInspector.fontAdded(x,C)}});const n=new _font_loader.FontFaceObject(_,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:o});this.fontLoader.bind(n).catch(x=>t.sendWithPromise("FontFallback",{id:u})).finally(()=>{!a.fontExtraProperties&&n.data&&(n.data=null),this.commonObjs.resolve(u,n)});break;case"FontPath":case"Image":this.commonObjs.resolve(u,_);break;default:throw new Error(`Got unknown common object type ${T}`)}}),t.on("obj",([u,T,_,p])=>{var o;if(this.destroyed)return;const a=D(this,O).get(T);if(!a.objs.has(u))switch(_){case"Image":a.objs.resolve(u,p);const n=8e6;if(p){let x;if(p.bitmap){const{bitmap:C,width:z,height:G}=p;x=z*G*4,a._bitmaps.add(C)}else x=((o=p.data)==null?void 0:o.length)||0;x>n&&(a.cleanupAfterRender=!0)}break;case"Pattern":a.objs.resolve(u,p);break;default:throw new Error(`Got unknown object type ${_}`)}}),t.on("DocProgress",u=>{var T;this.destroyed||(T=l.onProgress)==null||T.call(l,{loaded:u.loaded,total:u.total})}),t.on("DocStats",u=>{this.destroyed||fe(this,c,Object.freeze({streamTypes:Object.freeze(u.streamTypes),fontTypes:Object.freeze(u.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(u):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(u):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var l,u;this.destroyed||(u=(l=this.loadingTask).onUnsupportedFeature)==null||u.call(l,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const l=t-1,u=D(this,L).get(l);if(u)return u;const T=this.messageHandler.sendWithPromise("GetPage",{pageIndex:l}).then(_=>{if(this.destroyed)throw new Error("Transport destroyed");const p=new PDFPageProxy(l,_,this,this._params.ownerDocument,this._params.pdfBug);return D(this,O).set(l,p),p});return D(this,L).set(l,T),T}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,l){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:l})}saveDocument(){var t;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((t=this._fullReader)==null?void 0:t.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return D(this,F)||fe(this,F,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var l,u;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:((l=this._fullReader)==null?void 0:l.filename)??null,contentLength:((u=this._fullReader)==null?void 0:u.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const l of D(this,O).values())if(!l.cleanup())throw new Error(`startCleanup: Page ${l.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),fe(this,F,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}c=new WeakMap,O=new WeakMap,L=new WeakMap,F=new WeakMap;class PDFObjects{constructor(){pe(this,m);pe(this,S,Object.create(null))}get(t,l=null){if(l){const T=he(this,m,ct).call(this,t);return T.capability.promise.then(()=>l(T.data)),null}const u=D(this,S)[t];if(!(u!=null&&u.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return u.data}has(t){const l=D(this,S)[t];return(l==null?void 0:l.capability.settled)||!1}resolve(t,l=null){const u=he(this,m,ct).call(this,t);u.data=l,u.capability.resolve()}clear(){fe(this,S,Object.create(null))}}S=new WeakMap,m=new WeakSet,ct=function(t){const l=D(this,S)[t];return l||(D(this,S)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){pe(this,N,null);fe(this,N,t),this.onContinue=null}get promise(){return D(this,N).capability.promise}cancel(){D(this,N).cancel()}get separateAnnots(){const{separateAnnots:t}=D(this,N).operatorList;if(!t)return!1;const{annotationCanvasMap:l}=D(this,N);return t.form||t.canvas&&(l==null?void 0:l.size)>0}}N=new WeakMap,exports.RenderTask=RenderTask;const P=class P{constructor({callback:t,params:l,objs:u,commonObjs:T,annotationCanvasMap:_,operatorList:p,pageIndex:a,canvasFactory:o,useRequestAnimationFrame:n=!1,pdfBug:x=!1,pageColors:C=null}){this.callback=t,this.params=l,this.objs=u,this.commonObjs=T,this.annotationCanvasMap=_,this.operatorListIdx=null,this.operatorList=p,this._pageIndex=a,this.canvasFactory=o,this._pdfBug=x,this.pageColors=C,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=n===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=l.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:l}){var o;if(this.cancelled)return;if(this._canvas){if(D(P,w).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");D(P,w).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:u,viewport:T,transform:_,imageLayer:p,background:a}=this.params;this.gfx=new _canvas.CanvasGraphics(u,this.commonObjs,this.objs,this.canvasFactory,p,l,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:_,viewport:T,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&D(P,w).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&D(P,w).delete(this._canvas),this.callback())))}};w=new WeakMap,pe(P,w,new WeakSet);let InternalRenderTask=P;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(v,s,b)=>{var S,Ct,R;Object.defineProperty(s,"__esModule",{value:!0}),s.PrintAnnotationStorage=s.AnnotationStorage=void 0;var e=b(1),c=b(6),O=b(10);class L{constructor(){pe(this,S);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(w,P){const h=this._storage.get(w);return h===void 0?P:Object.assign(P,h)}getRawValue(w){return this._storage.get(w)}remove(w){if(this._storage.delete(w),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const P of this._storage.values())if(P instanceof c.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(w,P){const h=this._storage.get(w);let t=!1;if(h!==void 0)for(const[l,u]of Object.entries(P))h[l]!==u&&(t=!0,h[l]=u);else t=!0,this._storage.set(w,P);t&&he(this,S,Ct).call(this),P instanceof c.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(P.constructor._type)}has(w){return this._storage.has(w)}getAll(){return this._storage.size>0?(0,e.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new F(this)}get serializable(){if(this._storage.size===0)return null;const w=new Map;for(const[P,h]of this._storage){const t=h instanceof c.AnnotationEditor?h.serialize():h;t&&w.set(P,t)}return w}static getHash(w){if(!w)return"";const P=new O.MurmurHash3_64;for(const[h,t]of w)P.update(`${h}:${JSON.stringify(t)}`);return P.hexdigest()}}S=new WeakSet,Ct=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},s.AnnotationStorage=L;class F extends L{constructor(P){super();pe(this,R,null);fe(this,R,structuredClone(P.serializable))}get print(){(0,e.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return D(this,R)}}R=new WeakMap,s.PrintAnnotationStorage=F},(v,s,b)=>{var L,F,S,m,R,N;Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationEditor=void 0;var e=b(7),c=b(1);const w=class w{constructor(h){pe(this,L,this.focusin.bind(this));pe(this,F,this.focusout.bind(this));pe(this,S,!1);pe(this,m,!1);pe(this,R,!1);pe(this,N,w._zIndex++);this.constructor===w&&(0,c.unreachable)("Cannot initialize AnnotationEditor."),this.parent=h.parent,this.id=h.id,this.width=this.height=null,this.pageIndex=h.parent.pageIndex,this.name=h.name,this.div=null;const[t,l]=this.parent.viewportBaseDimensions;this.x=h.x/t,this.y=h.y/l,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,c.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=D(this,N)}focusin(h){D(this,S)?fe(this,S,!1):this.parent.setSelected(this)}focusout(h){if(!this.isAttachedToDOM)return;const t=h.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(h.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(h){const t=this.parent.div.getBoundingClientRect();this.startX=h.clientX-t.x,this.startY=h.clientY-t.y,h.dataTransfer.setData("text/plain",this.id),h.dataTransfer.effectAllowed="move"}setAt(h,t,l,u){const[T,_]=this.parent.viewportBaseDimensions;[l,u]=this.screenToPageTranslation(l,u),this.x=(h+l)/T,this.y=(t+u)/_,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(h,t){const[l,u]=this.parent.viewportBaseDimensions;[h,t]=this.screenToPageTranslation(h,t),this.x+=h/l,this.y+=t/u,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(h,t){const{rotation:l}=this.parent.viewport;switch(l){case 90:return[t,-h];case 180:return[-h,-t];case 270:return[-t,h];default:return[h,t]}}setDims(h,t){const[l,u]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*h/l}%`,this.div.style.height=`${100*t/u}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",D(this,L)),this.div.addEventListener("focusout",D(this,F));const[h,t]=this.getInitialTranslation();return this.translate(h,t),(0,e.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(h){const t=e.KeyboardManager.platform.isMac;if(h.button!==0||h.ctrlKey&&t){h.preventDefault();return}h.ctrlKey&&!t||h.shiftKey||h.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),fe(this,S,!0)}getRect(h,t){const[l,u]=this.parent.viewportBaseDimensions,[T,_]=this.parent.pageDimensions,p=T*h/l,a=_*t/u,o=this.x*T,n=this.y*_,x=this.width*T,C=this.height*_;switch(this.rotation){case 0:return[o+p,_-n-a-C,o+p+x,_-n-a];case 90:return[o+a,_-n+p,o+a+C,_-n+p+x];case 180:return[o-p-x,_-n+a,o-p,_-n+a+C];case 270:return[o-a-C,_-n-p-x,o-a,_-n-p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(h,t){const[l,u,T,_]=h,p=T-l,a=_-u;switch(this.rotation){case 0:return[l,t-_,p,a];case 90:return[l,t-u,a,p];case 180:return[T,t-u,p,a];case 270:return[T,t-_,a,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){fe(this,R,!0)}disableEditMode(){fe(this,R,!1)}isInEditMode(){return D(this,R)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var h;(h=this.div)==null||h.addEventListener("focusin",D(this,L))}serialize(){(0,c.unreachable)("An editor must be serializable")}static deserialize(h,t){const l=new this.prototype.constructor({parent:t,id:t.getNextId()});l.rotation=h.rotation;const[u,T]=t.pageDimensions,[_,p,a,o]=l.getRectInCurrentCoords(h.rect,T);return l.x=_/u,l.y=p/T,l.width=a/u,l.height=o/T,l}remove(){this.div.removeEventListener("focusin",D(this,L)),this.div.removeEventListener("focusout",D(this,F)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var h;(h=this.div)==null||h.classList.add("selectedEditor")}unselect(){var h;(h=this.div)==null||h.classList.remove("selectedEditor")}updateParams(h,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return D(this,m)}set isEditing(h){fe(this,m,h),h?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};L=new WeakMap,F=new WeakMap,S=new WeakMap,m=new WeakMap,R=new WeakMap,N=new WeakMap,ke(w,"_colorManager",new e.ColorManager),ke(w,"_zIndex",1);let O=w;s.AnnotationEditor=O},(v,s,b)=>{var P,h,t,l,u,T,wt,a,n,x,C,z,G,oe,le,se,ne,X,J,Q,ie,de,ge,V,f,d,Rt,dt,De,Xe,kt,Ft,ut,Ye,Ze;Object.defineProperty(s,"__esModule",{value:!0}),s.KeyboardManager=s.CommandManager=s.ColorManager=s.AnnotationEditorUIManager=void 0,s.bindEvents=O,s.opacityToHex=L;var e=b(1),c=b(8);function O(M,y,j){for(const K of j)y.addEventListener(K,M[K].bind(M))}function L(M){return Math.round(Math.min(255,Math.max(1,255*M))).toString(16).padStart(2,"0")}class F{constructor(){pe(this,P,0)}getId(){return`${e.AnnotationEditorPrefix}${lt(this,P)._++}`}}P=new WeakMap;class S{constructor(y=128){pe(this,h,[]);pe(this,t,!1);pe(this,l);pe(this,u,-1);fe(this,l,y)}add({cmd:y,undo:j,mustExec:K,type:B=NaN,overwriteIfSameType:Y=!1,keepUndo:Z=!1}){if(K&&y(),D(this,t))return;const ae={cmd:y,undo:j,type:B};if(D(this,u)===-1){D(this,h).length>0&&(D(this,h).length=0),fe(this,u,0),D(this,h).push(ae);return}if(Y&&D(this,h)[D(this,u)].type===B){Z&&(ae.undo=D(this,h)[D(this,u)].undo),D(this,h)[D(this,u)]=ae;return}const ue=D(this,u)+1;ue===D(this,l)?D(this,h).splice(0,1):(fe(this,u,ue),ue<D(this,h).length&&D(this,h).splice(ue)),D(this,h).push(ae)}undo(){D(this,u)!==-1&&(fe(this,t,!0),D(this,h)[D(this,u)].undo(),fe(this,t,!1),fe(this,u,D(this,u)-1))}redo(){D(this,u)<D(this,h).length-1&&(fe(this,u,D(this,u)+1),fe(this,t,!0),D(this,h)[D(this,u)].cmd(),fe(this,t,!1))}hasSomethingToUndo(){return D(this,u)!==-1}hasSomethingToRedo(){return D(this,u)<D(this,h).length-1}destroy(){fe(this,h,null)}}h=new WeakMap,t=new WeakMap,l=new WeakMap,u=new WeakMap,s.CommandManager=S;const p=class p{constructor(y){pe(this,T);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const j=p.platform.isMac;for(const[K,B]of y)for(const Y of K){const Z=Y.startsWith("mac+");j&&Z?(this.callbacks.set(Y.slice(4),B),this.allKeys.add(Y.split("+").at(-1))):!j&&!Z&&(this.callbacks.set(Y,B),this.allKeys.add(Y.split("+").at(-1)))}}static get platform(){const y=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:y.includes("Win"),isMac:y.includes("Mac")})}exec(y,j){if(!this.allKeys.has(j.key))return;const K=this.callbacks.get(he(this,T,wt).call(this,j));K&&(K.bind(y)(),j.stopPropagation(),j.preventDefault())}};T=new WeakSet,wt=function(y){y.altKey&&this.buffer.push("alt"),y.ctrlKey&&this.buffer.push("ctrl"),y.metaKey&&this.buffer.push("meta"),y.shiftKey&&this.buffer.push("shift"),this.buffer.push(y.key);const j=this.buffer.join("+");return this.buffer.length=0,j};let m=p;s.KeyboardManager=m;class R{constructor(){pe(this,a,null)}copy(y){y&&(Array.isArray(y)?fe(this,a,y.map(j=>j.serialize())):fe(this,a,[y.serialize()]),fe(this,a,D(this,a).filter(j=>!!j)),D(this,a).length===0&&fe(this,a,null))}paste(){return D(this,a)}isEmpty(){return D(this,a)===null}destroy(){fe(this,a,null)}}a=new WeakMap;const o=class o{get _colors(){const y=new Map([["CanvasText",null],["Canvas",null]]);return(0,c.getColorValues)(y),(0,e.shadow)(this,"_colors",y)}convert(y){const j=(0,c.getRGB)(y);if(!window.matchMedia("(forced-colors: active)").matches)return j;for(const[K,B]of this._colors)if(B.every((Y,Z)=>Y===j[Z]))return o._colorsMapping.get(K);return j}getHexCode(y){const j=this._colors.get(y);return j?e.Util.makeHexColor(...j):y}};ke(o,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let N=o;s.ColorManager=N;const W=class W{constructor(y,j){pe(this,d);pe(this,n,null);pe(this,x,new Map);pe(this,C,new Map);pe(this,z,new R);pe(this,G,new S);pe(this,oe,0);pe(this,le,null);pe(this,se,null);pe(this,ne,new F);pe(this,X,!1);pe(this,J,e.AnnotationEditorType.NONE);pe(this,Q,new Set);pe(this,ie,this.keydown.bind(this));pe(this,de,this.onEditingAction.bind(this));pe(this,ge,this.onPageChanging.bind(this));pe(this,V,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});pe(this,f,null);fe(this,f,y),fe(this,se,j),D(this,se)._on("editingaction",D(this,de)),D(this,se)._on("pagechanging",D(this,ge))}destroy(){he(this,d,dt).call(this),D(this,se)._off("editingaction",D(this,de)),D(this,se)._off("pagechanging",D(this,ge));for(const y of D(this,C).values())y.destroy();D(this,C).clear(),D(this,x).clear(),fe(this,n,null),D(this,Q).clear(),D(this,z).destroy(),D(this,G).destroy()}onPageChanging({pageNumber:y}){fe(this,oe,y-1)}focusMainContainer(){D(this,f).focus()}keydown(y){var j;(j=this.getActive())!=null&&j.shouldGetKeyboardEvents()||W._keyboardManager.exec(this,y)}onEditingAction(y){["undo","redo","cut","copy","paste","delete","selectAll"].includes(y.name)&&this[y.name]()}setEditingState(y){y?(he(this,d,Rt).call(this),he(this,d,De).call(this,{isEditing:D(this,J)!==e.AnnotationEditorType.NONE,isEmpty:he(this,d,Ye).call(this),hasSomethingToUndo:D(this,G).hasSomethingToUndo(),hasSomethingToRedo:D(this,G).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:D(this,z).isEmpty()})):(he(this,d,dt).call(this),he(this,d,De).call(this,{isEditing:!1}))}registerEditorTypes(y){fe(this,le,y);for(const j of D(this,le))he(this,d,Xe).call(this,j.defaultPropertiesToUpdate)}getId(){return D(this,ne).getId()}addLayer(y){D(this,C).set(y.pageIndex,y),D(this,X)?y.enable():y.disable()}removeLayer(y){D(this,C).delete(y.pageIndex)}updateMode(y){if(fe(this,J,y),y===e.AnnotationEditorType.NONE)this.setEditingState(!1),he(this,d,Ft).call(this);else{this.setEditingState(!0),he(this,d,kt).call(this);for(const j of D(this,C).values())j.updateMode(y)}}updateToolbar(y){y!==D(this,J)&&D(this,se).dispatch("switchannotationeditormode",{source:this,mode:y})}updateParams(y,j){for(const K of D(this,Q))K.updateParams(y,j);for(const K of D(this,le))K.updateDefaultParams(y,j)}getEditors(y){const j=[];for(const K of D(this,x).values())K.pageIndex===y&&j.push(K);return j}getEditor(y){return D(this,x).get(y)}addEditor(y){D(this,x).set(y.id,y)}removeEditor(y){D(this,x).delete(y.id),this.unselect(y)}setActiveEditor(y){D(this,n)!==y&&(fe(this,n,y),y&&he(this,d,Xe).call(this,y.propertiesToUpdate))}toggleSelected(y){if(D(this,Q).has(y)){D(this,Q).delete(y),y.unselect(),he(this,d,De).call(this,{hasSelectedEditor:this.hasSelection});return}D(this,Q).add(y),y.select(),he(this,d,Xe).call(this,y.propertiesToUpdate),he(this,d,De).call(this,{hasSelectedEditor:!0})}setSelected(y){for(const j of D(this,Q))j!==y&&j.unselect();D(this,Q).clear(),D(this,Q).add(y),y.select(),he(this,d,Xe).call(this,y.propertiesToUpdate),he(this,d,De).call(this,{hasSelectedEditor:!0})}isSelected(y){return D(this,Q).has(y)}unselect(y){y.unselect(),D(this,Q).delete(y),he(this,d,De).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return D(this,Q).size!==0}undo(){D(this,G).undo(),he(this,d,De).call(this,{hasSomethingToUndo:D(this,G).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:he(this,d,Ye).call(this)})}redo(){D(this,G).redo(),he(this,d,De).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:D(this,G).hasSomethingToRedo(),isEmpty:he(this,d,Ye).call(this)})}addCommands(y){D(this,G).add(y),he(this,d,De).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:he(this,d,Ye).call(this)})}delete(){if(D(this,n)&&D(this,n).commitOrRemove(),!this.hasSelection)return;const y=[...D(this,Q)],j=()=>{for(const B of y)B.remove()},K=()=>{for(const B of y)he(this,d,ut).call(this,B)};this.addCommands({cmd:j,undo:K,mustExec:!0})}copy(){if(D(this,n)&&D(this,n).commitOrRemove(),this.hasSelection){const y=[];for(const j of D(this,Q))j.isEmpty()||y.push(j);if(y.length===0)return;D(this,z).copy(y),he(this,d,De).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(D(this,z).isEmpty())return;this.unselectAll();const y=D(this,C).get(D(this,oe)),j=D(this,z).paste().map(Y=>y.deserialize(Y)),K=()=>{for(const Y of j)he(this,d,ut).call(this,Y);he(this,d,Ze).call(this,j)},B=()=>{for(const Y of j)Y.remove()};this.addCommands({cmd:K,undo:B,mustExec:!0})}selectAll(){for(const y of D(this,Q))y.commit();he(this,d,Ze).call(this,D(this,x).values())}unselectAll(){if(D(this,n)){D(this,n).commitOrRemove();return}if(he(this,d,Ze).size!==0){for(const y of D(this,Q))y.unselect();D(this,Q).clear(),he(this,d,De).call(this,{hasSelectedEditor:!1})}}isActive(y){return D(this,n)===y}getActive(){return D(this,n)}getMode(){return D(this,J)}};n=new WeakMap,x=new WeakMap,C=new WeakMap,z=new WeakMap,G=new WeakMap,oe=new WeakMap,le=new WeakMap,se=new WeakMap,ne=new WeakMap,X=new WeakMap,J=new WeakMap,Q=new WeakMap,ie=new WeakMap,de=new WeakMap,ge=new WeakMap,V=new WeakMap,f=new WeakMap,d=new WeakSet,Rt=function(){D(this,f).addEventListener("keydown",D(this,ie))},dt=function(){D(this,f).removeEventListener("keydown",D(this,ie))},De=function(y){Object.entries(y).some(([K,B])=>D(this,V)[K]!==B)&&D(this,se).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(D(this,V),y)})},Xe=function(y){D(this,se).dispatch("annotationeditorparamschanged",{source:this,details:y})},kt=function(){if(!D(this,X)){fe(this,X,!0);for(const y of D(this,C).values())y.enable()}},Ft=function(){if(this.unselectAll(),D(this,X)){fe(this,X,!1);for(const y of D(this,C).values())y.disable()}},ut=function(y){const j=D(this,C).get(y.pageIndex);j?j.addOrRebuild(y):this.addEditor(y)},Ye=function(){if(D(this,x).size===0)return!0;if(D(this,x).size===1)for(const y of D(this,x).values())return y.isEmpty();return!1},Ze=function(y){D(this,Q).clear();for(const j of y)j.isEmpty()||(D(this,Q).add(j),j.select());he(this,d,De).call(this,{hasSelectedEditor:!0})},ke(W,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],W.prototype.selectAll],[["ctrl+c","mac+meta+c"],W.prototype.copy],[["ctrl+v","mac+meta+v"],W.prototype.paste],[["ctrl+x","mac+meta+x"],W.prototype.cut],[["ctrl+z","mac+meta+z"],W.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],W.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],W.prototype.delete],[["Escape","mac+Escape"],W.prototype.unselectAll]]));let w=W;s.AnnotationEditorUIManager=w},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.StatTimer=s.RenderingCancelledException=s.PixelsPerInch=s.PageViewport=s.PDFDateString=s.DOMStandardFontDataFactory=s.DOMSVGFactory=s.DOMCanvasFactory=s.DOMCMapReaderFactory=s.AnnotationPrefix=void 0,s.deprecated=o,s.getColorValues=G,s.getCurrentTransform=oe,s.getCurrentTransformInverse=le,s.getFilenameFromUrl=u,s.getPdfFilenameFromUrl=T,s.getRGB=z,s.getXfaPageViewport=C,s.isDataScheme=t,s.isPdfFile=l,s.isValidFetchUrl=p,s.loadScript=a;var e=b(9),c=b(1);const O="http://www.w3.org/2000/svg",L="pdfjs_internal_id_";s.AnnotationPrefix=L;const se=class se{};ke(se,"CSS",96),ke(se,"PDF",72),ke(se,"PDF_TO_CSS_UNITS",se.CSS/se.PDF);let F=se;s.PixelsPerInch=F;class S extends e.BaseCanvasFactory{constructor({ownerDocument:X=globalThis.document}={}){super(),this._document=X}_createCanvas(X,J){const Q=this._document.createElement("canvas");return Q.width=X,Q.height=J,Q}}s.DOMCanvasFactory=S;async function m(ne,X=!1){if(p(ne,document.baseURI)){const J=await fetch(ne);if(!J.ok)throw new Error(J.statusText);return X?new Uint8Array(await J.arrayBuffer()):(0,c.stringToBytes)(await J.text())}return new Promise((J,Q)=>{const ie=new XMLHttpRequest;ie.open("GET",ne,!0),X&&(ie.responseType="arraybuffer"),ie.onreadystatechange=()=>{if(ie.readyState===XMLHttpRequest.DONE){if(ie.status===200||ie.status===0){let de;if(X&&ie.response?de=new Uint8Array(ie.response):!X&&ie.responseText&&(de=(0,c.stringToBytes)(ie.responseText)),de){J(de);return}}Q(new Error(ie.statusText))}},ie.send(null)})}class R extends e.BaseCMapReaderFactory{_fetchData(X,J){return m(X,this.isCompressed).then(Q=>({cMapData:Q,compressionType:J}))}}s.DOMCMapReaderFactory=R;class N extends e.BaseStandardFontDataFactory{_fetchData(X){return m(X,!0)}}s.DOMStandardFontDataFactory=N;class w extends e.BaseSVGFactory{_createSVG(X){return document.createElementNS(O,X)}}s.DOMSVGFactory=w;class P{constructor({viewBox:X,scale:J,rotation:Q,offsetX:ie=0,offsetY:de=0,dontFlip:ge=!1}){this.viewBox=X,this.scale=J,this.rotation=Q,this.offsetX=ie,this.offsetY=de;const V=(X[2]+X[0])/2,f=(X[3]+X[1])/2;let d,I,q,$;switch(Q%=360,Q<0&&(Q+=360),Q){case 180:d=-1,I=0,q=0,$=1;break;case 90:d=0,I=1,q=1,$=0;break;case 270:d=0,I=-1,q=-1,$=0;break;case 0:d=1,I=0,q=0,$=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}ge&&(q=-q,$=-$);let H,i,g,E;d===0?(H=Math.abs(f-X[1])*J+ie,i=Math.abs(V-X[0])*J+de,g=Math.abs(X[3]-X[1])*J,E=Math.abs(X[2]-X[0])*J):(H=Math.abs(V-X[0])*J+ie,i=Math.abs(f-X[1])*J+de,g=Math.abs(X[2]-X[0])*J,E=Math.abs(X[3]-X[1])*J),this.transform=[d*J,I*J,q*J,$*J,H-d*J*V-q*J*f,i-I*J*V-$*J*f],this.width=g,this.height=E}clone({scale:X=this.scale,rotation:J=this.rotation,offsetX:Q=this.offsetX,offsetY:ie=this.offsetY,dontFlip:de=!1}={}){return new P({viewBox:this.viewBox.slice(),scale:X,rotation:J,offsetX:Q,offsetY:ie,dontFlip:de})}convertToViewportPoint(X,J){return c.Util.applyTransform([X,J],this.transform)}convertToViewportRectangle(X){const J=c.Util.applyTransform([X[0],X[1]],this.transform),Q=c.Util.applyTransform([X[2],X[3]],this.transform);return[J[0],J[1],Q[0],Q[1]]}convertToPdfPoint(X,J){return c.Util.applyInverseTransform([X,J],this.transform)}}s.PageViewport=P;class h extends c.BaseException{constructor(X,J){super(X,"RenderingCancelledException"),this.type=J}}s.RenderingCancelledException=h;function t(ne){const X=ne.length;let J=0;for(;J<X&&ne[J].trim()==="";)J++;return ne.substring(J,J+5).toLowerCase()==="data:"}function l(ne){return typeof ne=="string"&&/\.pdf$/i.test(ne)}function u(ne){const X=ne.indexOf("#"),J=ne.indexOf("?"),Q=Math.min(X>0?X:ne.length,J>0?J:ne.length);return ne.substring(ne.lastIndexOf("/",Q)+1,Q)}function T(ne,X="document.pdf"){if(typeof ne!="string")return X;if(t(ne))return(0,c.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),X;const J=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Q=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ie=J.exec(ne);let de=Q.exec(ie[1])||Q.exec(ie[2])||Q.exec(ie[3]);if(de&&(de=de[0],de.includes("%")))try{de=Q.exec(decodeURIComponent(de))[0]}catch{}return de||X}class _{constructor(){this.started=Object.create(null),this.times=[]}time(X){X in this.started&&(0,c.warn)(`Timer is already running for ${X}`),this.started[X]=Date.now()}timeEnd(X){X in this.started||(0,c.warn)(`Timer has not been started for ${X}`),this.times.push({name:X,start:this.started[X],end:Date.now()}),delete this.started[X]}toString(){const X=[];let J=0;for(const Q of this.times){const ie=Q.name;ie.length>J&&(J=ie.length)}for(const Q of this.times){const ie=Q.end-Q.start;X.push(`${Q.name.padEnd(J)} ${ie}ms
`)}return X.join("")}}s.StatTimer=_;function p(ne,X){try{const{protocol:J}=X?new URL(ne,X):new URL(ne);return J==="http:"||J==="https:"}catch{return!1}}function a(ne,X=!1){return new Promise((J,Q)=>{const ie=document.createElement("script");ie.src=ne,ie.onload=function(de){X&&ie.remove(),J(de)},ie.onerror=function(){Q(new Error(`Cannot load script at: ${ie.src}`))},(document.head||document.documentElement).append(ie)})}function o(ne){console.log("Deprecated API usage: "+ne)}let n;class x{static toDateObject(X){if(!X||typeof X!="string")return null;n||(n=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const J=n.exec(X);if(!J)return null;const Q=parseInt(J[1],10);let ie=parseInt(J[2],10);ie=ie>=1&&ie<=12?ie-1:0;let de=parseInt(J[3],10);de=de>=1&&de<=31?de:1;let ge=parseInt(J[4],10);ge=ge>=0&&ge<=23?ge:0;let V=parseInt(J[5],10);V=V>=0&&V<=59?V:0;let f=parseInt(J[6],10);f=f>=0&&f<=59?f:0;const d=J[7]||"Z";let I=parseInt(J[8],10);I=I>=0&&I<=23?I:0;let q=parseInt(J[9],10)||0;return q=q>=0&&q<=59?q:0,d==="-"?(ge+=I,V+=q):d==="+"&&(ge-=I,V-=q),new Date(Date.UTC(Q,ie,de,ge,V,f))}}s.PDFDateString=x;function C(ne,{scale:X=1,rotation:J=0}){const{width:Q,height:ie}=ne.attributes.style,de=[0,0,parseInt(Q),parseInt(ie)];return new P({viewBox:de,scale:X,rotation:J})}function z(ne){if(ne.startsWith("#")){const X=parseInt(ne.slice(1),16);return[(X&16711680)>>16,(X&65280)>>8,X&255]}return ne.startsWith("rgb(")?ne.slice(4,-1).split(",").map(X=>parseInt(X)):ne.startsWith("rgba(")?ne.slice(5,-1).split(",").map(X=>parseInt(X)).slice(0,3):((0,c.warn)(`Not a valid color format: "${ne}"`),[0,0,0])}function G(ne){const X=document.createElement("span");X.style.visibility="hidden",document.body.append(X);for(const J of ne.keys()){X.style.color=J;const Q=window.getComputedStyle(X).color;ne.set(J,z(Q))}X.remove()}function oe(ne){const{a:X,b:J,c:Q,d:ie,e:de,f:ge}=ne.getTransform();return[X,J,Q,ie,de,ge]}function le(ne){const{a:X,b:J,c:Q,d:ie,e:de,f:ge}=ne.getTransform().invertSelf();return[X,J,Q,ie,de,ge]}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BaseStandardFontDataFactory=s.BaseSVGFactory=s.BaseCanvasFactory=s.BaseCMapReaderFactory=void 0;var e=b(1);class c{constructor(){this.constructor===c&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,R){if(m<=0||R<=0)throw new Error("Invalid canvas size");const N=this._createCanvas(m,R);return{canvas:N,context:N.getContext("2d")}}reset(m,R,N){if(!m.canvas)throw new Error("Canvas is not specified");if(R<=0||N<=0)throw new Error("Invalid canvas size");m.canvas.width=R,m.canvas.height=N}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,R){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}s.BaseCanvasFactory=c;class O{constructor({baseUrl:m=null,isCompressed:R=!1}){this.constructor===O&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=R}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const R=this.baseUrl+m+(this.isCompressed?".bcmap":""),N=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(R,N).catch(w=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${R}`)})}_fetchData(m,R){(0,e.unreachable)("Abstract method `_fetchData` called.")}}s.BaseCMapReaderFactory=O;class L{constructor({baseUrl:m=null}){this.constructor===L&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const R=`${this.baseUrl}${m}`;return this._fetchData(R).catch(N=>{throw new Error(`Unable to load font data at: ${R}`)})}_fetchData(m){(0,e.unreachable)("Abstract method `_fetchData` called.")}}s.BaseStandardFontDataFactory=L;class F{constructor(){this.constructor===F&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,R,N=!1){if(m<=0||R<=0)throw new Error("Invalid SVG dimensions");const w=this._createSVG("svg:svg");return w.setAttribute("version","1.1"),N||(w.setAttribute("width",`${m}px`),w.setAttribute("height",`${R}px`)),w.setAttribute("preserveAspectRatio","none"),w.setAttribute("viewBox",`0 0 ${m} ${R}`),w}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,e.unreachable)("Abstract method `_createSVG` called.")}}s.BaseSVGFactory=F},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MurmurHash3_64=void 0;var e=b(1);const c=3285377520,O=4294901760,L=65535;class F{constructor(m){this.h1=m?m&4294967295:c,this.h2=m?m&4294967295:c}update(m){let R,N;if(typeof m=="string"){R=new Uint8Array(m.length*2),N=0;for(let n=0,x=m.length;n<x;n++){const C=m.charCodeAt(n);C<=255?R[N++]=C:(R[N++]=C>>>8,R[N++]=C&255)}}else if((0,e.isArrayBuffer)(m))R=m.slice(),N=R.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=N>>2,P=N-w*4,h=new Uint32Array(R.buffer,0,w);let t=0,l=0,u=this.h1,T=this.h2;const _=3432918353,p=461845907,a=_&L,o=p&L;for(let n=0;n<w;n++)n&1?(t=h[n],t=t*_&O|t*a&L,t=t<<15|t>>>17,t=t*p&O|t*o&L,u^=t,u=u<<13|u>>>19,u=u*5+3864292196):(l=h[n],l=l*_&O|l*a&L,l=l<<15|l>>>17,l=l*p&O|l*o&L,T^=l,T=T<<13|T>>>19,T=T*5+3864292196);switch(t=0,P){case 3:t^=R[w*4+2]<<16;case 2:t^=R[w*4+1]<<8;case 1:t^=R[w*4],t=t*_&O|t*a&L,t=t<<15|t>>>17,t=t*p&O|t*o&L,w&1?u^=t:T^=t}this.h1=u,this.h2=T}hexdigest(){let m=this.h1,R=this.h2;m^=R>>>1,m=m*3981806797&O|m*36045&L,R=R*4283543511&O|((R<<16|m>>>16)*2950163797&O)>>>16,m^=R>>>1,m=m*444984403&O|m*60499&L,R=R*3301882366&O|((R<<16|m>>>16)*3120437893&O)>>>16,m^=R>>>1;const N=(m>>>0).toString(16),w=(R>>>0).toString(16);return N.padStart(8,"0")+w.padStart(8,"0")}}s.MurmurHash3_64=F},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FontLoader=s.FontFaceObject=void 0;var e=b(1);class c{constructor({docId:S,onUnsupportedFeature:m,ownerDocument:R=globalThis.document,styleElement:N=null}){this.constructor===c&&(0,e.unreachable)("Cannot initialize BaseFontLoader."),this.docId=S,this._onUnsupportedFeature=m,this._document=R,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(S){this.nativeFontFaces.push(S),this._document.fonts.add(S)}insertRule(S){let m=this.styleElement;m||(m=this.styleElement=this._document.createElement("style"),m.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(m));const R=m.sheet;R.insertRule(S,R.cssRules.length)}clear(){for(const S of this.nativeFontFaces)this._document.fonts.delete(S);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(S){if(S.attached||S.missingFile)return;if(S.attached=!0,this.isFontLoadingAPISupported){const R=S.createNativeFontFace();if(R){this.addNativeFontFace(R);try{await R.loaded}catch(N){throw this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,e.warn)(`Failed to load font '${R.family}': '${N}'.`),S.disableFontFace=!0,N}}return}const m=S.createFontFaceRule();if(m){if(this.insertRule(m),this.isSyncFontLoadingSupported)return;await new Promise(R=>{const N=this._queueLoadingCallback(R);this._prepareFontLoadEvent([m],[S],N)})}}_queueLoadingCallback(S){(0,e.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var m;const S=!!((m=this._document)!=null&&m.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",S)}get isSyncFontLoadingSupported(){(0,e.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,e.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(S,m,R){(0,e.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let O;s.FontLoader=O,s.FontLoader=O=class extends c{constructor(S){super(S),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let S=!1;if(typeof navigator>"u")S=!0;else{const m=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(m==null?void 0:m[1])>=14&&(S=!0)}return(0,e.shadow)(this,"isSyncFontLoadingSupported",S)}_queueLoadingCallback(S){function m(){for((0,e.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;R.requests.length>0&&R.requests[0].done;){const w=R.requests.shift();setTimeout(w.callback,0)}}const R=this.loadingContext,N={id:`pdfjs-font-loading-${R.nextRequestId++}`,done:!1,complete:m,callback:S};return R.requests.push(N),N}get _loadTestFont(){const S=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,e.shadow)(this,"_loadTestFont",S())}_prepareFontLoadEvent(S,m,R){function N(le,se){return le.charCodeAt(se)<<24|le.charCodeAt(se+1)<<16|le.charCodeAt(se+2)<<8|le.charCodeAt(se+3)&255}function w(le,se,ne,X){const J=le.substring(0,se),Q=le.substring(se+ne);return J+X+Q}let P,h;const t=this._document.createElement("canvas");t.width=1,t.height=1;const l=t.getContext("2d");let u=0;function T(le,se){if(u++,u>30){(0,e.warn)("Load test font never loaded."),se();return}if(l.font="30px "+le,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){se();return}setTimeout(T.bind(null,le,se))}const _=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=w(p,976,_.length,_);const o=16,n=1482184792;let x=N(p,o);for(P=0,h=_.length-3;P<h;P+=4)x=x-n+N(_,P)|0;P<_.length&&(x=x-n+N(_+"XXX",P)|0),p=w(p,o,4,(0,e.string32)(x));const C=`url(data:font/opentype;base64,${btoa(p)});`,z=`@font-face {font-family:"${_}";src:${C}}`;this.insertRule(z);const G=[];for(const le of m)G.push(le.loadedName);G.push(_);const oe=this._document.createElement("div");oe.style.visibility="hidden",oe.style.width=oe.style.height="10px",oe.style.position="absolute",oe.style.top=oe.style.left="0px";for(const le of G){const se=this._document.createElement("span");se.textContent="Hi",se.style.fontFamily=le,oe.append(se)}this._document.body.append(oe),T(_,()=>{oe.remove(),R.complete()})}};class L{constructor(S,{isEvalSupported:m=!0,disableFontFace:R=!1,ignoreErrors:N=!1,onUnsupportedFeature:w,fontRegistry:P=null}){this.compiledGlyphs=Object.create(null);for(const h in S)this[h]=S[h];this.isEvalSupported=m!==!1,this.disableFontFace=R===!0,this.ignoreErrors=N===!0,this._onUnsupportedFeature=w,this.fontRegistry=P}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let S;if(!this.cssFontInfo)S=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),S=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return this.fontRegistry&&this.fontRegistry.registerFont(this),S}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const S=(0,e.bytesToString)(this.data),m=`url(data:${this.mimetype};base64,${btoa(S)});`;let R;if(!this.cssFontInfo)R=`@font-face {font-family:"${this.loadedName}";src:${m}}`;else{let N=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(N+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),R=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${N}src:${m}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,m),R}getPathGenerator(S,m){if(this.compiledGlyphs[m]!==void 0)return this.compiledGlyphs[m];let R;try{R=S.get(this.loadedName+"_path_"+m)}catch(N){if(!this.ignoreErrors)throw N;return this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,e.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[m]=function(w,P){}}if(this.isEvalSupported&&e.FeatureTest.isEvalSupported){const N=[];for(const w of R){const P=w.args!==void 0?w.args.join(","):"";N.push("c.",w.cmd,"(",P,`);
`)}return this.compiledGlyphs[m]=new Function("c","size",N.join(""))}return this.compiledGlyphs[m]=function(N,w){for(const P of R)P.cmd==="scale"&&(P.args=[w,-w]),N[P.cmd].apply(N,P.args)}}}s.FontFaceObject=L},(v,s,b)=>{var ie,ht;Object.defineProperty(s,"__esModule",{value:!0}),s.CanvasGraphics=void 0;var e=b(8),c=b(1),O=b(13),L=b(14),F=b(3);const S=16,m=100,R=4096,N=15,w=10,P=F.isNodeJS&&typeof Path2D>"u"?-1:1e3,h=16;function t(V,f){if(V._removeMirroring)throw new Error("Context is already forwarding operations.");V.__originalSave=V.save,V.__originalRestore=V.restore,V.__originalRotate=V.rotate,V.__originalScale=V.scale,V.__originalTranslate=V.translate,V.__originalTransform=V.transform,V.__originalSetTransform=V.setTransform,V.__originalResetTransform=V.resetTransform,V.__originalClip=V.clip,V.__originalMoveTo=V.moveTo,V.__originalLineTo=V.lineTo,V.__originalBezierCurveTo=V.bezierCurveTo,V.__originalRect=V.rect,V.__originalClosePath=V.closePath,V.__originalBeginPath=V.beginPath,V._removeMirroring=()=>{V.save=V.__originalSave,V.restore=V.__originalRestore,V.rotate=V.__originalRotate,V.scale=V.__originalScale,V.translate=V.__originalTranslate,V.transform=V.__originalTransform,V.setTransform=V.__originalSetTransform,V.resetTransform=V.__originalResetTransform,V.clip=V.__originalClip,V.moveTo=V.__originalMoveTo,V.lineTo=V.__originalLineTo,V.bezierCurveTo=V.__originalBezierCurveTo,V.rect=V.__originalRect,V.closePath=V.__originalClosePath,V.beginPath=V.__originalBeginPath,delete V._removeMirroring},V.save=function(){f.save(),this.__originalSave()},V.restore=function(){f.restore(),this.__originalRestore()},V.translate=function(I,q){f.translate(I,q),this.__originalTranslate(I,q)},V.scale=function(I,q){f.scale(I,q),this.__originalScale(I,q)},V.transform=function(I,q,$,H,i,g){f.transform(I,q,$,H,i,g),this.__originalTransform(I,q,$,H,i,g)},V.setTransform=function(I,q,$,H,i,g){f.setTransform(I,q,$,H,i,g),this.__originalSetTransform(I,q,$,H,i,g)},V.resetTransform=function(){f.resetTransform(),this.__originalResetTransform()},V.rotate=function(I){f.rotate(I),this.__originalRotate(I)},V.clip=function(I){f.clip(I),this.__originalClip(I)},V.moveTo=function(d,I){f.moveTo(d,I),this.__originalMoveTo(d,I)},V.lineTo=function(d,I){f.lineTo(d,I),this.__originalLineTo(d,I)},V.bezierCurveTo=function(d,I,q,$,H,i){f.bezierCurveTo(d,I,q,$,H,i),this.__originalBezierCurveTo(d,I,q,$,H,i)},V.rect=function(d,I,q,$){f.rect(d,I,q,$),this.__originalRect(d,I,q,$)},V.closePath=function(){f.closePath(),this.__originalClosePath()},V.beginPath=function(){f.beginPath(),this.__originalBeginPath()}}class l{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,d,I){let q;return this.cache[f]!==void 0?(q=this.cache[f],this.canvasFactory.reset(q,d,I)):(q=this.canvasFactory.create(d,I),this.cache[f]=q),q}delete(f){delete this.cache[f]}clear(){for(const f in this.cache){const d=this.cache[f];this.canvasFactory.destroy(d),delete this.cache[f]}}}function u(V,f,d,I,q,$,H,i,g,E){const[A,k,W,M,y,j]=(0,e.getCurrentTransform)(V);if(k===0&&W===0){const Y=H*A+y,Z=Math.round(Y),ae=i*M+j,ue=Math.round(ae),re=(H+g)*A+y,be=Math.abs(Math.round(re)-Z)||1,_e=(i+E)*M+j,me=Math.abs(Math.round(_e)-ue)||1;return V.setTransform(Math.sign(A),0,0,Math.sign(M),Z,ue),V.drawImage(f,d,I,q,$,0,0,be,me),V.setTransform(A,k,W,M,y,j),[be,me]}if(A===0&&M===0){const Y=i*W+y,Z=Math.round(Y),ae=H*k+j,ue=Math.round(ae),re=(i+E)*W+y,be=Math.abs(Math.round(re)-Z)||1,_e=(H+g)*k+j,me=Math.abs(Math.round(_e)-ue)||1;return V.setTransform(0,Math.sign(k),Math.sign(W),0,Z,ue),V.drawImage(f,d,I,q,$,0,0,me,be),V.setTransform(A,k,W,M,y,j),[me,be]}V.drawImage(f,d,I,q,$,H,i,g,E);const K=Math.hypot(A,k),B=Math.hypot(W,M);return[K*g,B*E]}function T(V){const{width:f,height:d}=V;if(f>P||d>P)return null;const I=1e3,q=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),$=f+1;let H=new Uint8Array($*(d+1)),i,g,E;const A=f+7&-8;let k=new Uint8Array(A*d),W=0;for(const B of V.data){let Y=128;for(;Y>0;)k[W++]=B&Y?0:255,Y>>=1}let M=0;for(W=0,k[W]!==0&&(H[0]=1,++M),g=1;g<f;g++)k[W]!==k[W+1]&&(H[g]=k[W]?2:1,++M),W++;for(k[W]!==0&&(H[g]=2,++M),i=1;i<d;i++){W=i*A,E=i*$,k[W-A]!==k[W]&&(H[E]=k[W]?1:8,++M);let B=(k[W]?4:0)+(k[W-A]?8:0);for(g=1;g<f;g++)B=(B>>2)+(k[W+1]?4:0)+(k[W-A+1]?8:0),q[B]&&(H[E+g]=q[B],++M),W++;if(k[W-A]!==k[W]&&(H[E+g]=k[W]?2:4,++M),M>I)return null}for(W=A*(d-1),E=i*$,k[W]!==0&&(H[E]=8,++M),g=1;g<f;g++)k[W]!==k[W+1]&&(H[E+g]=k[W]?4:8,++M),W++;if(k[W]!==0&&(H[E+g]=4,++M),M>I)return null;const y=new Int32Array([0,$,-1,0,-$,0,0,0,1]),j=new Path2D;for(i=0;M&&i<=d;i++){let B=i*$;const Y=B+f;for(;B<Y&&!H[B];)B++;if(B===Y)continue;j.moveTo(B%$,i);const Z=B;let ae=H[B];do{const ue=y[ae];do B+=ue;while(!H[B]);const re=H[B];re!==5&&re!==10?(ae=re,H[B]=0):(ae=re&51*ae>>4,H[B]&=ae>>2|ae<<2),j.lineTo(B%$,B/$|0),H[B]||--M}while(Z!==B);--i}return k=null,H=null,function(B){B.save(),B.scale(1/f,-1/d),B.translate(0,-d),B.fill(j),B.beginPath(),B.restore()}}class _{constructor(f,d){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,f,d])}clone(){const f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,d){this.x=f,this.y=d}updatePathMinMax(f,d,I){[d,I]=c.Util.applyTransform([d,I],f),this.minX=Math.min(this.minX,d),this.minY=Math.min(this.minY,I),this.maxX=Math.max(this.maxX,d),this.maxY=Math.max(this.maxY,I)}updateRectMinMax(f,d){const I=c.Util.applyTransform(d,f),q=c.Util.applyTransform(d.slice(2),f);this.minX=Math.min(this.minX,I[0],q[0]),this.minY=Math.min(this.minY,I[1],q[1]),this.maxX=Math.max(this.maxX,I[0],q[0]),this.maxY=Math.max(this.maxY,I[1],q[1])}updateScalingPathMinMax(f,d){c.Util.scaleMinMax(f,d),this.minX=Math.min(this.minX,d[0]),this.maxX=Math.max(this.maxX,d[1]),this.minY=Math.min(this.minY,d[2]),this.maxY=Math.max(this.maxY,d[3])}updateCurvePathMinMax(f,d,I,q,$,H,i,g,E,A){const k=c.Util.bezierBoundingBox(d,I,q,$,H,i,g,E);if(A){A[0]=Math.min(A[0],k[0],k[2]),A[1]=Math.max(A[1],k[0],k[2]),A[2]=Math.min(A[2],k[1],k[3]),A[3]=Math.max(A[3],k[1],k[3]);return}this.updateRectMinMax(f,k)}getPathBoundingBox(f=O.PathType.FILL,d=null){const I=[this.minX,this.minY,this.maxX,this.maxY];if(f===O.PathType.STROKE){d||(0,c.unreachable)("Stroke bounding box must include transform.");const q=c.Util.singularValueDecompose2dScale(d),$=q[0]*this.lineWidth/2,H=q[1]*this.lineWidth/2;I[0]-=$,I[1]-=H,I[2]+=$,I[3]+=H}return I}updateClipFromPath(){const f=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=O.PathType.FILL,d=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(f,d))}}function p(V,f,d=null){if(typeof ImageData<"u"&&f instanceof ImageData){V.putImageData(f,0,0);return}const I=f.height,q=f.width,$=I%h,H=(I-$)/h,i=$===0?H:H+1,g=V.createImageData(q,h);let E=0,A;const k=f.data,W=g.data;let M,y,j,K,B,Y,Z,ae;if(d)switch(d.length){case 1:B=d[0],Y=d[0],Z=d[0],ae=d[0];break;case 4:B=d[0],Y=d[1],Z=d[2],ae=d[3];break}if(f.kind===c.ImageKind.GRAYSCALE_1BPP){const ue=k.byteLength,re=new Uint32Array(W.buffer,0,W.byteLength>>2),be=re.length,_e=q+7>>3;let me=4294967295,ve=c.FeatureTest.isLittleEndian?4278190080:255;for(ae&&ae[0]===255&&ae[255]===0&&([me,ve]=[ve,me]),M=0;M<i;M++){for(j=M<H?h:$,A=0,y=0;y<j;y++){const xe=ue-E;let we=0;const Ee=xe>_e?q:xe*8-7,Re=Ee&-8;let Pe=0,Te=0;for(;we<Re;we+=8)Te=k[E++],re[A++]=Te&128?me:ve,re[A++]=Te&64?me:ve,re[A++]=Te&32?me:ve,re[A++]=Te&16?me:ve,re[A++]=Te&8?me:ve,re[A++]=Te&4?me:ve,re[A++]=Te&2?me:ve,re[A++]=Te&1?me:ve;for(;we<Ee;we++)Pe===0&&(Te=k[E++],Pe=128),re[A++]=Te&Pe?me:ve,Pe>>=1}for(;A<be;)re[A++]=0;V.putImageData(g,0,M*h)}}else if(f.kind===c.ImageKind.RGBA_32BPP){const ue=!!(B||Y||Z);for(y=0,K=q*h*4,M=0;M<H;M++){if(W.set(k.subarray(E,E+K)),E+=K,ue)for(let re=0;re<K;re+=4)B&&(W[re+0]=B[W[re+0]]),Y&&(W[re+1]=Y[W[re+1]]),Z&&(W[re+2]=Z[W[re+2]]);V.putImageData(g,0,y),y+=h}if(M<i){if(K=q*$*4,W.set(k.subarray(E,E+K)),ue)for(let re=0;re<K;re+=4)B&&(W[re+0]=B[W[re+0]]),Y&&(W[re+1]=Y[W[re+1]]),Z&&(W[re+2]=Z[W[re+2]]);V.putImageData(g,0,y)}}else if(f.kind===c.ImageKind.RGB_24BPP){const ue=!!(B||Y||Z);for(j=h,K=q*j,M=0;M<i;M++){for(M>=H&&(j=$,K=q*j),A=0,y=K;y--;)W[A++]=k[E++],W[A++]=k[E++],W[A++]=k[E++],W[A++]=255;if(ue)for(let re=0;re<A;re+=4)B&&(W[re+0]=B[W[re+0]]),Y&&(W[re+1]=Y[W[re+1]]),Z&&(W[re+2]=Z[W[re+2]]);V.putImageData(g,0,M*h)}}else throw new Error(`bad image kind: ${f.kind}`)}function a(V,f){if(f.bitmap){V.drawImage(f.bitmap,0,0);return}const d=f.height,I=f.width,q=d%h,$=(d-q)/h,H=q===0?$:$+1,i=V.createImageData(I,h);let g=0;const E=f.data,A=i.data;for(let k=0;k<H;k++){const W=k<$?h:q;({srcPos:g}=(0,L.applyMaskImageData)({src:E,srcPos:g,dest:A,width:I,height:W})),V.putImageData(i,0,k*h)}}function o(V,f){const d=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let I=0,q=d.length;I<q;I++){const $=d[I];V[$]!==void 0&&(f[$]=V[$])}V.setLineDash!==void 0&&(f.setLineDash(V.getLineDash()),f.lineDashOffset=V.lineDashOffset)}function n(V,f){V.strokeStyle=V.fillStyle=f||"#000000",V.fillRule="nonzero",V.globalAlpha=1,V.lineWidth=1,V.lineCap="butt",V.lineJoin="miter",V.miterLimit=10,V.globalCompositeOperation="source-over",V.font="10px sans-serif",V.setLineDash!==void 0&&(V.setLineDash([]),V.lineDashOffset=0)}function x(V,f,d,I){const q=V.length;for(let $=3;$<q;$+=4){const H=V[$];if(H===0)V[$-3]=f,V[$-2]=d,V[$-1]=I;else if(H<255){const i=255-H;V[$-3]=V[$-3]*H+f*i>>8,V[$-2]=V[$-2]*H+d*i>>8,V[$-1]=V[$-1]*H+I*i>>8}}}function C(V,f,d){const I=V.length,q=1/255;for(let $=3;$<I;$+=4){const H=d?d[V[$]]:V[$];f[$]=f[$]*H*q|0}}function z(V,f,d){const I=V.length;for(let q=3;q<I;q+=4){const $=V[q-3]*77+V[q-2]*152+V[q-1]*28;f[q]=d?f[q]*d[$>>8]>>8:f[q]*$>>16}}function G(V,f,d,I,q,$,H,i,g,E,A){const k=!!$,W=k?$[0]:0,M=k?$[1]:0,y=k?$[2]:0;let j;q==="Luminosity"?j=z:j=C;const B=Math.min(I,Math.ceil(1048576/d));for(let Y=0;Y<I;Y+=B){const Z=Math.min(B,I-Y),ae=V.getImageData(i-E,Y+(g-A),d,Z),ue=f.getImageData(i,Y+g,d,Z);k&&x(ae.data,W,M,y),j(ae.data,ue.data,H),f.putImageData(ue,i,Y+g)}}function oe(V,f,d,I){const q=I[0],$=I[1],H=I[2]-q,i=I[3]-$;H===0||i===0||(G(f.context,d,H,i,f.subtype,f.backdrop,f.transferMap,q,$,f.offsetX,f.offsetY),V.save(),V.globalAlpha=1,V.globalCompositeOperation="source-over",V.setTransform(1,0,0,1,0,0),V.drawImage(d.canvas,0,0),V.restore())}function le(V,f){const d=c.Util.singularValueDecompose2dScale(V);d[0]=Math.fround(d[0]),d[1]=Math.fround(d[1]);const I=Math.fround((globalThis.devicePixelRatio||1)*e.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:d[0]<=I||d[1]<=I}const se=["butt","round","square"],ne=["miter","round","bevel"],X={},J={},ge=class ge{constructor(f,d,I,q,$,H,i,g){pe(this,ie);this.ctx=f,this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=d,this.objs=I,this.canvasFactory=q,this.imageLayer=$,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=H,this.cachedCanvases=new l(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=i,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(g==null?void 0:g.background)||null,this.foregroundColor=(g==null?void 0:g.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,d=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):d}beginDrawing({transform:f,viewport:d,transparency:I=!1,background:q=null}){const $=this.ctx.canvas.width,H=this.ctx.canvas.height,i=q||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const g=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const E=this.backgroundColor=this.ctx.fillStyle;let A=!0,k=i;if(this.ctx.fillStyle=i,k=this.ctx.fillStyle,A=typeof k=="string"&&/^#[0-9A-Fa-f]{6}$/.test(k),g==="#000000"&&E==="#ffffff"||g===E||!A)this.foregroundColor=this.backgroundColor=null;else{const[W,M,y]=(0,e.getRGB)(k),j=B=>(B/=255,B<=.03928?B/12.92:((B+.055)/1.055)**2.4),K=Math.round(.2126*j(W)+.7152*j(M)+.0722*j(y));this.selectColor=(B,Y,Z)=>{const ae=.2126*j(B)+.7152*j(Y)+.0722*j(Z);return Math.round(ae)===K?E:g}}}if(this.ctx.fillStyle=this.backgroundColor||i,this.ctx.fillRect(0,0,$,H),this.ctx.restore(),I){const g=this.cachedCanvases.getCanvas("transparent",$,H);this.compositeCtx=this.ctx,this.transparentCanvas=g.canvas,this.ctx=g.context,this.ctx.save(),this.ctx.transform(...(0,e.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),n(this.ctx,this.foregroundColor),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...d.transform),this.viewportScale=d.scale,this.baseTransform=(0,e.getCurrentTransform)(this.ctx),this.imageLayer&&((0,e.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(f,d,I,q){const $=f.argsArray,H=f.fnArray;let i=d||0;const g=$.length;if(g===i)return i;const E=g-i>w&&typeof I=="function",A=E?Date.now()+N:0;let k=0;const W=this.commonObjs,M=this.objs;let y;for(;;){if(q!==void 0&&i===q.nextBreakPoint)return q.breakIt(i,I),i;if(y=H[i],y!==c.OPS.dependency)this[y].apply(this,$[i]);else for(const j of $[i]){const K=j.startsWith("g_")?W:M;if(!K.has(j))return K.get(j,I),i}if(i++,i===g)return i;if(E&&++k>w){if(Date.now()>A)return I(),i;k=0}}}endDrawing(){he(this,ie,ht).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const f of this._cachedBitmapsMap.values()){for(const d of f.values())typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement&&(d.width=d.height=0);f.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(f,d){const I=f.width,q=f.height;let $=Math.max(Math.hypot(d[0],d[1]),1),H=Math.max(Math.hypot(d[2],d[3]),1),i=I,g=q,E="prescale1",A,k;for(;$>2&&i>1||H>2&&g>1;){let W=i,M=g;$>2&&i>1&&(W=Math.ceil(i/2),$/=i/W),H>2&&g>1&&(M=Math.ceil(g/2),H/=g/M),A=this.cachedCanvases.getCanvas(E,W,M),k=A.context,k.clearRect(0,0,W,M),k.drawImage(f,0,0,i,g,0,0,W,M),f=A.canvas,i=W,g=M,E=E==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:i,paintHeight:g}}_createMaskCanvas(f){const d=this.ctx,{width:I,height:q}=f,$=this.current.fillColor,H=this.current.patternFill,i=(0,e.getCurrentTransform)(d);let g,E,A,k;if((f.bitmap||f.data)&&f.count>1){const be=f.bitmap||f.data.buffer,_e=i.slice(0,4);E=JSON.stringify(H?_e:[_e,$]),g=this._cachedBitmapsMap.get(be),g||(g=new Map,this._cachedBitmapsMap.set(be,g));const me=g.get(E);if(me&&!H){const ve=Math.round(Math.min(i[0],i[2])+i[4]),xe=Math.round(Math.min(i[1],i[3])+i[5]);return{canvas:me,offsetX:ve,offsetY:xe}}A=me}A||(k=this.cachedCanvases.getCanvas("maskCanvas",I,q),a(k.context,f));let W=c.Util.transform(i,[1/I,0,0,-1/q,0,0]);W=c.Util.transform(W,[1,0,0,1,0,-q]);const M=c.Util.applyTransform([0,0],W),y=c.Util.applyTransform([I,q],W),j=c.Util.normalizeRect([M[0],M[1],y[0],y[1]]),K=Math.round(j[2]-j[0])||1,B=Math.round(j[3]-j[1])||1,Y=this.cachedCanvases.getCanvas("fillCanvas",K,B),Z=Y.context,ae=Math.min(M[0],y[0]),ue=Math.min(M[1],y[1]);Z.translate(-ae,-ue),Z.transform(...W),A||(A=this._scaleImage(k.canvas,(0,e.getCurrentTransformInverse)(Z)),A=A.img,g&&H&&g.set(E,A)),Z.imageSmoothingEnabled=le((0,e.getCurrentTransform)(Z),f.interpolate),u(Z,A,0,0,A.width,A.height,0,0,I,q),Z.globalCompositeOperation="source-in";const re=c.Util.transform((0,e.getCurrentTransformInverse)(Z),[1,0,0,1,-ae,-ue]);return Z.fillStyle=H?$.getPattern(d,this,re,O.PathType.FILL):$,Z.fillRect(0,0,I,q),g&&!H&&(this.cachedCanvases.delete("fillCanvas"),g.set(E,Y.canvas)),{canvas:Y.canvas,offsetX:Math.round(ae),offsetY:Math.round(ue)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=se[f]}setLineJoin(f){this.ctx.lineJoin=ne[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,d){const I=this.ctx;I.setLineDash!==void 0&&(I.setLineDash(f),I.lineDashOffset=d)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(let d=0,I=f.length;d<I;d++){const q=f[d],$=q[0],H=q[1];switch($){case"LW":this.setLineWidth(H);break;case"LC":this.setLineCap(H);break;case"LJ":this.setLineJoin(H);break;case"ML":this.setMiterLimit(H);break;case"D":this.setDash(H[0],H[1]);break;case"RI":this.setRenderingIntent(H);break;case"FL":this.setFlatness(H);break;case"Font":this.setFont(H[0],H[1]);break;case"CA":this.current.strokeAlpha=q[1];break;case"ca":this.current.fillAlpha=q[1],this.ctx.globalAlpha=q[1];break;case"BM":this.ctx.globalCompositeOperation=H;break;case"SMask":this.current.activeSMask=H?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=H}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const f=this.ctx.canvas.width,d=this.ctx.canvas.height,I="smaskGroupAt"+this.groupLevel,q=this.cachedCanvases.getCanvas(I,f,d);this.suspendedCtx=this.ctx,this.ctx=q.context;const $=this.ctx;$.setTransform(...(0,e.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,$),t($,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const d=this.current.activeSMask,I=this.suspendedCtx;oe(I,d,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(f,d,I,q,$,H){this.ctx.transform(f,d,I,q,$,H),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(f,d,I){const q=this.ctx,$=this.current;let H=$.x,i=$.y,g,E;const A=(0,e.getCurrentTransform)(q),k=A[0]===0&&A[3]===0||A[1]===0&&A[2]===0,W=k?I.slice(0):null;for(let M=0,y=0,j=f.length;M<j;M++)switch(f[M]|0){case c.OPS.rectangle:H=d[y++],i=d[y++];const K=d[y++],B=d[y++],Y=H+K,Z=i+B;q.moveTo(H,i),K===0||B===0?q.lineTo(Y,Z):(q.lineTo(Y,i),q.lineTo(Y,Z),q.lineTo(H,Z)),k||$.updateRectMinMax(A,[H,i,Y,Z]),q.closePath();break;case c.OPS.moveTo:H=d[y++],i=d[y++],q.moveTo(H,i),k||$.updatePathMinMax(A,H,i);break;case c.OPS.lineTo:H=d[y++],i=d[y++],q.lineTo(H,i),k||$.updatePathMinMax(A,H,i);break;case c.OPS.curveTo:g=H,E=i,H=d[y+4],i=d[y+5],q.bezierCurveTo(d[y],d[y+1],d[y+2],d[y+3],H,i),$.updateCurvePathMinMax(A,g,E,d[y],d[y+1],d[y+2],d[y+3],H,i,W),y+=6;break;case c.OPS.curveTo2:g=H,E=i,q.bezierCurveTo(H,i,d[y],d[y+1],d[y+2],d[y+3]),$.updateCurvePathMinMax(A,g,E,H,i,d[y],d[y+1],d[y+2],d[y+3],W),H=d[y+2],i=d[y+3],y+=4;break;case c.OPS.curveTo3:g=H,E=i,H=d[y+2],i=d[y+3],q.bezierCurveTo(d[y],d[y+1],H,i,H,i),$.updateCurvePathMinMax(A,g,E,d[y],d[y+1],H,i,H,i,W),y+=4;break;case c.OPS.closePath:q.closePath();break}k&&$.updateScalingPathMinMax(A,W),$.setCurrentPoint(H,i)}closePath(){this.ctx.closePath()}stroke(f){f=typeof f<"u"?f:!0;const d=this.ctx,I=this.current.strokeColor;d.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof I=="object"&&(I!=null&&I.getPattern)?(d.save(),d.strokeStyle=I.getPattern(d,this,(0,e.getCurrentTransformInverse)(d),O.PathType.STROKE),this.rescaleAndStroke(!1),d.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),d.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f){f=typeof f<"u"?f:!0;const d=this.ctx,I=this.current.fillColor,q=this.current.patternFill;let $=!1;q&&(d.save(),d.fillStyle=I.getPattern(d,this,(0,e.getCurrentTransformInverse)(d),O.PathType.FILL),$=!0);const H=this.current.getClippedPathBoundingBox();this.contentVisible&&H!==null&&(this.pendingEOFill?(d.fill("evenodd"),this.pendingEOFill=!1):d.fill()),$&&d.restore(),f&&this.consumePath(H)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=X}eoClip(){this.pendingClip=J}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const f=this.pendingTextPaths,d=this.ctx;if(f===void 0){d.beginPath();return}d.save(),d.beginPath();for(const I of f)d.setTransform(...I.transform),d.translate(I.x,I.y),I.addToPath(d,I.fontSize);d.restore(),d.clip(),d.beginPath(),delete this.pendingTextPaths}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,d){const I=this.commonObjs.get(f),q=this.current;if(!I)throw new Error(`Can't find font for ${f}`);if(q.fontMatrix=I.fontMatrix||c.FONT_IDENTITY_MATRIX,(q.fontMatrix[0]===0||q.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+f),d<0?(d=-d,q.fontDirection=-1):q.fontDirection=1,this.current.font=I,this.current.fontSize=d,I.isType3Font)return;const $=I.loadedName||"sans-serif";let H="normal";I.black?H="900":I.bold&&(H="bold");const i=I.italic?"italic":"normal",g=`"${$}", ${I.fallbackName}`;let E=d;d<S?E=S:d>m&&(E=m),this.current.fontSizeScale=d/E,this.ctx.font=`${i} ${H} ${E}px ${g}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,d){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=d}setLeadingMoveText(f,d){this.setLeading(-d),this.moveText(f,d)}setTextMatrix(f,d,I,q,$,H){this.current.textMatrix=[f,d,I,q,$,H],this.current.textMatrixScale=Math.hypot(f,d),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,d,I,q){const $=this.ctx,H=this.current,i=H.font,g=H.textRenderingMode,E=H.fontSize/H.fontSizeScale,A=g&c.TextRenderingMode.FILL_STROKE_MASK,k=!!(g&c.TextRenderingMode.ADD_TO_PATH_FLAG),W=H.patternFill&&!i.missingFile;let M;(i.disableFontFace||k||W)&&(M=i.getPathGenerator(this.commonObjs,f)),i.disableFontFace||W?($.save(),$.translate(d,I),$.beginPath(),M($,E),q&&$.setTransform(...q),(A===c.TextRenderingMode.FILL||A===c.TextRenderingMode.FILL_STROKE)&&$.fill(),(A===c.TextRenderingMode.STROKE||A===c.TextRenderingMode.FILL_STROKE)&&$.stroke(),$.restore()):((A===c.TextRenderingMode.FILL||A===c.TextRenderingMode.FILL_STROKE)&&$.fillText(f,d,I),(A===c.TextRenderingMode.STROKE||A===c.TextRenderingMode.FILL_STROKE)&&$.strokeText(f,d,I)),k&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,e.getCurrentTransform)($),x:d,y:I,fontSize:E,addToPath:M})}get isFontSubpixelAAEnabled(){const{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);const d=f.getImageData(0,0,10,10).data;let I=!1;for(let q=3;q<d.length;q+=4)if(d[q]>0&&d[q]<255){I=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",I)}showText(f){const d=this.current,I=d.font;if(I.isType3Font)return this.showType3Text(f);const q=d.fontSize;if(q===0)return;const $=this.ctx,H=d.fontSizeScale,i=d.charSpacing,g=d.wordSpacing,E=d.fontDirection,A=d.textHScale*E,k=f.length,W=I.vertical,M=W?1:-1,y=I.defaultVMetrics,j=q*d.fontMatrix[0],K=d.textRenderingMode===c.TextRenderingMode.FILL&&!I.disableFontFace&&!d.patternFill;$.save(),$.transform(...d.textMatrix),$.translate(d.x,d.y+d.textRise),E>0?$.scale(A,-1):$.scale(A,1);let B;if(d.patternFill){$.save();const re=d.fillColor.getPattern($,this,(0,e.getCurrentTransformInverse)($),O.PathType.FILL);B=(0,e.getCurrentTransform)($),$.restore(),$.fillStyle=re}let Y=d.lineWidth;const Z=d.textMatrixScale;if(Z===0||Y===0){const re=d.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(re===c.TextRenderingMode.STROKE||re===c.TextRenderingMode.FILL_STROKE)&&(Y=this.getSinglePixelWidth())}else Y/=Z;H!==1&&($.scale(H,H),Y/=H),$.lineWidth=Y;let ae=0,ue;for(ue=0;ue<k;++ue){const re=f[ue];if(typeof re=="number"){ae+=M*re*q/1e3;continue}let be=!1;const _e=(re.isSpace?g:0)+i,me=re.fontChar,ve=re.accent;let xe,we,Ee=re.width;if(W){const Pe=re.vmetric||y,Te=-(re.vmetric?Pe[1]:Ee*.5)*j,Le=Pe[2]*j;Ee=Pe?-Pe[0]:Ee,xe=Te/H,we=(ae+Le)/H}else xe=ae/H,we=0;if(I.remeasure&&Ee>0){const Pe=$.measureText(me).width*1e3/q*H;if(Ee<Pe&&this.isFontSubpixelAAEnabled){const Te=Ee/Pe;be=!0,$.save(),$.scale(Te,1),xe/=Te}else Ee!==Pe&&(xe+=(Ee-Pe)/2e3*q/H)}if(this.contentVisible&&(re.isInFont||I.missingFile)){if(K&&!ve)$.fillText(me,xe,we);else if(this.paintChar(me,xe,we,B),ve){const Pe=xe+q*ve.offset.x/H,Te=we-q*ve.offset.y/H;this.paintChar(ve.fontChar,Pe,Te,B)}}let Re;W?Re=Ee*j-_e*E:Re=Ee*j+_e*E,ae+=Re,be&&$.restore()}W?d.y-=ae:d.x+=ae*A,$.restore(),this.compose()}showType3Text(f){const d=this.ctx,I=this.current,q=I.font,$=I.fontSize,H=I.fontDirection,i=q.vertical?1:-1,g=I.charSpacing,E=I.wordSpacing,A=I.textHScale*H,k=I.fontMatrix||c.FONT_IDENTITY_MATRIX,W=f.length,M=I.textRenderingMode===c.TextRenderingMode.INVISIBLE;let y,j,K,B;if(!(M||$===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,d.save(),d.transform(...I.textMatrix),d.translate(I.x,I.y),d.scale(A,H),y=0;y<W;++y){if(j=f[y],typeof j=="number"){B=i*j*$/1e3,this.ctx.translate(B,0),I.x+=B*A;continue}const Y=(j.isSpace?E:0)+g,Z=q.charProcOperatorList[j.operatorListId];if(!Z){(0,c.warn)(`Type3 character "${j.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=j,this.save(),d.scale($,$),d.transform(...k),this.executeOperatorList(Z),this.restore()),K=c.Util.applyTransform([j.width,0],k)[0]*$+Y,d.translate(K,0),I.x+=K*A}d.restore(),this.processingType3=null}}setCharWidth(f,d){}setCharWidthAndBounds(f,d,I,q,$,H){this.ctx.rect(I,q,$-I,H-q),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let d;if(f[0]==="TilingPattern"){const I=f[1],q=this.baseTransform||(0,e.getCurrentTransform)(this.ctx),$={createCanvasGraphics:H=>new ge(H,this.commonObjs,this.objs,this.canvasFactory)};d=new O.TilingPattern(f,I,this.ctx,$,q)}else d=this._getPattern(f[1],f[2]);return d}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,d,I){var $;const q=(($=this.selectColor)==null?void 0:$.call(this,f,d,I))||c.Util.makeHexColor(f,d,I);this.ctx.strokeStyle=q,this.current.strokeColor=q}setFillRGBColor(f,d,I){var $;const q=(($=this.selectColor)==null?void 0:$.call(this,f,d,I))||c.Util.makeHexColor(f,d,I);this.ctx.fillStyle=q,this.current.fillColor=q,this.current.patternFill=!1}_getPattern(f,d=null){let I;return this.cachedPatterns.has(f)?I=this.cachedPatterns.get(f):(I=(0,O.getShadingPattern)(this.objs.get(f)),this.cachedPatterns.set(f,I)),d&&(I.matrix=d),I}shadingFill(f){if(!this.contentVisible)return;const d=this.ctx;this.save();const I=this._getPattern(f);d.fillStyle=I.getPattern(d,this,(0,e.getCurrentTransformInverse)(d),O.PathType.SHADING);const q=(0,e.getCurrentTransformInverse)(d);if(q){const $=d.canvas,H=$.width,i=$.height,g=c.Util.applyTransform([0,0],q),E=c.Util.applyTransform([0,i],q),A=c.Util.applyTransform([H,0],q),k=c.Util.applyTransform([H,i],q),W=Math.min(g[0],E[0],A[0],k[0]),M=Math.min(g[1],E[1],A[1],k[1]),y=Math.max(g[0],E[0],A[0],k[0]),j=Math.max(g[1],E[1],A[1],k[1]);this.ctx.fillRect(W,M,y-W,j-M)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,d){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,e.getCurrentTransform)(this.ctx),d)){const I=d[2]-d[0],q=d[3]-d[1];this.ctx.rect(d[0],d[1],I,q),this.current.updateRectMinMax((0,e.getCurrentTransform)(this.ctx),d),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const d=this.ctx;f.isolated||(0,c.info)("TODO: Support non-isolated groups."),f.knockout&&(0,c.warn)("Knockout groups not supported.");const I=(0,e.getCurrentTransform)(d);if(f.matrix&&d.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let q=c.Util.getAxialAlignedBoundingBox(f.bbox,(0,e.getCurrentTransform)(d));const $=[0,0,d.canvas.width,d.canvas.height];q=c.Util.intersect(q,$)||[0,0,0,0];const H=Math.floor(q[0]),i=Math.floor(q[1]);let g=Math.max(Math.ceil(q[2])-H,1),E=Math.max(Math.ceil(q[3])-i,1),A=1,k=1;g>R&&(A=g/R,g=R),E>R&&(k=E/R,E=R),this.current.startNewPathAndClipBox([0,0,g,E]);let W="groupAt"+this.groupLevel;f.smask&&(W+="_smask_"+this.smaskCounter++%2);const M=this.cachedCanvases.getCanvas(W,g,E),y=M.context;y.scale(1/A,1/k),y.translate(-H,-i),y.transform(...I),f.smask?this.smaskStack.push({canvas:M.canvas,context:y,offsetX:H,offsetY:i,scaleX:A,scaleY:k,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(d.setTransform(1,0,0,1,0,0),d.translate(H,i),d.scale(A,k),d.save()),o(d,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(d),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;const d=this.ctx,I=this.groupStack.pop();if(this.ctx=I,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const q=(0,e.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...q);const $=c.Util.getAxialAlignedBoundingBox([0,0,d.canvas.width,d.canvas.height],q);this.ctx.drawImage(d.canvas,0,0),this.ctx.restore(),this.compose($)}}beginAnnotation(f,d,I,q,$){if(he(this,ie,ht).call(this),n(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(d)&&d.length===4){const H=d[2]-d[0],i=d[3]-d[1];if($&&this.annotationCanvasMap){I=I.slice(),I[4]-=d[0],I[5]-=d[1],d=d.slice(),d[0]=d[1]=0,d[2]=H,d[3]=i;const[g,E]=c.Util.singularValueDecompose2dScale((0,e.getCurrentTransform)(this.ctx)),{viewportScale:A}=this,k=Math.ceil(H*this.outputScaleX*A),W=Math.ceil(i*this.outputScaleY*A);this.annotationCanvas=this.canvasFactory.create(k,W);const{canvas:M,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(f,M),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.setTransform(g,0,0,-E,0,i*E),n(this.ctx,this.foregroundColor)}else n(this.ctx,this.foregroundColor),this.ctx.rect(d[0],d[1],H,i),this.ctx.clip(),this.endPath()}this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...I),this.transform(...q)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;const d=f.count;f=this.getObject(f.data,f),f.count=d;const I=this.ctx,q=this.processingType3;if(q&&(q.compiled===void 0&&(q.compiled=T(f)),q.compiled)){q.compiled(I);return}const $=this._createMaskCanvas(f),H=$.canvas;I.save(),I.setTransform(1,0,0,1,0,0),I.drawImage(H,$.offsetX,$.offsetY),I.restore(),this.compose()}paintImageMaskXObjectRepeat(f,d,I=0,q=0,$,H){if(!this.contentVisible)return;f=this.getObject(f.data,f);const i=this.ctx;i.save();const g=(0,e.getCurrentTransform)(i);i.transform(d,I,q,$,0,0);const E=this._createMaskCanvas(f);i.setTransform(1,0,0,1,0,0);for(let A=0,k=H.length;A<k;A+=2){const W=c.Util.transform(g,[d,I,q,$,H[A],H[A+1]]),[M,y]=c.Util.applyTransform([0,0],W);i.drawImage(E.canvas,M,y)}i.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;const d=this.ctx,I=this.current.fillColor,q=this.current.patternFill;for(const $ of f){const{data:H,width:i,height:g,transform:E}=$,A=this.cachedCanvases.getCanvas("maskCanvas",i,g),k=A.context;k.save();const W=this.getObject(H,$);a(k,W),k.globalCompositeOperation="source-in",k.fillStyle=q?I.getPattern(k,this,(0,e.getCurrentTransformInverse)(d),O.PathType.FILL):I,k.fillRect(0,0,i,g),k.restore(),d.save(),d.transform(...E),d.scale(1,-1),u(d,A.canvas,0,0,i,g,0,-1,1,1),d.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;const d=this.getObject(f);if(!d){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(d)}paintImageXObjectRepeat(f,d,I,q){if(!this.contentVisible)return;const $=this.getObject(f);if(!$){(0,c.warn)("Dependent image isn't ready yet");return}const H=$.width,i=$.height,g=[];for(let E=0,A=q.length;E<A;E+=2)g.push({transform:[d,0,0,I,q[E],q[E+1]],x:0,y:0,w:H,h:i});this.paintInlineImageXObjectGroup($,g)}paintInlineImageXObject(f){if(!this.contentVisible)return;const d=f.width,I=f.height,q=this.ctx;this.save(),q.scale(1/d,-1/I);let $;if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)$=f;else{const E=this.cachedCanvases.getCanvas("inlineImage",d,I),A=E.context;p(A,f,this.current.transferMaps),$=E.canvas}const H=this._scaleImage($,(0,e.getCurrentTransformInverse)(q));q.imageSmoothingEnabled=le((0,e.getCurrentTransform)(q),f.interpolate);const[i,g]=u(q,H.img,0,0,H.paintWidth,H.paintHeight,0,-I,d,I);if(this.imageLayer){const[E,A]=c.Util.applyTransform([0,-I],(0,e.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:f,left:E,top:A,width:i,height:g})}this.compose(),this.restore()}paintInlineImageXObjectGroup(f,d){if(!this.contentVisible)return;const I=this.ctx,q=f.width,$=f.height,H=this.cachedCanvases.getCanvas("inlineImage",q,$),i=H.context;p(i,f,this.current.transferMaps);for(const g of d){if(I.save(),I.transform(...g.transform),I.scale(1,-1),u(I,H.canvas,g.x,g.y,g.w,g.h,0,-1,1,1),this.imageLayer){const[E,A]=c.Util.applyTransform([g.x,g.y],(0,e.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:f,left:E,top:A,width:q,height:$})}I.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,d){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,d){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(d)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){const d=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);const I=this.ctx;this.pendingClip&&(d||(this.pendingClip===J?I.clip("evenodd"):I.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),I.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const f=(0,e.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{const d=Math.abs(f[0]*f[3]-f[2]*f[1]),I=Math.hypot(f[0],f[2]),q=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(I,q)/d}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:f}=this.current,d=(0,e.getCurrentTransform)(this.ctx);let I,q;if(d[1]===0&&d[2]===0){const $=Math.abs(d[0]),H=Math.abs(d[3]);if(f===0)I=1/$,q=1/H;else{const i=$*f,g=H*f;I=i<1?1/i:1,q=g<1?1/g:1}}else{const $=Math.abs(d[0]*d[3]-d[2]*d[1]),H=Math.hypot(d[0],d[1]),i=Math.hypot(d[2],d[3]);if(f===0)I=i/$,q=H/$;else{const g=f*$;I=i>g?i/g:1,q=H>g?H/g:1}}this._cachedScaleForStroking=[I,q]}return this._cachedScaleForStroking}rescaleAndStroke(f){const{ctx:d}=this,{lineWidth:I}=this.current,[q,$]=this.getScaleForStroking();if(d.lineWidth=I||1,q===1&&$===1){d.stroke();return}let H,i,g;f&&(H=(0,e.getCurrentTransform)(d),i=d.getLineDash().slice(),g=d.lineDashOffset),d.scale(q,$);const E=Math.max(q,$);d.setLineDash(d.getLineDash().map(A=>A/E)),d.lineDashOffset/=E,d.stroke(),f&&(d.setTransform(...H),d.setLineDash(i),d.lineDashOffset=g)}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}};ie=new WeakSet,ht=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let Q=ge;s.CanvasGraphics=Q;for(const V in c.OPS)Q.prototype[V]!==void 0&&(Q.prototype[c.OPS[V]]=Q.prototype[V])},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TilingPattern=s.PathType=void 0,s.getShadingPattern=h;var e=b(1),c=b(8),O=b(3);const L={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};s.PathType=L;function F(u,T){if(!T||O.isNodeJS)return;const _=T[2]-T[0],p=T[3]-T[1],a=new Path2D;a.rect(T[0],T[1],_,p),u.clip(a)}class S{constructor(){this.constructor===S&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class m extends S{constructor(T){super(),this._type=T[1],this._bbox=T[2],this._colorStops=T[3],this._p0=T[4],this._p1=T[5],this._r0=T[6],this._r1=T[7],this.matrix=null}_createGradient(T){let _;this._type==="axial"?_=T.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(_=T.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const p of this._colorStops)_.addColorStop(p[0],p[1]);return _}getPattern(T,_,p,a){let o;if(a===L.STROKE||a===L.FILL){const n=_.current.getClippedPathBoundingBox(a,(0,c.getCurrentTransform)(T))||[0,0,0,0],x=Math.ceil(n[2]-n[0])||1,C=Math.ceil(n[3]-n[1])||1,z=_.cachedCanvases.getCanvas("pattern",x,C,!0),G=z.context;G.clearRect(0,0,G.canvas.width,G.canvas.height),G.beginPath(),G.rect(0,0,G.canvas.width,G.canvas.height),G.translate(-n[0],-n[1]),p=e.Util.transform(p,[1,0,0,1,n[0],n[1]]),G.transform(..._.baseTransform),this.matrix&&G.transform(...this.matrix),F(G,this._bbox),G.fillStyle=this._createGradient(G),G.fill(),o=T.createPattern(z.canvas,"no-repeat");const oe=new DOMMatrix(p);try{o.setTransform(oe)}catch(le){(0,e.warn)(`RadialAxialShadingPattern.getPattern: "${le==null?void 0:le.message}".`)}}else F(T,this._bbox),o=this._createGradient(T);return o}}function R(u,T,_,p,a,o,n,x){const C=T.coords,z=T.colors,G=u.data,oe=u.width*4;let le;C[_+1]>C[p+1]&&(le=_,_=p,p=le,le=o,o=n,n=le),C[p+1]>C[a+1]&&(le=p,p=a,a=le,le=n,n=x,x=le),C[_+1]>C[p+1]&&(le=_,_=p,p=le,le=o,o=n,n=le);const se=(C[_]+T.offsetX)*T.scaleX,ne=(C[_+1]+T.offsetY)*T.scaleY,X=(C[p]+T.offsetX)*T.scaleX,J=(C[p+1]+T.offsetY)*T.scaleY,Q=(C[a]+T.offsetX)*T.scaleX,ie=(C[a+1]+T.offsetY)*T.scaleY;if(ne>=ie)return;const de=z[o],ge=z[o+1],V=z[o+2],f=z[n],d=z[n+1],I=z[n+2],q=z[x],$=z[x+1],H=z[x+2],i=Math.round(ne),g=Math.round(ie);let E,A,k,W,M,y,j,K;for(let B=i;B<=g;B++){if(B<J){let re;B<ne?re=0:re=(ne-B)/(ne-J),E=se-(se-X)*re,A=de-(de-f)*re,k=ge-(ge-d)*re,W=V-(V-I)*re}else{let re;B>ie?re=1:J===ie?re=0:re=(J-B)/(J-ie),E=X-(X-Q)*re,A=f-(f-q)*re,k=d-(d-$)*re,W=I-(I-H)*re}let Y;B<ne?Y=0:B>ie?Y=1:Y=(ne-B)/(ne-ie),M=se-(se-Q)*Y,y=de-(de-q)*Y,j=ge-(ge-$)*Y,K=V-(V-H)*Y;const Z=Math.round(Math.min(E,M)),ae=Math.round(Math.max(E,M));let ue=oe*B+Z*4;for(let re=Z;re<=ae;re++)Y=(E-re)/(E-M),Y<0?Y=0:Y>1&&(Y=1),G[ue++]=A-(A-y)*Y|0,G[ue++]=k-(k-j)*Y|0,G[ue++]=W-(W-K)*Y|0,G[ue++]=255}}function N(u,T,_){const p=T.coords,a=T.colors;let o,n;switch(T.type){case"lattice":const x=T.verticesPerRow,C=Math.floor(p.length/x)-1,z=x-1;for(o=0;o<C;o++){let G=o*x;for(let oe=0;oe<z;oe++,G++)R(u,_,p[G],p[G+1],p[G+x],a[G],a[G+1],a[G+x]),R(u,_,p[G+x+1],p[G+1],p[G+x],a[G+x+1],a[G+1],a[G+x])}break;case"triangles":for(o=0,n=p.length;o<n;o+=3)R(u,_,p[o],p[o+1],p[o+2],a[o],a[o+1],a[o+2]);break;default:throw new Error("illegal figure")}}class w extends S{constructor(T){super(),this._coords=T[2],this._colors=T[3],this._figures=T[4],this._bounds=T[5],this._bbox=T[7],this._background=T[8],this.matrix=null}_createMeshCanvas(T,_,p){const x=Math.floor(this._bounds[0]),C=Math.floor(this._bounds[1]),z=Math.ceil(this._bounds[2])-x,G=Math.ceil(this._bounds[3])-C,oe=Math.min(Math.ceil(Math.abs(z*T[0]*1.1)),3e3),le=Math.min(Math.ceil(Math.abs(G*T[1]*1.1)),3e3),se=z/oe,ne=G/le,X={coords:this._coords,colors:this._colors,offsetX:-x,offsetY:-C,scaleX:1/se,scaleY:1/ne},J=oe+2*2,Q=le+2*2,ie=p.getCanvas("mesh",J,Q,!1),de=ie.context,ge=de.createImageData(oe,le);if(_){const f=ge.data;for(let d=0,I=f.length;d<I;d+=4)f[d]=_[0],f[d+1]=_[1],f[d+2]=_[2],f[d+3]=255}for(const f of this._figures)N(ge,f,X);return de.putImageData(ge,2,2),{canvas:ie.canvas,offsetX:x-2*se,offsetY:C-2*ne,scaleX:se,scaleY:ne}}getPattern(T,_,p,a){F(T,this._bbox);let o;if(a===L.SHADING)o=e.Util.singularValueDecompose2dScale((0,c.getCurrentTransform)(T));else if(o=e.Util.singularValueDecompose2dScale(_.baseTransform),this.matrix){const x=e.Util.singularValueDecompose2dScale(this.matrix);o=[o[0]*x[0],o[1]*x[1]]}const n=this._createMeshCanvas(o,a===L.SHADING?null:this._background,_.cachedCanvases);return a!==L.SHADING&&(T.setTransform(..._.baseTransform),this.matrix&&T.transform(...this.matrix)),T.translate(n.offsetX,n.offsetY),T.scale(n.scaleX,n.scaleY),T.createPattern(n.canvas,"no-repeat")}}class P extends S{getPattern(){return"hotpink"}}function h(u){switch(u[0]){case"RadialAxial":return new m(u);case"Mesh":return new w(u);case"Dummy":return new P}throw new Error(`Unknown IR type: ${u[0]}`)}const t={COLORED:1,UNCOLORED:2};class l{static get MAX_PATTERN_SIZE(){return(0,e.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(T,_,p,a,o){this.operatorList=T[2],this.matrix=T[3]||[1,0,0,1,0,0],this.bbox=T[4],this.xstep=T[5],this.ystep=T[6],this.paintType=T[7],this.tilingType=T[8],this.color=_,this.ctx=p,this.canvasGraphicsFactory=a,this.baseTransform=o}createPatternCanvas(T){const _=this.operatorList,p=this.bbox,a=this.xstep,o=this.ystep,n=this.paintType,x=this.tilingType,C=this.color,z=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+x);const G=p[0],oe=p[1],le=p[2],se=p[3],ne=e.Util.singularValueDecompose2dScale(this.matrix),X=e.Util.singularValueDecompose2dScale(this.baseTransform),J=[ne[0]*X[0],ne[1]*X[1]],Q=this.getSizeAndScale(a,this.ctx.canvas.width,J[0]),ie=this.getSizeAndScale(o,this.ctx.canvas.height,J[1]),de=T.cachedCanvases.getCanvas("pattern",Q.size,ie.size,!0),ge=de.context,V=z.createCanvasGraphics(ge);V.groupLevel=T.groupLevel,this.setFillAndStrokeStyleToContext(V,n,C);let f=G,d=oe,I=le,q=se;return G<0&&(f=0,I+=Math.abs(G)),oe<0&&(d=0,q+=Math.abs(oe)),ge.translate(-(Q.scale*f),-(ie.scale*d)),V.transform(Q.scale,0,0,ie.scale,0,0),ge.save(),this.clipBbox(V,f,d,I,q),V.baseTransform=(0,c.getCurrentTransform)(V.ctx),V.executeOperatorList(_),V.endDrawing(),{canvas:de.canvas,scaleX:Q.scale,scaleY:ie.scale,offsetX:f,offsetY:d}}getSizeAndScale(T,_,p){T=Math.abs(T);const a=Math.max(l.MAX_PATTERN_SIZE,_);let o=Math.ceil(T*p);return o>=a?o=a:p=o/T,{scale:p,size:o}}clipBbox(T,_,p,a,o){const n=a-_,x=o-p;T.ctx.rect(_,p,n,x),T.current.updateRectMinMax((0,c.getCurrentTransform)(T.ctx),[_,p,a,o]),T.clip(),T.endPath()}setFillAndStrokeStyleToContext(T,_,p){const a=T.ctx,o=T.current;switch(_){case t.COLORED:const n=this.ctx;a.fillStyle=n.fillStyle,a.strokeStyle=n.strokeStyle,o.fillColor=n.fillStyle,o.strokeColor=n.strokeStyle;break;case t.UNCOLORED:const x=e.Util.makeHexColor(p[0],p[1],p[2]);a.fillStyle=x,a.strokeStyle=x,o.fillColor=x,o.strokeColor=x;break;default:throw new e.FormatError(`Unsupported paint type: ${_}`)}}getPattern(T,_,p,a){let o=p;a!==L.SHADING&&(o=e.Util.transform(o,_.baseTransform),this.matrix&&(o=e.Util.transform(o,this.matrix)));const n=this.createPatternCanvas(_);let x=new DOMMatrix(o);x=x.translate(n.offsetX,n.offsetY),x=x.scale(1/n.scaleX,1/n.scaleY);const C=T.createPattern(n.canvas,"repeat");try{C.setTransform(x)}catch(z){(0,e.warn)(`TilingPattern.getPattern: "${z==null?void 0:z.message}".`)}return C}}s.TilingPattern=l},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.applyMaskImageData=c;var e=b(1);function c({src:O,srcPos:L=0,dest:F,destPos:S=0,width:m,height:R,inverseDecode:N=!1}){const w=e.FeatureTest.isLittleEndian?4278190080:255,[P,h]=N?[0,w]:[w,0],t=m>>3,l=m&7,u=O.length;F=new Uint32Array(F.buffer);for(let T=0;T<R;T++){for(const p=L+t;L<p;L++){const a=L<u?O[L]:255;F[S++]=a&128?h:P,F[S++]=a&64?h:P,F[S++]=a&32?h:P,F[S++]=a&16?h:P,F[S++]=a&8?h:P,F[S++]=a&4?h:P,F[S++]=a&2?h:P,F[S++]=a&1?h:P}if(l===0)continue;const _=L<u?O[L++]:255;for(let p=0;p<l;p++)F[S++]=_&1<<7-p?h:P}return{srcPos:L,destPos:S}}},(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.GlobalWorkerOptions=void 0;const b=Object.create(null);s.GlobalWorkerOptions=b,b.workerPort=b.workerPort===void 0?null:b.workerPort,b.workerSrc=b.workerSrc===void 0?"":b.workerSrc},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.MessageHandler=void 0;var e=b(1);const c={DATA:1,ERROR:2},O={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function L(S){switch(S instanceof Error||typeof S=="object"&&S!==null||(0,e.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),S.name){case"AbortException":return new e.AbortException(S.message);case"MissingPDFException":return new e.MissingPDFException(S.message);case"PasswordException":return new e.PasswordException(S.message,S.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(S.message,S.status);case"UnknownErrorException":return new e.UnknownErrorException(S.message,S.details);default:return new e.UnknownErrorException(S.message,S.toString())}}class F{constructor(m,R,N){this.sourceName=m,this.targetName=R,this.comObj=N,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=w=>{const P=w.data;if(P.targetName!==this.sourceName)return;if(P.stream){this._processStreamMessage(P);return}if(P.callback){const t=P.callbackId,l=this.callbackCapabilities[t];if(!l)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],P.callback===c.DATA)l.resolve(P.data);else if(P.callback===c.ERROR)l.reject(L(P.reason));else throw new Error("Unexpected callback case");return}const h=this.actionHandler[P.action];if(!h)throw new Error(`Unknown action from worker: ${P.action}`);if(P.callbackId){const t=this.sourceName,l=P.sourceName;new Promise(function(u){u(h(P.data))}).then(function(u){N.postMessage({sourceName:t,targetName:l,callback:c.DATA,callbackId:P.callbackId,data:u})},function(u){N.postMessage({sourceName:t,targetName:l,callback:c.ERROR,callbackId:P.callbackId,reason:L(u)})});return}if(P.streamId){this._createStreamSink(P);return}h(P.data)},N.addEventListener("message",this._onComObjOnMessage)}on(m,R){const N=this.actionHandler;if(N[m])throw new Error(`There is already an actionName called "${m}"`);N[m]=R}send(m,R,N){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,data:R},N)}sendWithPromise(m,R,N){const w=this.callbackId++,P=(0,e.createPromiseCapability)();this.callbackCapabilities[w]=P;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:m,callbackId:w,data:R},N)}catch(h){P.reject(h)}return P.promise}sendWithStream(m,R,N,w){const P=this.streamId++,h=this.sourceName,t=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const T=(0,e.createPromiseCapability)();return this.streamControllers[P]={controller:u,startCall:T,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:h,targetName:t,action:m,streamId:P,data:R,desiredSize:u.desiredSize},w),T.promise},pull:u=>{const T=(0,e.createPromiseCapability)();return this.streamControllers[P].pullCall=T,l.postMessage({sourceName:h,targetName:t,stream:O.PULL,streamId:P,desiredSize:u.desiredSize}),T.promise},cancel:u=>{(0,e.assert)(u instanceof Error,"cancel must have a valid reason");const T=(0,e.createPromiseCapability)();return this.streamControllers[P].cancelCall=T,this.streamControllers[P].isClosed=!0,l.postMessage({sourceName:h,targetName:t,stream:O.CANCEL,streamId:P,reason:L(u)}),T.promise}},N)}_createStreamSink(m){const R=m.streamId,N=this.sourceName,w=m.sourceName,P=this.comObj,h=this,t=this.actionHandler[m.action],l={enqueue(u,T=1,_){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=T,p>0&&this.desiredSize<=0&&(this.sinkCapability=(0,e.createPromiseCapability)(),this.ready=this.sinkCapability.promise),P.postMessage({sourceName:N,targetName:w,stream:O.ENQUEUE,streamId:R,chunk:u},_)},close(){this.isCancelled||(this.isCancelled=!0,P.postMessage({sourceName:N,targetName:w,stream:O.CLOSE,streamId:R}),delete h.streamSinks[R])},error(u){(0,e.assert)(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,P.postMessage({sourceName:N,targetName:w,stream:O.ERROR,streamId:R,reason:L(u)}))},sinkCapability:(0,e.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:m.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[R]=l,new Promise(function(u){u(t(m.data,l))}).then(function(){P.postMessage({sourceName:N,targetName:w,stream:O.START_COMPLETE,streamId:R,success:!0})},function(u){P.postMessage({sourceName:N,targetName:w,stream:O.START_COMPLETE,streamId:R,reason:L(u)})})}_processStreamMessage(m){const R=m.streamId,N=this.sourceName,w=m.sourceName,P=this.comObj,h=this.streamControllers[R],t=this.streamSinks[R];switch(m.stream){case O.START_COMPLETE:m.success?h.startCall.resolve():h.startCall.reject(L(m.reason));break;case O.PULL_COMPLETE:m.success?h.pullCall.resolve():h.pullCall.reject(L(m.reason));break;case O.PULL:if(!t){P.postMessage({sourceName:N,targetName:w,stream:O.PULL_COMPLETE,streamId:R,success:!0});break}t.desiredSize<=0&&m.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=m.desiredSize,new Promise(function(l){l(t.onPull&&t.onPull())}).then(function(){P.postMessage({sourceName:N,targetName:w,stream:O.PULL_COMPLETE,streamId:R,success:!0})},function(l){P.postMessage({sourceName:N,targetName:w,stream:O.PULL_COMPLETE,streamId:R,reason:L(l)})});break;case O.ENQUEUE:if((0,e.assert)(h,"enqueue should have stream controller"),h.isClosed)break;h.controller.enqueue(m.chunk);break;case O.CLOSE:if((0,e.assert)(h,"close should have stream controller"),h.isClosed)break;h.isClosed=!0,h.controller.close(),this._deleteStreamController(h,R);break;case O.ERROR:(0,e.assert)(h,"error should have stream controller"),h.controller.error(L(m.reason)),this._deleteStreamController(h,R);break;case O.CANCEL_COMPLETE:m.success?h.cancelCall.resolve():h.cancelCall.reject(L(m.reason)),this._deleteStreamController(h,R);break;case O.CANCEL:if(!t)break;new Promise(function(l){l(t.onCancel&&t.onCancel(L(m.reason)))}).then(function(){P.postMessage({sourceName:N,targetName:w,stream:O.CANCEL_COMPLETE,streamId:R,success:!0})},function(l){P.postMessage({sourceName:N,targetName:w,stream:O.CANCEL_COMPLETE,streamId:R,reason:L(l)})}),t.sinkCapability.reject(L(m.reason)),t.isCancelled=!0,delete this.streamSinks[R];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(m,R){await Promise.allSettled([m.startCall&&m.startCall.promise,m.pullCall&&m.pullCall.promise,m.cancelCall&&m.cancelCall.promise]),delete this.streamControllers[R]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}s.MessageHandler=F},(v,s,b)=>{var O,L;Object.defineProperty(s,"__esModule",{value:!0}),s.Metadata=void 0;var e=b(1);class c{constructor({parsedData:S,rawData:m}){pe(this,O);pe(this,L);fe(this,O,S),fe(this,L,m)}getRaw(){return D(this,L)}get(S){return D(this,O).get(S)??null}getAll(){return(0,e.objectFromMap)(D(this,O))}has(S){return D(this,O).has(S)}}O=new WeakMap,L=new WeakMap,s.Metadata=c},(v,s,b)=>{var F,S,m,R,N,w,pt;Object.defineProperty(s,"__esModule",{value:!0}),s.OptionalContentConfig=void 0;var e=b(1);const c=Symbol("INTERNAL");class O{constructor(t,l){pe(this,F,!0);this.name=t,this.intent=l}get visible(){return D(this,F)}_setVisible(t,l){t!==c&&(0,e.unreachable)("Internal method `_setVisible` called."),fe(this,F,l)}}F=new WeakMap;class L{constructor(t){pe(this,w);pe(this,S,!0);pe(this,m,new Map);pe(this,R,null);pe(this,N,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,fe(this,N,t.order);for(const l of t.groups)D(this,m).set(l.id,new O(l.name,l.intent));if(t.baseState==="OFF")for(const l of D(this,m).values())l._setVisible(c,!1);for(const l of t.on)D(this,m).get(l)._setVisible(c,!0);for(const l of t.off)D(this,m).get(l)._setVisible(c,!1);fe(this,R,new Map);for(const[l,u]of D(this,m))D(this,R).set(l,u.visible)}}isVisible(t){if(D(this,m).size===0)return!0;if(!t)return(0,e.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return D(this,m).has(t.id)?D(this,m).get(t.id).visible:((0,e.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return he(this,w,pt).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const l of t.ids){if(!D(this,m).has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(D(this,m).get(l).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const l of t.ids){if(!D(this,m).has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(!D(this,m).get(l).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const l of t.ids){if(!D(this,m).has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(!D(this,m).get(l).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const l of t.ids){if(!D(this,m).has(l))return(0,e.warn)(`Optional content group not found: ${l}`),!0;if(D(this,m).get(l).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,e.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,l=!0){if(!D(this,m).has(t)){(0,e.warn)(`Optional content group not found: ${t}`);return}D(this,m).get(t)._setVisible(c,!!l),fe(this,S,null)}get hasInitialVisibility(){if(D(this,S)!==null)return D(this,S);for(const[t,l]of D(this,m)){const u=D(this,R).get(t);if(l.visible!==u)return fe(this,S,!1)}return fe(this,S,!0)}getOrder(){return D(this,m).size?D(this,N)?D(this,N).slice():[...D(this,m).keys()]:null}getGroups(){return D(this,m).size>0?(0,e.objectFromMap)(D(this,m)):null}getGroup(t){return D(this,m).get(t)||null}}S=new WeakMap,m=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakSet,pt=function(t){const l=t.length;if(l<2)return!0;const u=t[0];for(let T=1;T<l;T++){const _=t[T];let p;if(Array.isArray(_))p=he(this,w,pt).call(this,_);else if(D(this,m).has(_))p=D(this,m).get(_).visible;else return(0,e.warn)(`Optional content group not found: ${_}`),!0;switch(u){case"And":if(!p)return!1;break;case"Or":if(p)return!0;break;case"Not":return!p;default:return!0}}return u==="And"},s.OptionalContentConfig=L},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFDataTransportStream=void 0;var e=b(1),c=b(8);class O{constructor(m,R){(0,e.assert)(R,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=m.progressiveDone||!1,this._contentDispositionFilename=m.contentDispositionFilename||null;const N=m.initialData;if((N==null?void 0:N.length)>0){const w=new Uint8Array(N).buffer;this._queuedChunks.push(w)}this._pdfDataRangeTransport=R,this._isStreamingSupported=!m.disableStream,this._isRangeSupported=!m.disableRange,this._contentLength=m.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((w,P)=>{this._onReceiveData({begin:w,chunk:P})}),this._pdfDataRangeTransport.addProgressListener((w,P)=>{this._onProgress({loaded:w,total:P})}),this._pdfDataRangeTransport.addProgressiveReadListener(w=>{this._onReceiveData({chunk:w})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(m){const R=new Uint8Array(m.chunk).buffer;if(m.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(R):this._queuedChunks.push(R);else{const N=this._rangeReaders.some(function(w){return w._begin!==m.begin?!1:(w._enqueue(R),!0)});(0,e.assert)(N,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var m;return((m=this._fullRequestReader)==null?void 0:m._loaded)??0}_onProgress(m){if(m.total===void 0){const R=this._rangeReaders[0];R!=null&&R.onProgress&&R.onProgress({loaded:m.loaded})}else{const R=this._fullRequestReader;R!=null&&R.onProgress&&R.onProgress({loaded:m.loaded,total:m.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(m){const R=this._rangeReaders.indexOf(m);R>=0&&this._rangeReaders.splice(R,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const m=this._queuedChunks;return this._queuedChunks=null,new L(this,m,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(m,R){if(R<=this._progressiveDataLength)return null;const N=new F(this,m,R);return this._pdfDataRangeTransport.requestDataRange(m,R),this._rangeReaders.push(N),N}cancelAllRequests(m){this._fullRequestReader&&this._fullRequestReader.cancel(m);for(const R of this._rangeReaders.slice(0))R.cancel(m);this._pdfDataRangeTransport.abort()}}s.PDFDataTransportStream=O;class L{constructor(m,R,N=!1,w=null){this._stream=m,this._done=N||!1,this._filename=(0,c.isPdfFile)(w)?w:null,this._queuedChunks=R||[],this._loaded=0;for(const P of this._queuedChunks)this._loaded+=P.byteLength;this._requests=[],this._headersReady=Promise.resolve(),m._fullRequestReader=this,this.onProgress=null}_enqueue(m){this._done||(this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunks.push(m),this._loaded+=m.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const m=(0,e.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class F{constructor(m,R,N){this._stream=m,this._begin=R,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(m){if(!this._done){if(this._requests.length===0)this._queuedChunk=m;else{this._requests.shift().resolve({value:m,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const R=this._queuedChunk;return this._queuedChunk=null,{value:R,done:!1}}if(this._done)return{value:void 0,done:!0};const m=(0,e.createPromiseCapability)();return this._requests.push(m),m.promise}cancel(m){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.XfaText=void 0;class b{static textContent(c){const O=[],L={items:O,styles:Object.create(null)};function F(S){var N;if(!S)return;let m=null;const R=S.name;if(R==="#text")m=S.value;else if(b.shouldBuildText(R))(N=S==null?void 0:S.attributes)!=null&&N.textContent?m=S.attributes.textContent:S.value&&(m=S.value);else return;if(m!==null&&O.push({str:m}),!!S.children)for(const w of S.children)F(w)}return F(c),L}static shouldBuildText(c){return!(c==="textarea"||c==="input"||c==="option"||c==="select")}}s.XfaText=b},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.NodeStandardFontDataFactory=s.NodeCanvasFactory=s.NodeCMapReaderFactory=void 0;var e=b(9);const c=function(S){return new Promise((m,R)=>{require$$5.readFile(S,(w,P)=>{if(w||!P){R(new Error(w));return}m(new Uint8Array(P))})})};class O extends e.BaseCanvasFactory{_createCanvas(m,R){return require$$5.createCanvas(m,R)}}s.NodeCanvasFactory=O;class L extends e.BaseCMapReaderFactory{_fetchData(m,R){return c(m).then(N=>({cMapData:N,compressionType:R}))}}s.NodeCMapReaderFactory=L;class F extends e.BaseStandardFontDataFactory{_fetchData(m){return c(m)}}s.NodeStandardFontDataFactory=F},(v,s,b)=>{var S,m,R,N,w,P,h,t,l,ft,Mt,gt,Ot;Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationEditorLayer=void 0;var e=b(7),c=b(1),O=b(23),L=b(24);const a=class a{constructor(n){pe(this,l);pe(this,S);pe(this,m,!1);pe(this,R,this.pointerup.bind(this));pe(this,N,this.pointerdown.bind(this));pe(this,w,new Map);pe(this,P,!1);pe(this,h,!1);pe(this,t);a._initialized||(a._initialized=!0,O.FreeTextEditor.initialize(n.l10n),L.InkEditor.initialize(n.l10n),n.uiManager.registerEditorTypes([O.FreeTextEditor,L.InkEditor])),fe(this,t,n.uiManager),this.annotationStorage=n.annotationStorage,this.pageIndex=n.pageIndex,this.div=n.div,fe(this,S,n.accessibilityManager),D(this,t).addLayer(this)}updateToolbar(n){D(this,t).updateToolbar(n)}updateMode(n=D(this,t).getMode()){he(this,l,Ot).call(this),n===c.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),D(this,t).unselectAll()}addInkEditorIfNeeded(n){if(!n&&D(this,t).getMode()!==c.AnnotationEditorType.INK)return;if(!n){for(const C of D(this,w).values())if(C.isEmpty()){C.setInBackground();return}}he(this,l,gt).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(n){D(this,t).setEditingState(n)}addCommands(n){D(this,t).addCommands(n)}enable(){this.div.style.pointerEvents="auto";for(const n of D(this,w).values())n.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const n of D(this,w).values())n.disableEditing()}setActiveEditor(n){D(this,t).getActive()!==n&&D(this,t).setActiveEditor(n)}enableClick(){this.div.addEventListener("pointerdown",D(this,N)),this.div.addEventListener("pointerup",D(this,R))}disableClick(){this.div.removeEventListener("pointerdown",D(this,N)),this.div.removeEventListener("pointerup",D(this,R))}attach(n){D(this,w).set(n.id,n)}detach(n){var x;D(this,w).delete(n.id),(x=D(this,S))==null||x.removePointerInTextLayer(n.contentDiv)}remove(n){D(this,t).removeEditor(n),this.detach(n),this.annotationStorage.remove(n.id),n.div.style.display="none",setTimeout(()=>{n.div.style.display="",n.div.remove(),n.isAttachedToDOM=!1,document.activeElement===document.body&&D(this,t).focusMainContainer()},0),D(this,h)||this.addInkEditorIfNeeded(!1)}add(n){if(he(this,l,ft).call(this,n),D(this,t).addEditor(n),this.attach(n),!n.isAttachedToDOM){const x=n.render();this.div.append(x),n.isAttachedToDOM=!0}this.moveEditorInDOM(n),n.onceAdded(),this.addToAnnotationStorage(n)}moveEditorInDOM(n){var x;(x=D(this,S))==null||x.moveElementInDOM(this.div,n.div,n.contentDiv,!0)}addToAnnotationStorage(n){!n.isEmpty()&&!this.annotationStorage.has(n.id)&&this.annotationStorage.setValue(n.id,n)}addOrRebuild(n){n.needsToBeRebuilt()?n.rebuild():this.add(n)}addANewEditor(n){const x=()=>{this.addOrRebuild(n)},C=()=>{n.remove()};this.addCommands({cmd:x,undo:C,mustExec:!0})}addUndoableEditor(n){const x=()=>{this.addOrRebuild(n)},C=()=>{n.remove()};this.addCommands({cmd:x,undo:C,mustExec:!1})}getNextId(){return D(this,t).getId()}deserialize(n){switch(n.annotationType){case c.AnnotationEditorType.FREETEXT:return O.FreeTextEditor.deserialize(n,this);case c.AnnotationEditorType.INK:return L.InkEditor.deserialize(n,this)}return null}setSelected(n){D(this,t).setSelected(n)}toggleSelected(n){D(this,t).toggleSelected(n)}isSelected(n){return D(this,t).isSelected(n)}unselect(n){D(this,t).unselect(n)}pointerup(n){const x=e.KeyboardManager.platform.isMac;if(!(n.button!==0||n.ctrlKey&&x)&&n.target===this.div&&D(this,P)){if(fe(this,P,!1),!D(this,m)){fe(this,m,!0);return}he(this,l,gt).call(this,n)}}pointerdown(n){const x=e.KeyboardManager.platform.isMac;if(n.button!==0||n.ctrlKey&&x||n.target!==this.div)return;fe(this,P,!0);const C=D(this,t).getActive();fe(this,m,!C||C.isEmpty())}drop(n){const x=n.dataTransfer.getData("text/plain"),C=D(this,t).getEditor(x);if(!C)return;n.preventDefault(),n.dataTransfer.dropEffect="move",he(this,l,ft).call(this,C);const z=this.div.getBoundingClientRect(),G=n.clientX-z.x,oe=n.clientY-z.y;C.translate(G-C.startX,oe-C.startY),this.moveEditorInDOM(C),C.div.focus()}dragover(n){n.preventDefault()}destroy(){var n,x;((n=D(this,t).getActive())==null?void 0:n.parent)===this&&D(this,t).setActiveEditor(null);for(const C of D(this,w).values())(x=D(this,S))==null||x.removePointerInTextLayer(C.contentDiv),C.isAttachedToDOM=!1,C.div.remove(),C.parent=null;this.div=null,D(this,w).clear(),D(this,t).removeLayer(this)}render(n){this.viewport=n.viewport,(0,e.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const x of D(this,t).getEditors(this.pageIndex))this.add(x);this.updateMode()}update(n){this.viewport=n.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[n,x,C,z]=this.viewport.viewBox,G=C-n,oe=z-x;return[G,oe]}get viewportBaseDimensions(){const{width:n,height:x,rotation:C}=this.viewport;return C%180===0?[n,x]:[x,n]}setDimensions(){const{width:n,height:x,rotation:C}=this.viewport,z=C%180!==0,G=Math.floor(n)+"px",oe=Math.floor(x)+"px";this.div.style.width=z?oe:G,this.div.style.height=z?G:oe,this.div.setAttribute("data-main-rotation",C)}};S=new WeakMap,m=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,h=new WeakMap,t=new WeakMap,l=new WeakSet,ft=function(n){var x;n.parent!==this&&(this.attach(n),n.pageIndex=this.pageIndex,(x=n.parent)==null||x.detach(n),n.parent=this,n.div&&n.isAttachedToDOM&&(n.div.remove(),this.div.append(n.div)))},Mt=function(n){switch(D(this,t).getMode()){case c.AnnotationEditorType.FREETEXT:return new O.FreeTextEditor(n);case c.AnnotationEditorType.INK:return new L.InkEditor(n)}return null},gt=function(n){const x=this.getNextId(),C=he(this,l,Mt).call(this,{parent:this,id:x,x:n.offsetX,y:n.offsetY});return C&&this.add(C),C},Ot=function(){fe(this,h,!0);for(const n of D(this,w).values())n.isEmpty()&&n.remove();fe(this,h,!1)},ke(a,"_initialized",!1);let F=a;s.AnnotationEditorLayer=F},(v,s,b)=>{var F,S,m,R,N,w,P,h,Dt,It,Lt,mt;Object.defineProperty(s,"__esModule",{value:!0}),s.FreeTextEditor=void 0;var e=b(1),c=b(7),O=b(6);const _=class _ extends O.AnnotationEditor{constructor(o){super({...o,name:"freeTextEditor"});pe(this,h);pe(this,F,this.editorDivBlur.bind(this));pe(this,S,this.editorDivFocus.bind(this));pe(this,m,this.editorDivKeydown.bind(this));pe(this,R);pe(this,N,"");pe(this,w,!1);pe(this,P);fe(this,R,o.color||_._defaultColor||O.AnnotationEditor._defaultLineColor),fe(this,P,o.fontSize||_._defaultFontSize)}static initialize(o){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(x=>[x,o.get(x)]));const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(o,n){switch(o){case e.AnnotationEditorParamsType.FREETEXT_SIZE:_._defaultFontSize=n;break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:_._defaultColor=n;break}}updateParams(o,n){switch(o){case e.AnnotationEditorParamsType.FREETEXT_SIZE:he(this,h,Dt).call(this,n);break;case e.AnnotationEditorParamsType.FREETEXT_COLOR:he(this,h,It).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,_._defaultFontSize],[e.AnnotationEditorParamsType.FREETEXT_COLOR,_._defaultColor||O.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.FREETEXT_SIZE,D(this,P)],[e.AnnotationEditorParamsType.FREETEXT_COLOR,D(this,R)]]}getInitialTranslation(){return[-_._internalPadding*this.parent.scaleFactor,-(_._internalPadding+D(this,P))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(e.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",D(this,m)),this.editorDiv.addEventListener("focus",D(this,S)),this.editorDiv.addEventListener("blur",D(this,F)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",D(this,m)),this.editorDiv.removeEventListener("focus",D(this,S)),this.editorDiv.removeEventListener("blur",D(this,F)),this.div.focus(),this.isEditing=!1)}focusin(o){super.focusin(o),o.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),D(this,w)||(fe(this,w,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),fe(this,N,he(this,h,Lt).call(this).trimEnd()),he(this,h,mt).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(o){this.enableEditMode(),this.editorDiv.focus()}keydown(o){o.target===this.div&&o.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(o){_._keyboardManager.exec(this,o)}editorDivFocus(o){this.isEditing=!0}editorDivBlur(o){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let o,n;this.width&&(o=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),_._l10nPromise.get("editor_free_text_aria_label").then(C=>{var z;return(z=this.editorDiv)==null?void 0:z.setAttribute("aria-label",C)}),_._l10nPromise.get("free_text_default_content").then(C=>{var z;return(z=this.editorDiv)==null?void 0:z.setAttribute("default-content",C)}),this.editorDiv.contentEditable=!0;const{style:x}=this.editorDiv;if(x.fontSize=`calc(${D(this,P)}px * var(--scale-factor))`,x.color=D(this,R),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,c.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[C,z]=this.parent.viewportBaseDimensions;this.setAt(o*C,n*z,this.width*C,this.height*z);for(const G of D(this,N).split(`
`)){const oe=document.createElement("div");oe.append(G?document.createTextNode(G):document.createElement("br")),this.editorDiv.append(oe)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(o,n){const x=super.deserialize(o,n);return fe(x,P,o.fontSize),fe(x,R,e.Util.makeHexColor(...o.color)),fe(x,N,o.value),x}serialize(){if(this.isEmpty())return null;const o=_._internalPadding*this.parent.scaleFactor,n=this.getRect(o,o),x=O.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:e.AnnotationEditorType.FREETEXT,color:x,fontSize:D(this,P),value:D(this,N),pageIndex:this.parent.pageIndex,rect:n,rotation:this.rotation}}};F=new WeakMap,S=new WeakMap,m=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,h=new WeakSet,Dt=function(o){const n=C=>{this.editorDiv.style.fontSize=`calc(${C}px * var(--scale-factor))`,this.translate(0,-(C-D(this,P))*this.parent.scaleFactor),fe(this,P,C),he(this,h,mt).call(this)},x=D(this,P);this.parent.addCommands({cmd:()=>{n(o)},undo:()=>{n(x)},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},It=function(o){const n=D(this,R);this.parent.addCommands({cmd:()=>{fe(this,R,o),this.editorDiv.style.color=o},undo:()=>{fe(this,R,n),this.editorDiv.style.color=n},mustExec:!0,type:e.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Lt=function(){const o=this.editorDiv.getElementsByTagName("div");if(o.length===0)return this.editorDiv.innerText;const n=[];for(let x=0,C=o.length;x<C;x++){const G=o[x].firstChild;(G==null?void 0:G.nodeName)==="#text"?n.push(G.data):n.push("")}return n.join(`
`)},mt=function(){const[o,n]=this.parent.viewportBaseDimensions,x=this.div.getBoundingClientRect();this.width=x.width/o,this.height=x.height/n},ke(_,"_freeTextDefaultContent",""),ke(_,"_l10nPromise"),ke(_,"_internalPadding",0),ke(_,"_defaultColor",null),ke(_,"_defaultFontSize",10),ke(_,"_keyboardManager",new c.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],_.prototype.commitOrRemove]])),ke(_,"_type","freetext");let L=_;s.FreeTextEditor=L},(v,s,b)=>{var m,R,N,w,P,h,t,l,u,T,_,p,a,o,n,Nt,jt,Ut,Bt,yt,Wt,qt,$t,Ie,bt,et,tt,He,_t,nt,f,vt,Ht,Gt,zt,At,rt,Ge,xt;Object.defineProperty(s,"__esModule",{value:!0}),s.InkEditor=void 0,Object.defineProperty(s,"fitCurve",{enumerable:!0,get:function(){return O.fitCurve}});var e=b(1),c=b(6),O=b(25),L=b(7);const F=16,A=class A extends c.AnnotationEditor{constructor(M){super({...M,name:"inkEditor"});pe(this,n);pe(this,m,0);pe(this,R,0);pe(this,N,0);pe(this,w,this.canvasPointermove.bind(this));pe(this,P,this.canvasPointerleave.bind(this));pe(this,h,this.canvasPointerup.bind(this));pe(this,t,this.canvasPointerdown.bind(this));pe(this,l,!1);pe(this,u,!1);pe(this,T,null);pe(this,_,null);pe(this,p,0);pe(this,a,0);pe(this,o,null);this.color=M.color||null,this.thickness=M.thickness||null,this.opacity=M.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(M){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(y=>[y,M.get(y)]))}static updateDefaultParams(M,y){switch(M){case e.AnnotationEditorParamsType.INK_THICKNESS:A._defaultThickness=y;break;case e.AnnotationEditorParamsType.INK_COLOR:A._defaultColor=y;break;case e.AnnotationEditorParamsType.INK_OPACITY:A._defaultOpacity=y/100;break}}updateParams(M,y){switch(M){case e.AnnotationEditorParamsType.INK_THICKNESS:he(this,n,Nt).call(this,y);break;case e.AnnotationEditorParamsType.INK_COLOR:he(this,n,jt).call(this,y);break;case e.AnnotationEditorParamsType.INK_OPACITY:he(this,n,Ut).call(this,y);break}}static get defaultPropertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,A._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,A._defaultColor||c.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(A._defaultOpacity*100)]]}get propertiesToUpdate(){return[[e.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||A._defaultThickness],[e.AnnotationEditorParamsType.INK_COLOR,this.color||A._defaultColor||c.AnnotationEditor._defaultLineColor],[e.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??A._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(he(this,n,et).call(this),he(this,n,tt).call(this)),this.isAttachedToDOM||(this.parent.add(this),he(this,n,He).call(this)),he(this,n,Ge).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,D(this,_).disconnect(),fe(this,_,null),super.remove())}enableEditMode(){D(this,l)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",D(this,t)),this.canvas.addEventListener("pointerup",D(this,h)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",D(this,t)),this.canvas.removeEventListener("pointerup",D(this,h)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){D(this,l)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),fe(this,l,!0),this.div.classList.add("disabled"),he(this,n,Ge).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(M){super.focusin(M),this.enableEditMode()}canvasPointerdown(M){M.button!==0||!this.isInEditMode()||D(this,l)||(this.setInForeground(),M.type!=="mouse"&&this.div.focus(),M.stopPropagation(),this.canvas.addEventListener("pointerleave",D(this,P)),this.canvas.addEventListener("pointermove",D(this,w)),he(this,n,Wt).call(this,M.offsetX,M.offsetY))}canvasPointermove(M){M.stopPropagation(),he(this,n,qt).call(this,M.offsetX,M.offsetY)}canvasPointerup(M){M.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(M.stopPropagation(),he(this,n,bt).call(this,M),this.setInBackground())}canvasPointerleave(M){he(this,n,bt).call(this,M),this.setInBackground()}render(){if(this.div)return this.div;let M,y;this.width&&(M=this.x,y=this.y),super.render(),A._l10nPromise.get("editor_ink_aria_label").then(Z=>{var ae;return(ae=this.div)==null?void 0:ae.setAttribute("aria-label",Z)});const[j,K,B,Y]=he(this,n,Bt).call(this);if(this.setAt(j,K,0,0),this.setDims(B,Y),he(this,n,et).call(this),this.width){const[Z,ae]=this.parent.viewportBaseDimensions;this.setAt(M*Z,y*ae,this.width*Z,this.height*ae),fe(this,u,!0),he(this,n,He).call(this),this.setDims(this.width*Z,this.height*ae),he(this,n,Ie).call(this),he(this,n,xt).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return he(this,n,tt).call(this),this.div}setDimensions(M,y){const j=Math.round(M),K=Math.round(y);if(D(this,p)===j&&D(this,a)===K)return;fe(this,p,j),fe(this,a,K),this.canvas.style.visibility="hidden",D(this,m)&&Math.abs(D(this,m)-M/y)>.01&&(y=Math.ceil(M/D(this,m)),this.setDims(M,y));const[B,Y]=this.parent.viewportBaseDimensions;this.width=M/B,this.height=y/Y,D(this,l)&&he(this,n,_t).call(this,M,y),he(this,n,He).call(this),he(this,n,Ie).call(this),this.canvas.style.visibility="visible"}static deserialize(M,y){var be,_e;const j=super.deserialize(M,y);j.thickness=M.thickness,j.color=e.Util.makeHexColor(...M.color),j.opacity=M.opacity;const[K,B]=y.pageDimensions,Y=j.width*K,Z=j.height*B,ae=y.scaleFactor,ue=M.thickness/2;fe(j,m,Y/Z),fe(j,l,!0),fe(j,p,Math.round(Y)),fe(j,a,Math.round(Z));for(const{bezier:me}of M.paths){const ve=[];j.paths.push(ve);let xe=ae*(me[0]-ue),we=ae*(Z-me[1]-ue);for(let Re=2,Pe=me.length;Re<Pe;Re+=6){const Te=ae*(me[Re]-ue),Le=ae*(Z-me[Re+1]-ue),Be=ae*(me[Re+2]-ue),We=ae*(Z-me[Re+3]-ue),ce=ae*(me[Re+4]-ue),ee=ae*(Z-me[Re+5]-ue);ve.push([[xe,we],[Te,Le],[Be,We],[ce,ee]]),xe=ce,we=ee}const Ee=he(this,f,vt).call(this,ve);j.bezierPath2D.push(Ee)}const re=he(be=j,n,At).call(be);return fe(j,N,Math.max(F,re[2]-re[0])),fe(j,R,Math.max(F,re[3]-re[1])),he(_e=j,n,_t).call(_e,Y,Z),j}serialize(){if(this.isEmpty())return null;const M=this.getRect(0,0),y=this.rotation%180===0?M[3]-M[1]:M[2]-M[0],j=c.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:e.AnnotationEditorType.INK,color:j,thickness:this.thickness,opacity:this.opacity,paths:he(this,n,Ht).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,y),pageIndex:this.parent.pageIndex,rect:M,rotation:this.rotation}}};m=new WeakMap,R=new WeakMap,N=new WeakMap,w=new WeakMap,P=new WeakMap,h=new WeakMap,t=new WeakMap,l=new WeakMap,u=new WeakMap,T=new WeakMap,_=new WeakMap,p=new WeakMap,a=new WeakMap,o=new WeakMap,n=new WeakSet,Nt=function(M){const y=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=M,he(this,n,Ge).call(this)},undo:()=>{this.thickness=y,he(this,n,Ge).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},jt=function(M){const y=this.color;this.parent.addCommands({cmd:()=>{this.color=M,he(this,n,Ie).call(this)},undo:()=>{this.color=y,he(this,n,Ie).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ut=function(M){M/=100;const y=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=M,he(this,n,Ie).call(this)},undo:()=>{this.opacity=y,he(this,n,Ie).call(this)},mustExec:!0,type:e.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Bt=function(){const{width:M,height:y,rotation:j}=this.parent.viewport;switch(j){case 90:return[0,M,M,y];case 180:return[M,y,M,y];case 270:return[y,0,M,y];default:return[0,0,M,y]}},yt=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,L.opacityToHex)(this.opacity)}`},Wt=function(M,y){this.isEditing=!0,D(this,u)||(fe(this,u,!0),he(this,n,He).call(this),this.thickness||(this.thickness=A._defaultThickness),this.color||(this.color=A._defaultColor||c.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=A._defaultOpacity)),this.currentPath.push([M,y]),fe(this,T,null),he(this,n,yt).call(this),this.ctx.beginPath(),this.ctx.moveTo(M,y),fe(this,o,()=>{D(this,o)&&(D(this,T)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):he(this,n,Ie).call(this),this.ctx.lineTo(...D(this,T)),fe(this,T,null),this.ctx.stroke()),window.requestAnimationFrame(D(this,o)))}),window.requestAnimationFrame(D(this,o))},qt=function(M,y){const[j,K]=this.currentPath.at(-1);M===j&&y===K||(this.currentPath.push([M,y]),fe(this,T,[M,y]))},$t=function(M,y){var ue;this.ctx.closePath(),fe(this,o,null),M=Math.min(Math.max(M,0),this.canvas.width),y=Math.min(Math.max(y,0),this.canvas.height);const[j,K]=this.currentPath.at(-1);(M!==j||y!==K)&&this.currentPath.push([M,y]);let B;if(this.currentPath.length!==1)B=(0,O.fitCurve)(this.currentPath,30,null);else{const re=[M,y];B=[[re,re.slice(),re.slice(),re]]}const Y=he(ue=A,f,vt).call(ue,B);this.currentPath.length=0;const Z=()=>{this.paths.push(B),this.bezierPath2D.push(Y),this.rebuild()},ae=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(he(this,n,et).call(this),he(this,n,tt).call(this)),he(this,n,Ge).call(this))};this.parent.addCommands({cmd:Z,undo:ae,mustExec:!0})},Ie=function(){if(this.isEmpty()){he(this,n,nt).call(this);return}he(this,n,yt).call(this);const{canvas:M,ctx:y}=this;y.setTransform(1,0,0,1,0,0),y.clearRect(0,0,M.width,M.height),he(this,n,nt).call(this);for(const j of this.bezierPath2D)y.stroke(j)},bt=function(M){he(this,n,$t).call(this,M.offsetX,M.offsetY),this.canvas.removeEventListener("pointerleave",D(this,P)),this.canvas.removeEventListener("pointermove",D(this,w)),this.parent.addToAnnotationStorage(this)},et=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",A._l10nPromise.get("editor_ink_canvas_aria_label").then(M=>{var y;return(y=this.canvas)==null?void 0:y.setAttribute("aria-label",M)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},tt=function(){fe(this,_,new ResizeObserver(M=>{const y=M[0].contentRect;y.width&&y.height&&this.setDimensions(y.width,y.height)})),D(this,_).observe(this.div)},He=function(){if(!D(this,u))return;const[M,y]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*M),this.canvas.height=Math.ceil(this.height*y),he(this,n,nt).call(this)},_t=function(M,y){const j=he(this,n,rt).call(this),K=(M-j)/D(this,N),B=(y-j)/D(this,R);this.scaleFactor=Math.min(K,B)},nt=function(){const M=he(this,n,rt).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+M,this.translationY*this.scaleFactor+M)},f=new WeakSet,vt=function(M){const y=new Path2D;for(let j=0,K=M.length;j<K;j++){const[B,Y,Z,ae]=M[j];j===0&&y.moveTo(...B),y.bezierCurveTo(Y[0],Y[1],Z[0],Z[1],ae[0],ae[1])}return y},Ht=function(M,y,j,K){const Y=[],Z=this.thickness/2;let ae,ue;for(const re of this.paths){ae=[],ue=[];for(let be=0,_e=re.length;be<_e;be++){const[me,ve,xe,we]=re[be],Ee=M*(me[0]+y)+Z,Re=K-M*(me[1]+j)-Z,Pe=M*(ve[0]+y)+Z,Te=K-M*(ve[1]+j)-Z,Le=M*(xe[0]+y)+Z,Be=K-M*(xe[1]+j)-Z,We=M*(we[0]+y)+Z,ce=K-M*(we[1]+j)-Z;be===0&&(ae.push(Ee,Re),ue.push(Ee,Re)),ae.push(Pe,Te,Le,Be,We,ce),he(this,n,Gt).call(this,Ee,Re,Pe,Te,Le,Be,We,ce,4,ue)}Y.push({bezier:ae,points:ue})}return Y},Gt=function(M,y,j,K,B,Y,Z,ae,ue,re){if(he(this,n,zt).call(this,M,y,j,K,B,Y,Z,ae)){re.push(Z,ae);return}for(let be=1;be<ue-1;be++){const _e=be/ue,me=1-_e;let ve=_e*M+me*j,xe=_e*y+me*K,we=_e*j+me*B,Ee=_e*K+me*Y;const Re=_e*B+me*Z,Pe=_e*Y+me*ae;ve=_e*ve+me*we,xe=_e*xe+me*Ee,we=_e*we+me*Re,Ee=_e*Ee+me*Pe,ve=_e*ve+me*we,xe=_e*xe+me*Ee,re.push(ve,xe)}re.push(Z,ae)},zt=function(M,y,j,K,B,Y,Z,ae){const re=(3*j-2*M-Z)**2,be=(3*K-2*y-ae)**2,_e=(3*B-M-2*Z)**2,me=(3*Y-y-2*ae)**2;return Math.max(re,_e)+Math.max(be,me)<=10},At=function(){let M=1/0,y=-1/0,j=1/0,K=-1/0;for(const B of this.paths)for(const[Y,Z,ae,ue]of B){const re=e.Util.bezierBoundingBox(...Y,...Z,...ae,...ue);M=Math.min(M,re[0]),j=Math.min(j,re[1]),y=Math.max(y,re[2]),K=Math.max(K,re[3])}return[M,j,y,K]},rt=function(){return D(this,l)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Ge=function(M=!1){if(this.isEmpty())return;if(!D(this,l)){he(this,n,Ie).call(this);return}const y=he(this,n,At).call(this),j=he(this,n,rt).call(this);fe(this,N,Math.max(F,y[2]-y[0])),fe(this,R,Math.max(F,y[3]-y[1]));const K=Math.ceil(j+D(this,N)*this.scaleFactor),B=Math.ceil(j+D(this,R)*this.scaleFactor),[Y,Z]=this.parent.viewportBaseDimensions;this.width=K/Y,this.height=B/Z,fe(this,m,K/B),he(this,n,xt).call(this);const ae=this.translationX,ue=this.translationY;this.translationX=-y[0],this.translationY=-y[1],he(this,n,He).call(this),he(this,n,Ie).call(this),fe(this,p,K),fe(this,a,B),this.setDims(K,B);const re=M?j/this.scaleFactor/2:0;this.translate(ae-this.translationX-re,ue-this.translationY-re)},xt=function(){const{style:M}=this.div;D(this,m)>=1?(M.minHeight=`${F}px`,M.minWidth=`${Math.round(D(this,m)*F)}px`):(M.minWidth=`${F}px`,M.minHeight=`${Math.round(F/D(this,m))}px`)},pe(A,f),ke(A,"_defaultColor",null),ke(A,"_defaultOpacity",1),ke(A,"_defaultThickness",1),ke(A,"_l10nPromise"),ke(A,"_type","ink");let S=A;s.InkEditor=S},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.fitCurve=void 0;const e=b(26);s.fitCurve=e},v=>{function s(h,t,l){if(!Array.isArray(h))throw new TypeError("First argument should be an array");if(h.forEach(p=>{if(!Array.isArray(p)||p.some(a=>typeof a!="number")||p.length!==h[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),h=h.filter((p,a)=>a===0||!p.every((o,n)=>o===h[a-1][n])),h.length<2)return[];const u=h.length,T=N(h[1],h[0]),_=N(h[u-2],h[u-1]);return b(h,T,_,t,l)}function b(h,t,l,u,T){var p,a,o,n,x,C,z,G,oe,le,se,ne,X;if(h.length===2)return ne=w.vectorLen(w.subtract(h[0],h[1]))/3,p=[h[0],w.addArrays(h[0],w.mulItems(t,ne)),w.addArrays(h[1],w.mulItems(l,ne)),h[1]],[p];if(a=F(h),[p,n,C]=e(h,a,a,t,l,T),n===0||n<u)return[p];if(n<u*u)for(o=a,x=n,z=C,X=0;X<20;X++){if(o=O(p,h,o),[p,n,C]=e(h,a,o,t,l,T),n<u)return[p];if(C===z){let J=n/x;if(J>.9999&&J<1.0001)break}x=n,z=C}return se=[],G=w.subtract(h[C-1],h[C+1]),G.every(J=>J===0)&&(G=w.subtract(h[C-1],h[C]),[G[0],G[1]]=[-G[1],G[0]]),oe=w.normalize(G),le=w.mulItems(oe,-1),se=se.concat(b(h.slice(0,C+1),t,oe,u,T)),se=se.concat(b(h.slice(C),le,l,u,T)),se}function e(h,t,l,u,T,_){var p,a,o;return p=c(h,l,u,T),[a,o]=S(h,p,t),_&&_({bez:p,points:h,params:t,maxErr:a,maxPoint:o}),[p,a,o]}function c(h,t,l,u){var T,_,p,a,o,n,x,C,z,G,oe,le,se,ne,X,J,Q,ie=h[0],de=h[h.length-1];for(T=[ie,null,null,de],_=w.zeros_Xx2x2(t.length),se=0,ne=t.length;se<ne;se++)J=t[se],Q=1-J,p=_[se],p[0]=w.mulItems(l,3*J*(Q*Q)),p[1]=w.mulItems(u,3*Q*(J*J));for(a=[[0,0],[0,0]],o=[0,0],se=0,ne=h.length;se<ne;se++)J=t[se],p=_[se],a[0][0]+=w.dot(p[0],p[0]),a[0][1]+=w.dot(p[0],p[1]),a[1][0]+=w.dot(p[0],p[1]),a[1][1]+=w.dot(p[1],p[1]),X=w.subtract(h[se],P.q([ie,ie,de,de],J)),o[0]+=w.dot(p[0],X),o[1]+=w.dot(p[1],X);return n=a[0][0]*a[1][1]-a[1][0]*a[0][1],x=a[0][0]*o[1]-a[1][0]*o[0],C=o[0]*a[1][1]-o[1]*a[0][1],z=n===0?0:C/n,G=n===0?0:x/n,le=w.vectorLen(w.subtract(ie,de)),oe=1e-6*le,z<oe||G<oe?(T[1]=w.addArrays(ie,w.mulItems(l,le/3)),T[2]=w.addArrays(de,w.mulItems(u,le/3))):(T[1]=w.addArrays(ie,w.mulItems(l,z)),T[2]=w.addArrays(de,w.mulItems(u,G))),T}function O(h,t,l){return l.map((u,T)=>L(h,t[T],u))}function L(h,t,l){var u=w.subtract(P.q(h,l),t),T=P.qprime(h,l),_=w.mulMatrix(u,T),p=w.sum(w.squareItems(T))+2*w.mulMatrix(u,P.qprimeprime(h,l));return p===0?l:l-_/p}function F(h){var t=[],l,u,T;return h.forEach((_,p)=>{l=p?u+w.vectorLen(w.subtract(_,T)):0,t.push(l),u=l,T=_}),t=t.map(_=>_/u),t}function S(h,t,l){var u,T,_,p,a,o,n,x;T=0,_=Math.floor(h.length/2);const C=m(t,10);for(a=0,o=h.length;a<o;a++)n=h[a],x=R(t,l[a],C,10),p=w.subtract(P.q(t,x),n),u=p[0]*p[0]+p[1]*p[1],u>T&&(T=u,_=a);return[T,_]}var m=function(h,t){for(var l,u=[0],T=h[0],_=0,p=1;p<=t;p++)l=P.q(h,p/t),_+=w.vectorLen(w.subtract(l,T)),u.push(_),T=l;return u=u.map(a=>a/_),u};function R(h,t,l,u){if(t<0)return 0;if(t>1)return 1;for(var T,_,p,a,o,n=1;n<=u;n++)if(t<=l[n]){a=(n-1)/u,p=n/u,_=l[n-1],T=l[n],o=(t-_)/(T-_)*(p-a)+a;break}return o}function N(h,t){return w.normalize(w.subtract(h,t))}class w{static zeros_Xx2x2(t){for(var l=[];t--;)l.push([0,0]);return l}static mulItems(t,l){return t.map(u=>u*l)}static mulMatrix(t,l){return t.reduce((u,T,_)=>u+T*l[_],0)}static subtract(t,l){return t.map((u,T)=>u-l[T])}static addArrays(t,l){return t.map((u,T)=>u+l[T])}static addItems(t,l){return t.map(u=>u+l)}static sum(t){return t.reduce((l,u)=>l+u)}static dot(t,l){return w.mulMatrix(t,l)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,l){return t.map(u=>u/l)}static squareItems(t){return t.map(l=>l*l)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class P{static q(t,l){var u=1-l,T=w.mulItems(t[0],u*u*u),_=w.mulItems(t[1],3*u*u*l),p=w.mulItems(t[2],3*u*l*l),a=w.mulItems(t[3],l*l*l);return w.addArrays(w.addArrays(T,_),w.addArrays(p,a))}static qprime(t,l){var u=1-l,T=w.mulItems(w.subtract(t[1],t[0]),3*u*u),_=w.mulItems(w.subtract(t[2],t[1]),6*u*l),p=w.mulItems(w.subtract(t[3],t[2]),3*l*l);return w.addArrays(w.addArrays(T,_),p)}static qprimeprime(t,l){return w.addArrays(w.mulItems(w.addArrays(w.subtract(t[2],w.mulItems(t[1],2)),t[0]),6*(1-l)),w.mulItems(w.addArrays(w.subtract(t[3],w.mulItems(t[2],2)),t[1]),6*l))}}v.exports=s,v.exports.fitCubic=b,v.exports.createTangent=N},(v,s,b)=>{var f,Et,St,Pt;Object.defineProperty(s,"__esModule",{value:!0}),s.AnnotationLayer=void 0;var e=b(1),c=b(8),O=b(5),L=b(28),F=b(29);const S=1e3,m=9,R=new WeakSet;function N(H){return{width:H[2]-H[0],height:H[3]-H[1]}}class w{static create(i){switch(i.data.annotationType){case e.AnnotationType.LINK:return new h(i);case e.AnnotationType.TEXT:return new t(i);case e.AnnotationType.WIDGET:switch(i.data.fieldType){case"Tx":return new u(i);case"Btn":return i.data.radioButton?new _(i):i.data.checkBox?new T(i):new p(i);case"Ch":return new a(i)}return new l(i);case e.AnnotationType.POPUP:return new o(i);case e.AnnotationType.FREETEXT:return new x(i);case e.AnnotationType.LINE:return new C(i);case e.AnnotationType.SQUARE:return new z(i);case e.AnnotationType.CIRCLE:return new G(i);case e.AnnotationType.POLYLINE:return new oe(i);case e.AnnotationType.CARET:return new se(i);case e.AnnotationType.INK:return new ne(i);case e.AnnotationType.POLYGON:return new le(i);case e.AnnotationType.HIGHLIGHT:return new X(i);case e.AnnotationType.UNDERLINE:return new J(i);case e.AnnotationType.SQUIGGLY:return new Q(i);case e.AnnotationType.STRIKEOUT:return new ie(i);case e.AnnotationType.STAMP:return new de(i);case e.AnnotationType.FILEATTACHMENT:return new ge(i);default:return new P(i)}}}class P{constructor(i,{isRenderable:g=!1,ignoreBorder:E=!1,createQuadrilaterals:A=!1}={}){this.isRenderable=g,this.data=i.data,this.layer=i.layer,this.page=i.page,this.viewport=i.viewport,this.linkService=i.linkService,this.downloadManager=i.downloadManager,this.imageResourcesPath=i.imageResourcesPath,this.renderForms=i.renderForms,this.svgFactory=i.svgFactory,this.annotationStorage=i.annotationStorage,this.enableScripting=i.enableScripting,this.hasJSActions=i.hasJSActions,this._fieldObjects=i.fieldObjects,this._mouseState=i.mouseState,g&&(this.container=this._createContainer(E)),A&&(this.quadrilaterals=this._createQuadrilaterals(E))}_createContainer(i=!1){const g=this.data,E=this.page,A=this.viewport,k=document.createElement("section"),{width:W,height:M}=N(g.rect),[y,j,K,B]=A.viewBox,Y=K-y,Z=B-j;k.setAttribute("data-annotation-id",g.id);const ae=e.Util.normalizeRect([g.rect[0],E.view[3]-g.rect[1]+E.view[1],g.rect[2],E.view[3]-g.rect[3]+E.view[1]]);if(!i&&g.borderStyle.width>0){k.style.borderWidth=`${g.borderStyle.width}px`;const re=g.borderStyle.horizontalCornerRadius,be=g.borderStyle.verticalCornerRadius;if(re>0||be>0){const me=`calc(${re}px * var(--scale-factor)) / calc(${be}px * var(--scale-factor))`;k.style.borderRadius=me}else if(this instanceof _){const me=`calc(${W}px * var(--scale-factor)) / calc(${M}px * var(--scale-factor))`;k.style.borderRadius=me}switch(g.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:k.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:k.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:k.style.borderBottomStyle="solid";break}const _e=g.borderColor||null;_e?k.style.borderColor=e.Util.makeHexColor(_e[0]|0,_e[1]|0,_e[2]|0):k.style.borderWidth=0}k.style.left=`${100*(ae[0]-y)/Y}%`,k.style.top=`${100*(ae[1]-j)/Z}%`;const{rotation:ue}=g;return g.hasOwnCanvas||ue===0?(k.style.width=`${100*W/Y}%`,k.style.height=`${100*M/Z}%`):this.setRotation(ue,k),k}setRotation(i,g=this.container){const[E,A,k,W]=this.viewport.viewBox,M=k-E,y=W-A,{width:j,height:K}=N(this.data.rect);let B,Y;i%180===0?(B=100*j/M,Y=100*K/y):(B=100*K/M,Y=100*j/y),g.style.width=`${B}%`,g.style.height=`${Y}%`,g.setAttribute("data-main-rotation",(360-i)%360)}get _commonActions(){const i=(g,E,A)=>{const k=A.detail[g];A.target.style[E]=L.ColorConverters[`${k[0]}_HTML`](k.slice(1))};return(0,e.shadow)(this,"_commonActions",{display:g=>{const E=g.detail.display%2===1;this.container.style.visibility=E?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:E,print:g.detail.display===0||g.detail.display===3})},print:g=>{this.annotationStorage.setValue(this.data.id,{print:g.detail.print})},hidden:g=>{this.container.style.visibility=g.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g.detail.hidden})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.detail.readonly?g.target.setAttribute("readonly",""):g.target.removeAttribute("readonly")},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{i("bgColor","backgroundColor",g)},fillColor:g=>{i("fillColor","backgroundColor",g)},fgColor:g=>{i("fgColor","color",g)},textColor:g=>{i("textColor","color",g)},borderColor:g=>{i("borderColor","borderColor",g)},strokeColor:g=>{i("strokeColor","borderColor",g)},rotation:g=>{const E=g.detail.rotation;this.setRotation(E),this.annotationStorage.setValue(this.data.id,{rotation:E})}})}_dispatchEventFromSandbox(i,g){const E=this._commonActions;for(const A of Object.keys(g.detail)){const k=i[A]||E[A];k&&k(g)}}_setDefaultPropertiesFromJS(i){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const E=this._commonActions;for(const[A,k]of Object.entries(g)){const W=E[A];if(W){const M={detail:{[A]:k},target:i};W(M),delete g[A]}}}_createQuadrilaterals(i=!1){if(!this.data.quadPoints)return null;const g=[],E=this.data.rect;for(const A of this.data.quadPoints)this.data.rect=[A[2].x,A[2].y,A[1].x,A[1].y],g.push(this._createContainer(i));return this.data.rect=E,g}_createPopup(i,g){let E=this.container;this.quadrilaterals&&(i=i||this.quadrilaterals,E=this.quadrilaterals[0]),i||(i=document.createElement("div"),i.className="popupTriggerArea",E.append(i));const k=new n({container:E,trigger:i,color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,hideWrapper:!0}).render();k.style.left="100%",E.append(k)}_renderQuadrilaterals(i){for(const g of this.quadrilaterals)g.className=i;return this.quadrilaterals}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(i,g=null){const E=[];if(this._fieldObjects){const A=this._fieldObjects[i];if(A)for(const{page:k,id:W,exportValues:M}of A){if(k===-1||W===g)continue;const y=typeof M=="string"?M:null,j=document.querySelector(`[data-element-id="${W}"]`);if(j&&!R.has(j)){(0,e.warn)(`_getElementsByName - element not allowed: ${W}`);continue}E.push({id:W,exportValue:y,domElement:j})}return E}for(const A of document.getElementsByName(i)){const{id:k,exportValue:W}=A;k!==g&&R.has(A)&&E.push({id:k,exportValue:W,domElement:A})}return E}static get platform(){const i=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:i.includes("Win"),isMac:i.includes("Mac")})}}class h extends P{constructor(i,g=null){super(i,{isRenderable:!0,ignoreBorder:!!(g!=null&&g.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:g}=this,E=document.createElement("a");E.setAttribute("data-element-id",i.id);let A=!1;return i.url?(g.addLinkAttributes(E,i.url,i.newWindow),A=!0):i.action?(this._bindNamedAction(E,i.action),A=!0):i.dest?(this._bindLink(E,i.dest),A=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(E,i),A=!0),i.resetForm?(this._bindResetFormAction(E,i.resetForm),A=!0):this.isTooltipOnly&&!A&&(this._bindLink(E,""),A=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((k,W)=>{const M=W===0?E:E.cloneNode();return k.append(M),k}):(this.container.className="linkAnnotation",A&&this.container.append(E),this.container)}_bindLink(i,g){i.href=this.linkService.getDestinationHash(g),i.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&(i.className="internalLink")}_bindNamedAction(i,g){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(g),!1),i.className="internalLink"}_bindJSAction(i,g){i.href=this.linkService.getAnchorUrl("");const E=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const A of Object.keys(g.actions)){const k=E.get(A);k&&(i[k]=()=>{var W;return(W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:A}}),!1})}i.onclick||(i.onclick=()=>!1),i.className="internalLink"}_bindResetFormAction(i,g){const E=i.onclick;if(E||(i.href=this.linkService.getAnchorUrl("")),i.className="internalLink",!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),E||(i.onclick=()=>!1);return}i.onclick=()=>{var K;E&&E();const{fields:A,refs:k,include:W}=g,M=[];if(A.length!==0||k.length!==0){const B=new Set(k);for(const Y of A){const Z=this._fieldObjects[Y]||[];for(const{id:ae}of Z)B.add(ae)}for(const Y of Object.values(this._fieldObjects))for(const Z of Y)B.has(Z.id)===W&&M.push(Z)}else for(const B of Object.values(this._fieldObjects))M.push(...B);const y=this.annotationStorage,j=[];for(const B of M){const{id:Y}=B;switch(j.push(Y),B.type){case"text":{const ae=B.defaultValue||"";y.setValue(Y,{value:ae});break}case"checkbox":case"radiobutton":{const ae=B.defaultValue===B.exportValues;y.setValue(Y,{value:ae});break}case"combobox":case"listbox":{const ae=B.defaultValue||"";y.setValue(Y,{value:ae});break}default:continue}const Z=document.querySelector(`[data-element-id="${Y}"]`);if(Z){if(!R.has(Z)){(0,e.warn)(`_bindResetFormAction - element not allowed: ${Y}`);continue}}else continue;Z.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:j,name:"ResetForm"}})),!1}}}class t extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g})}render(){this.container.className="textAnnotation";const i=document.createElement("img");return i.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",i.alt="[{{type}} Annotation]",i.dataset.l10nId="text_annotation_type",i.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(i,this.data),this.container.append(i),this.container}}class l extends P{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(i){const{isWin:g,isMac:E}=P.platform;return g&&i.ctrlKey||E&&i.metaKey}_setEventListener(i,g,E,A){g.includes("mouse")?i.addEventListener(g,k=>{var W;(W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:E,value:A(k),shift:k.shiftKey,modifier:this._getKeyModifier(k)}})}):i.addEventListener(g,k=>{var W;(W=this.linkService.eventBus)==null||W.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:E,value:A(k)}})})}_setEventListeners(i,g,E){var A;for(const[k,W]of g)(W==="Action"||(A=this.data.actions)!=null&&A[W])&&this._setEventListener(i,k,W,E)}_setBackgroundColor(i){const g=this.data.backgroundColor||null;i.style.backgroundColor=g===null?"transparent":e.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(i){const g=["left","center","right"],{fontColor:E}=this.data.defaultAppearanceData,A=this.data.defaultAppearanceData.fontSize||m,k=i.style;let W;if(this.data.multiLine){const M=Math.abs(this.data.rect[3]-this.data.rect[1]),y=Math.round(M/(e.LINE_FACTOR*A))||1,j=M/y;W=Math.min(A,Math.round(j/e.LINE_FACTOR))}else{const M=Math.abs(this.data.rect[3]-this.data.rect[1]);W=Math.min(A,Math.round(M/e.LINE_FACTOR))}k.fontSize=`calc(${W}px * var(--scale-factor))`,k.color=e.Util.makeHexColor(E[0],E[1],E[2]),this.data.textAlignment!==null&&(k.textAlign=g[this.data.textAlignment])}_setRequired(i,g){g?i.setAttribute("required",!0):i.removeAttribute("required"),i.setAttribute("aria-required",g)}}class u extends l{constructor(i){const g=i.renderForms||!i.data.hasAppearance&&!!i.data.fieldValue;super(i,{isRenderable:g})}setPropertyOnSiblings(i,g,E,A){const k=this.annotationStorage;for(const W of this._getElementsByName(i.name,i.id))W.domElement&&(W.domElement[g]=E),k.setValue(W.id,{[A]:E})}render(){var A;const i=this.annotationStorage,g=this.data.id;this.container.className="textWidgetAnnotation";let E=null;if(this.renderForms){const k=i.getValue(g,{value:this.data.fieldValue});let W=k.formattedValue||k.value||"";const M=i.getValue(g,{charLimit:this.data.maxLen}).charLimit;M&&W.length>M&&(W=W.slice(0,M));const y={userValue:W,formattedValue:null,valueOnFocus:""};this.data.multiLine?(E=document.createElement("textarea"),E.textContent=W,this.data.doNotScroll&&(E.style.overflowY="hidden")):(E=document.createElement("input"),E.type="text",E.setAttribute("value",W),this.data.doNotScroll&&(E.style.overflowX="hidden")),R.add(E),E.setAttribute("data-element-id",g),E.disabled=this.data.readOnly,E.name=this.data.fieldName,E.tabIndex=S,this._setRequired(E,this.data.required),M&&(E.maxLength=M),E.addEventListener("input",K=>{i.setValue(g,{value:K.target.value}),this.setPropertyOnSiblings(E,"value",K.target.value,"value")}),E.addEventListener("resetform",K=>{const B=this.data.defaultFieldValue??"";E.value=y.userValue=B,y.formattedValue=null});let j=K=>{const{formattedValue:B}=y;B!=null&&(K.target.value=B),K.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){E.addEventListener("focus",B=>{y.userValue&&(B.target.value=y.userValue),y.valueOnFocus=B.target.value}),E.addEventListener("updatefromsandbox",B=>{const Y={value(Z){y.userValue=Z.detail.value??"",i.setValue(g,{value:y.userValue.toString()}),Z.target.value=y.userValue},formattedValue(Z){const{formattedValue:ae}=Z.detail;y.formattedValue=ae,ae!=null&&Z.target!==document.activeElement&&(Z.target.value=ae),i.setValue(g,{formattedValue:ae})},selRange(Z){Z.target.setSelectionRange(...Z.detail.selRange)},charLimit:Z=>{var be;const{charLimit:ae}=Z.detail,{target:ue}=Z;if(ae===0){ue.removeAttribute("maxLength");return}ue.setAttribute("maxLength",ae);let re=y.userValue;!re||re.length<=ae||(re=re.slice(0,ae),ue.value=y.userValue=re,i.setValue(g,{value:re}),(be=this.linkService.eventBus)==null||be.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:re,willCommit:!0,commitKey:1,selStart:ue.selectionStart,selEnd:ue.selectionEnd}}))}};this._dispatchEventFromSandbox(Y,B)}),E.addEventListener("keydown",B=>{var ae;let Y=-1;if(B.key==="Escape"?Y=0:B.key==="Enter"?Y=2:B.key==="Tab"&&(Y=3),Y===-1)return;const{value:Z}=B.target;y.valueOnFocus!==Z&&(y.userValue=Z,(ae=this.linkService.eventBus)==null||ae.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:Z,willCommit:!0,commitKey:Y,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}}))});const K=j;j=null,E.addEventListener("blur",B=>{var Z;const{value:Y}=B.target;y.userValue=Y,this._mouseState.isDown&&y.valueOnFocus!==Y&&((Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:Y,willCommit:!0,commitKey:1,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}})),K(B)}),(A=this.data.actions)!=null&&A.Keystroke&&E.addEventListener("beforeinput",B=>{var me;const{data:Y,target:Z}=B,{value:ae,selectionStart:ue,selectionEnd:re}=Z;let be=ue,_e=re;switch(B.inputType){case"deleteWordBackward":{const ve=ae.substring(0,ue).match(/\w*[^\w]*$/);ve&&(be-=ve[0].length);break}case"deleteWordForward":{const ve=ae.substring(ue).match(/^[^\w]*\w*/);ve&&(_e+=ve[0].length);break}case"deleteContentBackward":ue===re&&(be-=1);break;case"deleteContentForward":ue===re&&(_e+=1);break}B.preventDefault(),(me=this.linkService.eventBus)==null||me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ae,change:Y||"",willCommit:!1,selStart:be,selEnd:_e}})}),this._setEventListeners(E,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.value)}if(j&&E.addEventListener("blur",j),this.data.comb){const B=(this.data.rect[2]-this.data.rect[0])/M;E.classList.add("comb"),E.style.letterSpacing=`calc(${B}px * var(--scale-factor) - 1ch)`}}else E=document.createElement("div"),E.textContent=this.data.fieldValue,E.style.verticalAlign="middle",E.style.display="table-cell";return this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class T extends l{constructor(i){super(i,{isRenderable:i.renderForms})}render(){const i=this.annotationStorage,g=this.data,E=g.id;let A=i.getValue(E,{value:g.exportValue===g.fieldValue}).value;typeof A=="string"&&(A=A!=="Off",i.setValue(E,{value:A})),this.container.className="buttonWidgetAnnotation checkBox";const k=document.createElement("input");return R.add(k),k.setAttribute("data-element-id",E),k.disabled=g.readOnly,this._setRequired(k,this.data.required),k.type="checkbox",k.name=g.fieldName,A&&k.setAttribute("checked",!0),k.setAttribute("exportValue",g.exportValue),k.tabIndex=S,k.addEventListener("change",W=>{const{name:M,checked:y}=W.target;for(const j of this._getElementsByName(M,E)){const K=y&&j.exportValue===g.exportValue;j.domElement&&(j.domElement.checked=K),i.setValue(j.id,{value:K})}i.setValue(E,{value:y})}),k.addEventListener("resetform",W=>{const M=g.defaultFieldValue||"Off";W.target.checked=M===g.exportValue}),this.enableScripting&&this.hasJSActions&&(k.addEventListener("updatefromsandbox",W=>{const M={value(y){y.target.checked=y.detail.value!=="Off",i.setValue(E,{value:y.target.checked})}};this._dispatchEventFromSandbox(M,W)}),this._setEventListeners(k,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],W=>W.target.checked)),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class _ extends l{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const i=this.annotationStorage,g=this.data,E=g.id;let A=i.getValue(E,{value:g.fieldValue===g.buttonValue}).value;typeof A=="string"&&(A=A!==g.buttonValue,i.setValue(E,{value:A}));const k=document.createElement("input");if(R.add(k),k.setAttribute("data-element-id",E),k.disabled=g.readOnly,this._setRequired(k,this.data.required),k.type="radio",k.name=g.fieldName,A&&k.setAttribute("checked",!0),k.tabIndex=S,k.addEventListener("change",W=>{const{name:M,checked:y}=W.target;for(const j of this._getElementsByName(M,E))i.setValue(j.id,{value:!1});i.setValue(E,{value:y})}),k.addEventListener("resetform",W=>{const M=g.defaultFieldValue;W.target.checked=M!=null&&M===g.buttonValue}),this.enableScripting&&this.hasJSActions){const W=g.buttonValue;k.addEventListener("updatefromsandbox",M=>{const y={value:j=>{const K=W===j.detail.value;for(const B of this._getElementsByName(j.target.name)){const Y=K&&B.id===E;B.domElement&&(B.domElement.checked=Y),i.setValue(B.id,{value:Y})}}};this._dispatchEventFromSandbox(y,M)}),this._setEventListeners(k,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],M=>M.target.checked)}return this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class p extends h{constructor(i){super(i,{ignoreBorder:i.data.hasAppearance})}render(){const i=super.render();i.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(i.title=this.data.alternativeText);const g=i.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",E=>{this._dispatchEventFromSandbox({},E)})),i}}class a extends l{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const i=this.annotationStorage,g=this.data.id,E=i.getValue(g,{value:this.data.fieldValue}),A=document.createElement("select");R.add(A),A.setAttribute("data-element-id",g),A.disabled=this.data.readOnly,this._setRequired(A,this.data.required),A.name=this.data.fieldName,A.tabIndex=S;let k=this.data.combo&&this.data.options.length>0;this.data.combo||(A.size=this.data.options.length,this.data.multiSelect&&(A.multiple=!0)),A.addEventListener("resetform",j=>{const K=this.data.defaultFieldValue;for(const B of A.options)B.selected=B.value===K});for(const j of this.data.options){const K=document.createElement("option");K.textContent=j.displayValue,K.value=j.exportValue,E.value.includes(j.exportValue)&&(K.setAttribute("selected",!0),k=!1),A.append(K)}let W=null;if(k){const j=document.createElement("option");j.value=" ",j.setAttribute("hidden",!0),j.setAttribute("selected",!0),A.prepend(j),W=()=>{j.remove(),A.removeEventListener("input",W),W=null},A.addEventListener("input",W)}const M=(j,K)=>{const B=K?"value":"textContent",Y=j.target.options;return j.target.multiple?Array.prototype.filter.call(Y,Z=>Z.selected).map(Z=>Z[B]):Y.selectedIndex===-1?null:Y[Y.selectedIndex][B]},y=j=>{const K=j.target.options;return Array.prototype.map.call(K,B=>({displayValue:B.textContent,exportValue:B.value}))};return this.enableScripting&&this.hasJSActions?(A.addEventListener("updatefromsandbox",j=>{const K={value(B){W==null||W();const Y=B.detail.value,Z=new Set(Array.isArray(Y)?Y:[Y]);for(const ae of A.options)ae.selected=Z.has(ae.value);i.setValue(g,{value:M(B,!0)})},multipleSelection(B){A.multiple=!0},remove(B){const Y=A.options,Z=B.detail.remove;Y[Z].selected=!1,A.remove(Z),Y.length>0&&Array.prototype.findIndex.call(Y,ue=>ue.selected)===-1&&(Y[0].selected=!0),i.setValue(g,{value:M(B,!0),items:y(B)})},clear(B){for(;A.length!==0;)A.remove(0);i.setValue(g,{value:null,items:[]})},insert(B){const{index:Y,displayValue:Z,exportValue:ae}=B.detail.insert,ue=A.children[Y],re=document.createElement("option");re.textContent=Z,re.value=ae,ue?ue.before(re):A.append(re),i.setValue(g,{value:M(B,!0),items:y(B)})},items(B){const{items:Y}=B.detail;for(;A.length!==0;)A.remove(0);for(const Z of Y){const{displayValue:ae,exportValue:ue}=Z,re=document.createElement("option");re.textContent=ae,re.value=ue,A.append(re)}A.options.length>0&&(A.options[0].selected=!0),i.setValue(g,{value:M(B,!0),items:y(B)})},indices(B){const Y=new Set(B.detail.indices);for(const Z of B.target.options)Z.selected=Y.has(Z.index);i.setValue(g,{value:M(B,!0)})},editable(B){B.target.disabled=!B.detail.editable}};this._dispatchEventFromSandbox(K,j)}),A.addEventListener("input",j=>{var Y;const K=M(j,!0),B=M(j,!1);i.setValue(g,{value:K}),(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:B,changeEx:K,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],j=>j.target.checked)):A.addEventListener("input",function(j){i.setValue(g,{value:M(j,!0)})}),this.data.combo&&this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class o extends P{constructor(i){var E,A,k;const g=!!((E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g})}render(){const i=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",i.includes(this.data.parentType))return this.container;const g=`[data-annotation-id="${this.data.parentId}"]`,E=this.layer.querySelectorAll(g);if(E.length===0)return this.container;const A=new n({container:this.container,trigger:Array.from(E),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),k=this.page,W=e.Util.normalizeRect([this.data.parentRect[0],k.view[3]-this.data.parentRect[1]+k.view[1],this.data.parentRect[2],k.view[3]-this.data.parentRect[3]+k.view[1]]),M=W[0]+this.data.parentRect[2]-this.data.parentRect[0],y=W[1],[j,K,B,Y]=this.viewport.viewBox,Z=B-j,ae=Y-K;return this.container.style.left=`${100*(M-j)/Z}%`,this.container.style.top=`${100*(y-K)/ae}%`,this.container.append(A.render()),this.container}}class n{constructor(i){this.container=i.container,this.trigger=i.trigger,this.color=i.color,this.titleObj=i.titleObj,this.modificationDate=i.modificationDate,this.contentsObj=i.contentsObj,this.richText=i.richText,this.hideWrapper=i.hideWrapper||!1,this.pinned=!1}render(){var M,y;const g=document.createElement("div");g.className="popupWrapper",this.hideElement=this.hideWrapper?g:this.container,this.hideElement.hidden=!0;const E=document.createElement("div");E.className="popup";const A=this.color;if(A){const j=.7*(255-A[0])+A[0],K=.7*(255-A[1])+A[1],B=.7*(255-A[2])+A[2];E.style.backgroundColor=e.Util.makeHexColor(j|0,K|0,B|0)}const k=document.createElement("h1");k.dir=this.titleObj.dir,k.textContent=this.titleObj.str,E.append(k);const W=c.PDFDateString.toDateObject(this.modificationDate);if(W){const j=document.createElement("span");j.className="popupDate",j.textContent="{{date}}, {{time}}",j.dataset.l10nId="annotation_date_string",j.dataset.l10nArgs=JSON.stringify({date:W.toLocaleDateString(),time:W.toLocaleTimeString()}),E.append(j)}if((M=this.richText)!=null&&M.str&&(!((y=this.contentsObj)!=null&&y.str)||this.contentsObj.str===this.richText.str))F.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:E}),E.lastChild.className="richText popupContent";else{const j=this._formatContents(this.contentsObj);E.append(j)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const j of this.trigger)j.addEventListener("click",this._toggle.bind(this)),j.addEventListener("mouseover",this._show.bind(this,!1)),j.addEventListener("mouseout",this._hide.bind(this,!1));return E.addEventListener("click",this._hide.bind(this,!0)),g.append(E),g}_formatContents({str:i,dir:g}){const E=document.createElement("p");E.className="popupContent",E.dir=g;const A=i.split(/(?:\r\n?|\n)/);for(let k=0,W=A.length;k<W;++k){const M=A[k];E.append(document.createTextNode(M)),k<W-1&&E.append(document.createElement("br"))}return E}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(i=!1){i&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(i=!0){i&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class x extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0}),this.textContent=i.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const i=document.createElement("div");i.className="annotationTextContent",i.setAttribute("role","comment");for(const g of this.textContent){const E=document.createElement("span");E.textContent=g,i.append(E)}this.container.append(i)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class C extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const i=this.data,{width:g,height:E}=N(i.rect),A=this.svgFactory.create(g,E,!0),k=this.svgFactory.createElement("svg:line");return k.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),k.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),k.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),k.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),k.setAttribute("stroke-width",i.borderStyle.width||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),A.append(k),this.container.append(A),this._createPopup(k,i),this.container}}class z extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const i=this.data,{width:g,height:E}=N(i.rect),A=this.svgFactory.create(g,E,!0),k=i.borderStyle.width,W=this.svgFactory.createElement("svg:rect");return W.setAttribute("x",k/2),W.setAttribute("y",k/2),W.setAttribute("width",g-k),W.setAttribute("height",E-k),W.setAttribute("stroke-width",k||1),W.setAttribute("stroke","transparent"),W.setAttribute("fill","transparent"),A.append(W),this.container.append(A),this._createPopup(W,i),this.container}}class G extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const i=this.data,{width:g,height:E}=N(i.rect),A=this.svgFactory.create(g,E,!0),k=i.borderStyle.width,W=this.svgFactory.createElement("svg:ellipse");return W.setAttribute("cx",g/2),W.setAttribute("cy",E/2),W.setAttribute("rx",g/2-k/2),W.setAttribute("ry",E/2-k/2),W.setAttribute("stroke-width",k||1),W.setAttribute("stroke","transparent"),W.setAttribute("fill","transparent"),A.append(W),this.container.append(A),this._createPopup(W,i),this.container}}class oe extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:g,height:E}=N(i.rect),A=this.svgFactory.create(g,E,!0);let k=[];for(const M of i.vertices){const y=M.x-i.rect[0],j=i.rect[3]-M.y;k.push(y+","+j)}k=k.join(" ");const W=this.svgFactory.createElement(this.svgElementName);return W.setAttribute("points",k),W.setAttribute("stroke-width",i.borderStyle.width||1),W.setAttribute("stroke","transparent"),W.setAttribute("fill","transparent"),A.append(W),this.container.append(A),this._createPopup(W,i),this.container}}class le extends oe{constructor(i){super(i),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class se extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ne extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:g,height:E}=N(i.rect),A=this.svgFactory.create(g,E,!0);for(const k of i.inkLists){let W=[];for(const y of k){const j=y.x-i.rect[0],K=i.rect[3]-y.y;W.push(`${j},${K}`)}W=W.join(" ");const M=this.svgFactory.createElement(this.svgElementName);M.setAttribute("points",W),M.setAttribute("stroke-width",i.borderStyle.width||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),this._createPopup(M,i),A.append(M)}return this.container.append(A),this.container}}class X extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class J extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Q extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class ie extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class de extends P{constructor(i){var E,A,k;const g=!!(i.data.hasPopup||(E=i.data.titleObj)!=null&&E.str||(A=i.data.contentsObj)!=null&&A.str||(k=i.data.richText)!=null&&k.str);super(i,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ge extends P{constructor(i){var A;super(i,{isRenderable:!0});const{filename:g,content:E}=this.data.file;this.filename=(0,c.getFilenameFromUrl)(g),this.content=E,(A=this.linkService.eventBus)==null||A.dispatch("fileattachmentannotation",{source:this,filename:g,content:E})}render(){var g,E;this.container.className="fileAttachmentAnnotation";const i=document.createElement("div");return i.className="popupTriggerArea",i.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((g=this.data.titleObj)!=null&&g.str||(E=this.data.contentsObj)!=null&&E.str||this.data.richText)&&this._createPopup(i,this.data),this.container.append(i),this.container}_download(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.container,this.content,this.filename)}}const $=class ${static render(i){var M,y;const{annotations:g,div:E,viewport:A,accessibilityManager:k}=i;he(this,f,St).call(this,E,A);let W=0;for(const j of g){if(j.annotationType!==e.AnnotationType.POPUP){const{width:B,height:Y}=N(j.rect);if(B<=0||Y<=0)continue}const K=w.create({data:j,layer:E,page:i.page,viewport:A,linkService:i.linkService,downloadManager:i.downloadManager,imageResourcesPath:i.imageResourcesPath||"",renderForms:i.renderForms!==!1,svgFactory:new c.DOMSVGFactory,annotationStorage:i.annotationStorage||new O.AnnotationStorage,enableScripting:i.enableScripting,hasJSActions:i.hasJSActions,fieldObjects:i.fieldObjects,mouseState:i.mouseState||{isDown:!1}});if(K.isRenderable){const B=K.render();if(j.hidden&&(B.style.visibility="hidden"),Array.isArray(B))for(const Y of B)Y.style.zIndex=W++,he(M=$,f,Et).call(M,Y,j.id,E,k);else B.style.zIndex=W++,K instanceof o?E.prepend(B):he(y=$,f,Et).call(y,B,j.id,E,k)}}he(this,f,Pt).call(this,E,i.annotationCanvasMap)}static update(i){const{annotationCanvasMap:g,div:E,viewport:A}=i;he(this,f,St).call(this,E,A),he(this,f,Pt).call(this,E,g),E.hidden=!1}};f=new WeakSet,Et=function(i,g,E,A){const k=i.firstChild||i;k.id=`${c.AnnotationPrefix}${g}`,E.append(i),A==null||A.moveElementInDOM(E,i,k,!1)},St=function(i,{width:g,height:E,rotation:A}){const{style:k}=i,W=A%180!==0,M=Math.floor(g)+"px",y=Math.floor(E)+"px";k.width=W?y:M,k.height=W?M:y,i.setAttribute("data-main-rotation",A)},Pt=function(i,g){if(g){for(const[E,A]of g){const k=i.querySelector(`[data-annotation-id="${E}"]`);if(!k)continue;const{firstChild:W}=k;W?W.nodeName==="CANVAS"?W.replaceWith(A):W.before(A):k.append(A)}g.clear()}},pe($,f);let V=$;s.AnnotationLayer=V},(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorConverters=void 0;function b(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}class e{static CMYK_G([O,L,F,S]){return["G",1-Math.min(1,.3*O+.59*F+.11*L+S)]}static G_CMYK([O]){return["CMYK",0,0,0,1-O]}static G_RGB([O]){return["RGB",O,O,O]}static G_HTML([O]){const L=b(O);return`#${L}${L}${L}`}static RGB_G([O,L,F]){return["G",.3*O+.59*L+.11*F]}static RGB_HTML([O,L,F]){const S=b(O),m=b(L),R=b(F);return`#${S}${m}${R}`}static T_HTML(){return"#00000000"}static CMYK_RGB([O,L,F,S]){return["RGB",1-Math.min(1,O+S),1-Math.min(1,F+S),1-Math.min(1,L+S)]}static CMYK_HTML(O){const L=this.CMYK_RGB(O).slice(1);return this.RGB_HTML(L)}static RGB_CMYK([O,L,F]){const S=1-O,m=1-L,R=1-F,N=Math.min(S,m,R);return["CMYK",S,m,R,N]}}s.ColorConverters=e},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.XfaLayer=void 0;var e=b(20);class c{static setupStorage(L,F,S,m,R){const N=m.getValue(F,{value:null});switch(S.name){case"textarea":if(N.value!==null&&(L.textContent=N.value),R==="print")break;L.addEventListener("input",w=>{m.setValue(F,{value:w.target.value})});break;case"input":if(S.attributes.type==="radio"||S.attributes.type==="checkbox"){if(N.value===S.attributes.xfaOn?L.setAttribute("checked",!0):N.value===S.attributes.xfaOff&&L.removeAttribute("checked"),R==="print")break;L.addEventListener("change",w=>{m.setValue(F,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&L.setAttribute("value",N.value),R==="print")break;L.addEventListener("input",w=>{m.setValue(F,{value:w.target.value})})}break;case"select":if(N.value!==null)for(const w of S.children)w.attributes.value===N.value&&(w.attributes.selected=!0);L.addEventListener("input",w=>{const P=w.target.options,h=P.selectedIndex===-1?"":P[P.selectedIndex].value;m.setValue(F,{value:h})});break}}static setAttributes({html:L,element:F,storage:S=null,intent:m,linkService:R}){const{attributes:N}=F,w=L instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${m}`);for(const[P,h]of Object.entries(N))if(h!=null)switch(P){case"class":h.length&&L.setAttribute(P,h.join(" "));break;case"dataId":break;case"id":L.setAttribute("data-element-id",h);break;case"style":Object.assign(L.style,h);break;case"textContent":L.textContent=h;break;default:(!w||P!=="href"&&P!=="newWindow")&&L.setAttribute(P,h)}w&&R.addLinkAttributes(L,N.href,N.newWindow),S&&N.dataId&&this.setupStorage(L,N.dataId,F,S)}static render(L){var t;const F=L.annotationStorage,S=L.linkService,m=L.xfaHtml,R=L.intent||"display",N=document.createElement(m.name);m.attributes&&this.setAttributes({html:N,element:m,intent:R,linkService:S});const w=[[m,-1,N]],P=L.div;if(P.append(N),L.viewport){const l=`matrix(${L.viewport.transform.join(",")})`;P.style.transform=l}R!=="richText"&&P.setAttribute("class","xfaLayer xfaFont");const h=[];for(;w.length>0;){const[l,u,T]=w.at(-1);if(u+1===l.children.length){w.pop();continue}const _=l.children[++w.at(-1)[1]];if(_===null)continue;const{name:p}=_;if(p==="#text"){const o=document.createTextNode(_.value);h.push(o),T.append(o);continue}let a;if((t=_==null?void 0:_.attributes)!=null&&t.xmlns?a=document.createElementNS(_.attributes.xmlns,p):a=document.createElement(p),T.append(a),_.attributes&&this.setAttributes({html:a,element:_,storage:F,intent:R,linkService:S}),_.children&&_.children.length>0)w.push([_,-1,a]);else if(_.value){const o=document.createTextNode(_.value);e.XfaText.shouldBuildText(p)&&h.push(o),a.append(o)}}for(const l of P.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))l.setAttribute("readOnly",!0);return{textDivs:h}}static update(L){const F=`matrix(${L.viewport.transform.join(",")})`;L.div.style.transform=F,L.div.hidden=!1}}s.XfaLayer=c},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TextLayerRenderTask=void 0,s.renderTextLayer=T;var e=b(1),c=b(8);const O=1e5,L=30,F=.8,S=new Map,m=/^\s+$/g;function R(_,p){const a=S.get(_);if(a)return a;p.save(),p.font=`${L}px ${_}`;const o=p.measureText("");let n=o.fontBoundingBoxAscent,x=Math.abs(o.fontBoundingBoxDescent);if(n){p.restore();const z=n/(n+x);return S.set(_,z),z}p.strokeStyle="red",p.clearRect(0,0,L,L),p.strokeText("g",0,0);let C=p.getImageData(0,0,L,L).data;x=0;for(let z=C.length-1-3;z>=0;z-=4)if(C[z]>0){x=Math.ceil(z/4/L);break}p.clearRect(0,0,L,L),p.strokeText("A",0,L),C=p.getImageData(0,0,L,L).data,n=0;for(let z=0,G=C.length;z<G;z+=4)if(C[z]>0){n=L-Math.floor(z/4/L);break}if(p.restore(),n){const z=n/(n+x);return S.set(_,z),z}return S.set(_,F),F}function N(_,p,a,o){const n=document.createElement("span"),x=_._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:p.str!=="",hasEOL:p.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:p.str!=="",hasEOL:p.hasEOL,fontSize:0};_._textDivs.push(n);const C=e.Util.transform(_._viewport.transform,p.transform);let z=Math.atan2(C[1],C[0]);const G=a[p.fontName];G.vertical&&(z+=Math.PI/2);const oe=Math.hypot(C[2],C[3]),le=oe*R(G.fontFamily,o);let se,ne;z===0?(se=C[4],ne=C[5]-le):(se=C[4]+le*Math.sin(z),ne=C[5]-le*Math.cos(z)),n.style.left=`${se}px`,n.style.top=`${ne}px`,n.style.fontSize=`${oe}px`,n.style.fontFamily=G.fontFamily,x.fontSize=oe,n.setAttribute("role","presentation"),n.textContent=p.str,n.dir=p.dir,_._fontInspectorEnabled&&(n.dataset.fontName=p.fontName),z!==0&&(x.angle=z*(180/Math.PI));let X=!1;if(p.str.length>1||_._enhanceTextSelection&&m.test(p.str))X=!0;else if(p.str!==" "&&p.transform[0]!==p.transform[3]){const J=Math.abs(p.transform[0]),Q=Math.abs(p.transform[3]);J!==Q&&Math.max(J,Q)/Math.min(J,Q)>1.5&&(X=!0)}if(X&&(G.vertical?x.canvasWidth=p.height*_._viewport.scale:x.canvasWidth=p.width*_._viewport.scale),_._textDivProperties.set(n,x),_._textContentStream&&_._layoutText(n),_._enhanceTextSelection&&x.hasText){let J=1,Q=0;z!==0&&(J=Math.cos(z),Q=Math.sin(z));const ie=(G.vertical?p.height:p.width)*_._viewport.scale,de=oe;let ge,V;z!==0?(ge=[J,Q,-Q,J,se,ne],V=e.Util.getAxialAlignedBoundingBox([0,0,ie,de],ge)):V=[se,ne,se+ie,ne+de],_._bounds.push({left:V[0],top:V[1],right:V[2],bottom:V[3],div:n,size:[ie,de],m:ge})}}function w(_){if(_._canceled)return;const p=_._textDivs,a=_._capability,o=p.length;if(o>O){_._renderingDone=!0,a.resolve();return}if(!_._textContentStream)for(let n=0;n<o;n++)_._layoutText(p[n]);_._renderingDone=!0,a.resolve()}function P(_,p,a){let o=0;for(let n=0;n<a;n++){const x=_[p++];x>0&&(o=o?Math.min(x,o):x)}return o}function h(_){const p=_._bounds,a=_._viewport,o=t(a.width,a.height,p);for(let n=0;n<o.length;n++){const x=p[n].div,C=_._textDivProperties.get(x);if(C.angle===0){C.paddingLeft=p[n].left-o[n].left,C.paddingTop=p[n].top-o[n].top,C.paddingRight=o[n].right-p[n].right,C.paddingBottom=o[n].bottom-p[n].bottom,_._textDivProperties.set(x,C);continue}const z=o[n],G=p[n],oe=G.m,le=oe[0],se=oe[1],ne=[[0,0],[0,G.size[1]],[G.size[0],0],G.size],X=new Float64Array(64);for(let Q=0,ie=ne.length;Q<ie;Q++){const de=e.Util.applyTransform(ne[Q],oe);X[Q+0]=le&&(z.left-de[0])/le,X[Q+4]=se&&(z.top-de[1])/se,X[Q+8]=le&&(z.right-de[0])/le,X[Q+12]=se&&(z.bottom-de[1])/se,X[Q+16]=se&&(z.left-de[0])/-se,X[Q+20]=le&&(z.top-de[1])/le,X[Q+24]=se&&(z.right-de[0])/-se,X[Q+28]=le&&(z.bottom-de[1])/le,X[Q+32]=le&&(z.left-de[0])/-le,X[Q+36]=se&&(z.top-de[1])/-se,X[Q+40]=le&&(z.right-de[0])/-le,X[Q+44]=se&&(z.bottom-de[1])/-se,X[Q+48]=se&&(z.left-de[0])/se,X[Q+52]=le&&(z.top-de[1])/-le,X[Q+56]=se&&(z.right-de[0])/se,X[Q+60]=le&&(z.bottom-de[1])/-le}const J=1+Math.min(Math.abs(le),Math.abs(se));C.paddingLeft=P(X,32,16)/J,C.paddingTop=P(X,48,16)/J,C.paddingRight=P(X,0,16)/J,C.paddingBottom=P(X,16,16)/J,_._textDivProperties.set(x,C)}}function t(_,p,a){const o=a.map(function(x,C){return{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom,index:C,x1New:void 0,x2New:void 0}});l(_,o);const n=new Array(a.length);for(const x of o){const C=x.index;n[C]={left:x.x1New,top:0,right:x.x2New,bottom:0}}a.map(function(x,C){const z=n[C],G=o[C];G.x1=x.top,G.y1=_-z.right,G.x2=x.bottom,G.y2=_-z.left,G.index=C,G.x1New=void 0,G.x2New=void 0}),l(p,o);for(const x of o){const C=x.index;n[C].top=x.x1New,n[C].bottom=x.x2New}return n}function l(_,p){p.sort(function(n,x){return n.x1-x.x1||n.index-x.index});const o=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const n of p){let x=0;for(;x<o.length&&o[x].end<=n.y1;)x++;let C=o.length-1;for(;C>=0&&o[C].start>=n.y2;)C--;let z,G,oe,le,se=-1/0;for(oe=x;oe<=C;oe++){z=o[oe],G=z.boundary;let J;G.x2>n.x1?J=G.index>n.index?G.x1New:n.x1:G.x2New===void 0?J=(G.x2+n.x1)/2:J=G.x2New,J>se&&(se=J)}for(n.x1New=se,oe=x;oe<=C;oe++)z=o[oe],G=z.boundary,G.x2New===void 0?G.x2>n.x1?G.index>n.index&&(G.x2New=G.x2):G.x2New=se:G.x2New>se&&(G.x2New=Math.max(se,G.x2));const ne=[];let X=null;for(oe=x;oe<=C;oe++){z=o[oe],G=z.boundary;const J=G.x2>n.x2?G:n;X===J?ne.at(-1).end=z.end:(ne.push({start:z.start,end:z.end,boundary:J}),X=J)}for(o[x].start<n.y1&&(ne[0].start=n.y1,ne.unshift({start:o[x].start,end:n.y1,boundary:o[x].boundary})),n.y2<o[C].end&&(ne.at(-1).end=n.y2,ne.push({start:n.y2,end:o[C].end,boundary:o[C].boundary})),oe=x;oe<=C;oe++){if(z=o[oe],G=z.boundary,G.x2New!==void 0)continue;let J=!1;for(le=x-1;!J&&le>=0&&o[le].start>=G.y1;le--)J=o[le].boundary===G;for(le=C+1;!J&&le<o.length&&o[le].end<=G.y2;le++)J=o[le].boundary===G;for(le=0;!J&&le<ne.length;le++)J=ne[le].boundary===G;J||(G.x2New=se)}Array.prototype.splice.apply(o,[x,C-x+1,...ne])}for(const n of o){const x=n.boundary;x.x2New===void 0&&(x.x2New=Math.max(_,x.x2))}}class u{constructor({textContent:p,textContentStream:a,container:o,viewport:n,textDivs:x,textContentItemsStr:C,enhanceTextSelection:z}){var G;z&&(0,c.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=p,this._textContentStream=a,this._container=o,this._document=o.ownerDocument,this._viewport=n,this._textDivs=x||[],this._textContentItemsStr=C||[],this._enhanceTextSelection=!!z,this._fontInspectorEnabled=!!((G=globalThis.FontInspector)!=null&&G.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,e.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(p,a){for(let o=0,n=p.length;o<n;o++){if(p[o].str===void 0){if(p[o].type==="beginMarkedContentProps"||p[o].type==="beginMarkedContent"){const x=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),p[o].id!==null&&this._container.setAttribute("id",`${p[o].id}`),x.append(this._container)}else p[o].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(p[o].str),N(this,p[o],a,this._layoutTextCtx)}}_layoutText(p){const a=this._textDivProperties.get(p);let o="";if(a.canvasWidth!==0&&a.hasText){const{fontFamily:n}=p.style,{fontSize:x}=a;(x!==this._layoutTextLastFontSize||n!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${x*this._devicePixelRatio}px ${n}`,this._layoutTextLastFontSize=x,this._layoutTextLastFontFamily=n);const{width:C}=this._layoutTextCtx.measureText(p.textContent);if(C>0){const z=this._devicePixelRatio*a.canvasWidth/C;this._enhanceTextSelection&&(a.scale=z),o=`scaleX(${z})`}}if(a.angle!==0&&(o=`rotate(${a.angle}deg) ${o}`),o.length>0&&(this._enhanceTextSelection&&(a.originalTransform=o),p.style.transform=o),a.hasText&&this._container.append(p),a.hasEOL){const n=document.createElement("br");n.setAttribute("role","presentation"),this._container.append(n)}}_render(p=0){const a=(0,e.createPromiseCapability)();let o=Object.create(null);const n=this._document.createElement("canvas");if(n.height=n.width=L,this._layoutTextCtx=n.getContext("2d",{alpha:!1}),this._textContent){const x=this._textContent.items,C=this._textContent.styles;this._processItems(x,C),a.resolve()}else if(this._textContentStream){const x=()=>{this._reader.read().then(({value:C,done:z})=>{if(z){a.resolve();return}Object.assign(o,C.styles),this._processItems(C.items,o),x()},a.reject)};this._reader=this._textContentStream.getReader(),x()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');a.promise.then(()=>{o=null,p?this._renderTimer=setTimeout(()=>{w(this),this._renderTimer=null},p):w(this)},this._capability.reject)}expandTextDivs(p=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(h(this),this._bounds=null);const a=[],o=[];for(let n=0,x=this._textDivs.length;n<x;n++){const C=this._textDivs[n],z=this._textDivProperties.get(C);z.hasText&&(p?(a.length=0,o.length=0,z.originalTransform&&a.push(z.originalTransform),z.paddingTop>0?(o.push(`${z.paddingTop}px`),a.push(`translateY(${-z.paddingTop}px)`)):o.push(0),z.paddingRight>0?o.push(`${z.paddingRight/z.scale}px`):o.push(0),z.paddingBottom>0?o.push(`${z.paddingBottom}px`):o.push(0),z.paddingLeft>0?(o.push(`${z.paddingLeft/z.scale}px`),a.push(`translateX(${-z.paddingLeft/z.scale}px)`)):o.push(0),C.style.padding=o.join(" "),a.length&&(C.style.transform=a.join(" "))):(C.style.padding=null,C.style.transform=z.originalTransform))}}}s.TextLayerRenderTask=u;function T(_){const p=new u({textContent:_.textContent,textContentStream:_.textContentStream,container:_.container,viewport:_.viewport,textDivs:_.textDivs,textContentItemsStr:_.textContentItemsStr,enhanceTextSelection:_.enhanceTextSelection});return p._render(_.timeout),p}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SVGGraphics=void 0;var e=b(8),c=b(1),O=b(3);let L=class{constructor(){(0,c.unreachable)("Not implemented: SVGGraphics")}};s.SVGGraphics=L;{let t=function(a){let o=[];const n=[];for(const x of a){if(x.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),n.push(o),o=o.at(-1).items;continue}x.fn==="restore"?o=n.pop():o.push(x)}return o},l=function(a){if(Number.isInteger(a))return a.toString();const o=a.toFixed(10);let n=o.length-1;if(o[n]!=="0")return o;do n--;while(o[n]==="0");return o.substring(0,o[n]==="."?n:n+1)},u=function(a){if(a[4]===0&&a[5]===0){if(a[1]===0&&a[2]===0)return a[0]===1&&a[3]===1?"":`scale(${l(a[0])} ${l(a[3])})`;if(a[0]===a[3]&&a[1]===-a[2]){const o=Math.acos(a[0])*180/Math.PI;return`rotate(${l(o)})`}}else if(a[0]===1&&a[1]===0&&a[2]===0&&a[3]===1)return`translate(${l(a[4])} ${l(a[5])})`;return`matrix(${l(a[0])} ${l(a[1])} ${l(a[2])} ${l(a[3])} ${l(a[4])} ${l(a[5])})`};const F={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},S="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/1999/xlink",R=["butt","round","square"],N=["miter","round","bevel"],w=function(a,o="",n=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!n)return URL.createObjectURL(new Blob([a],{type:o}));const x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let C=`data:${o};base64,`;for(let z=0,G=a.length;z<G;z+=3){const oe=a[z]&255,le=a[z+1]&255,se=a[z+2]&255,ne=oe>>2,X=(oe&3)<<4|le>>4,J=z+1<G?(le&15)<<2|se>>6:64,Q=z+2<G?se&63:64;C+=x[ne]+x[X]+x[J]+x[Q]}return C},P=function(){const a=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,n=new Int32Array(256);for(let se=0;se<256;se++){let ne=se;for(let X=0;X<8;X++)ne&1?ne=3988292384^ne>>1&2147483647:ne=ne>>1&2147483647;n[se]=ne}function x(se,ne,X){let J=-1;for(let Q=ne;Q<X;Q++){const ie=(J^se[Q])&255,de=n[ie];J=J>>>8^de}return J^-1}function C(se,ne,X,J){let Q=J;const ie=ne.length;X[Q]=ie>>24&255,X[Q+1]=ie>>16&255,X[Q+2]=ie>>8&255,X[Q+3]=ie&255,Q+=4,X[Q]=se.charCodeAt(0)&255,X[Q+1]=se.charCodeAt(1)&255,X[Q+2]=se.charCodeAt(2)&255,X[Q+3]=se.charCodeAt(3)&255,Q+=4,X.set(ne,Q),Q+=ne.length;const de=x(X,J+4,Q);X[Q]=de>>24&255,X[Q+1]=de>>16&255,X[Q+2]=de>>8&255,X[Q+3]=de&255}function z(se,ne,X){let J=1,Q=0;for(let ie=ne;ie<X;++ie)J=(J+(se[ie]&255))%65521,Q=(Q+J)%65521;return Q<<16|J}function G(se){if(!O.isNodeJS)return oe(se);try{let ne;parseInt(process.versions.node)>=8?ne=se:ne=Buffer.from(se);const X=require$$5.deflateSync(ne,{level:9});return X instanceof Uint8Array?X:new Uint8Array(X)}catch(ne){(0,c.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ne)}return oe(se)}function oe(se){let ne=se.length;const X=65535,J=Math.ceil(ne/X),Q=new Uint8Array(2+ne+J*5+4);let ie=0;Q[ie++]=120,Q[ie++]=156;let de=0;for(;ne>X;)Q[ie++]=0,Q[ie++]=255,Q[ie++]=255,Q[ie++]=0,Q[ie++]=0,Q.set(se.subarray(de,de+X),ie),ie+=X,de+=X,ne-=X;Q[ie++]=1,Q[ie++]=ne&255,Q[ie++]=ne>>8&255,Q[ie++]=~ne&65535&255,Q[ie++]=(~ne&65535)>>8&255,Q.set(se.subarray(de),ie),ie+=se.length-de;const ge=z(se,0,se.length);return Q[ie++]=ge>>24&255,Q[ie++]=ge>>16&255,Q[ie++]=ge>>8&255,Q[ie++]=ge&255,Q}function le(se,ne,X,J){const Q=se.width,ie=se.height;let de,ge,V;const f=se.data;switch(ne){case c.ImageKind.GRAYSCALE_1BPP:ge=0,de=1,V=Q+7>>3;break;case c.ImageKind.RGB_24BPP:ge=2,de=8,V=Q*3;break;case c.ImageKind.RGBA_32BPP:ge=6,de=8,V=Q*4;break;default:throw new Error("invalid format")}const d=new Uint8Array((1+V)*ie);let I=0,q=0;for(let A=0;A<ie;++A)d[I++]=0,d.set(f.subarray(q,q+V),I),q+=V,I+=V;if(ne===c.ImageKind.GRAYSCALE_1BPP&&J){I=0;for(let A=0;A<ie;A++){I++;for(let k=0;k<V;k++)d[I++]^=255}}const $=new Uint8Array([Q>>24&255,Q>>16&255,Q>>8&255,Q&255,ie>>24&255,ie>>16&255,ie>>8&255,ie&255,de,ge,0,0,0]),H=G(d),i=a.length+o*3+$.length+H.length,g=new Uint8Array(i);let E=0;return g.set(a,E),E+=a.length,C("IHDR",$,g,E),E+=o+$.length,C("IDATA",H,g,E),E+=o+H.length,C("IEND",new Uint8Array(0),g,E),w(g,"image/png",X)}return function(ne,X,J){const Q=ne.kind===void 0?c.ImageKind.GRAYSCALE_1BPP:ne.kind;return le(ne,Q,X,J)}}();class h{constructor(){this.fontSizeScale=1,this.fontWeight=F.fontWeight,this.fontSize=0,this.textMatrix=c.IDENTITY_MATRIX,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=c.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=F.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,n){this.x=o,this.y=n}}let T=0,_=0,p=0;s.SVGGraphics=L=class{constructor(a,o,n=!1){(0,e.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new e.DOMSVGFactory,this.current=new h,this.transformMatrix=c.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=a,this.objs=o,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const x in c.OPS)this._operatorIdMapping[c.OPS[x]]=x}save(){this.transformStack.push(this.transformMatrix);const a=this.current;this.extraStack.push(a),this.current=a.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(a){this.save(),this.executeOpTree(a),this.restore()}loadDependencies(a){const o=a.fnArray,n=a.argsArray;for(let x=0,C=o.length;x<C;x++)if(o[x]===c.OPS.dependency)for(const z of n[x]){const G=z.startsWith("g_")?this.commonObjs:this.objs,oe=new Promise(le=>{G.get(z,le)});this.current.dependencies.push(oe)}return Promise.all(this.current.dependencies)}transform(a,o,n,x,C,z){const G=[a,o,n,x,C,z];this.transformMatrix=c.Util.transform(this.transformMatrix,G),this.tgrp=null}getSVG(a,o){this.viewport=o;const n=this._initialize(o);return this.loadDependencies(a).then(()=>(this.transformMatrix=c.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(a)),n))}convertOpList(a){const o=this._operatorIdMapping,n=a.argsArray,x=a.fnArray,C=[];for(let z=0,G=x.length;z<G;z++){const oe=x[z];C.push({fnId:oe,fn:o[oe],args:n[z]})}return t(C)}executeOpTree(a){for(const o of a){const n=o.fn,x=o.fnId,C=o.args;switch(x|0){case c.OPS.beginText:this.beginText();break;case c.OPS.dependency:break;case c.OPS.setLeading:this.setLeading(C);break;case c.OPS.setLeadingMoveText:this.setLeadingMoveText(C[0],C[1]);break;case c.OPS.setFont:this.setFont(C);break;case c.OPS.showText:this.showText(C[0]);break;case c.OPS.showSpacedText:this.showText(C[0]);break;case c.OPS.endText:this.endText();break;case c.OPS.moveText:this.moveText(C[0],C[1]);break;case c.OPS.setCharSpacing:this.setCharSpacing(C[0]);break;case c.OPS.setWordSpacing:this.setWordSpacing(C[0]);break;case c.OPS.setHScale:this.setHScale(C[0]);break;case c.OPS.setTextMatrix:this.setTextMatrix(C[0],C[1],C[2],C[3],C[4],C[5]);break;case c.OPS.setTextRise:this.setTextRise(C[0]);break;case c.OPS.setTextRenderingMode:this.setTextRenderingMode(C[0]);break;case c.OPS.setLineWidth:this.setLineWidth(C[0]);break;case c.OPS.setLineJoin:this.setLineJoin(C[0]);break;case c.OPS.setLineCap:this.setLineCap(C[0]);break;case c.OPS.setMiterLimit:this.setMiterLimit(C[0]);break;case c.OPS.setFillRGBColor:this.setFillRGBColor(C[0],C[1],C[2]);break;case c.OPS.setStrokeRGBColor:this.setStrokeRGBColor(C[0],C[1],C[2]);break;case c.OPS.setStrokeColorN:this.setStrokeColorN(C);break;case c.OPS.setFillColorN:this.setFillColorN(C);break;case c.OPS.shadingFill:this.shadingFill(C[0]);break;case c.OPS.setDash:this.setDash(C[0],C[1]);break;case c.OPS.setRenderingIntent:this.setRenderingIntent(C[0]);break;case c.OPS.setFlatness:this.setFlatness(C[0]);break;case c.OPS.setGState:this.setGState(C[0]);break;case c.OPS.fill:this.fill();break;case c.OPS.eoFill:this.eoFill();break;case c.OPS.stroke:this.stroke();break;case c.OPS.fillStroke:this.fillStroke();break;case c.OPS.eoFillStroke:this.eoFillStroke();break;case c.OPS.clip:this.clip("nonzero");break;case c.OPS.eoClip:this.clip("evenodd");break;case c.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case c.OPS.paintImageXObject:this.paintImageXObject(C[0]);break;case c.OPS.paintInlineImageXObject:this.paintInlineImageXObject(C[0]);break;case c.OPS.paintImageMaskXObject:this.paintImageMaskXObject(C[0]);break;case c.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(C[0],C[1]);break;case c.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case c.OPS.closePath:this.closePath();break;case c.OPS.closeStroke:this.closeStroke();break;case c.OPS.closeFillStroke:this.closeFillStroke();break;case c.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case c.OPS.nextLine:this.nextLine();break;case c.OPS.transform:this.transform(C[0],C[1],C[2],C[3],C[4],C[5]);break;case c.OPS.constructPath:this.constructPath(C[0],C[1]);break;case c.OPS.endPath:this.endPath();break;case 92:this.group(o.items);break;default:(0,c.warn)(`Unimplemented operator ${n}`);break}}}setWordSpacing(a){this.current.wordSpacing=a}setCharSpacing(a){this.current.charSpacing=a}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,o,n,x,C,z){const G=this.current;G.textMatrix=G.lineMatrix=[a,o,n,x,C,z],G.textMatrixScale=Math.hypot(a,o),G.x=G.lineX=0,G.y=G.lineY=0,G.xcoords=[],G.ycoords=[],G.tspan=this.svgFactory.createElement("svg:tspan"),G.tspan.setAttributeNS(null,"font-family",G.fontFamily),G.tspan.setAttributeNS(null,"font-size",`${l(G.fontSize)}px`),G.tspan.setAttributeNS(null,"y",l(-G.y)),G.txtElement=this.svgFactory.createElement("svg:text"),G.txtElement.append(G.tspan)}beginText(){const a=this.current;a.x=a.lineX=0,a.y=a.lineY=0,a.textMatrix=c.IDENTITY_MATRIX,a.lineMatrix=c.IDENTITY_MATRIX,a.textMatrixScale=1,a.tspan=this.svgFactory.createElement("svg:tspan"),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtgrp=this.svgFactory.createElement("svg:g"),a.xcoords=[],a.ycoords=[]}moveText(a,o){const n=this.current;n.x=n.lineX+=a,n.y=n.lineY+=o,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${l(n.fontSize)}px`),n.tspan.setAttributeNS(null,"y",l(-n.y))}showText(a){const o=this.current,n=o.font,x=o.fontSize;if(x===0)return;const C=o.fontSizeScale,z=o.charSpacing,G=o.wordSpacing,oe=o.fontDirection,le=o.textHScale*oe,se=n.vertical,ne=se?1:-1,X=n.defaultVMetrics,J=x*o.fontMatrix[0];let Q=0;for(const ge of a){if(ge===null){Q+=oe*G;continue}else if(typeof ge=="number"){Q+=ne*ge*x/1e3;continue}const V=(ge.isSpace?G:0)+z,f=ge.fontChar;let d,I,q=ge.width;if(se){let H;const i=ge.vmetric||X;H=ge.vmetric?i[1]:q*.5,H=-H*J;const g=i[2]*J;q=i?-i[0]:q,d=H/C,I=(Q+g)/C}else d=Q/C,I=0;(ge.isInFont||n.missingFile)&&(o.xcoords.push(o.x+d),se&&o.ycoords.push(-o.y+I),o.tspan.textContent+=f);let $;se?$=q*J-V*oe:$=q*J+V*oe,Q+=$}o.tspan.setAttributeNS(null,"x",o.xcoords.map(l).join(" ")),se?o.tspan.setAttributeNS(null,"y",o.ycoords.map(l).join(" ")):o.tspan.setAttributeNS(null,"y",l(-o.y)),se?o.y-=Q:o.x+=Q*le,o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${l(o.fontSize)}px`),o.fontStyle!==F.fontStyle&&o.tspan.setAttributeNS(null,"font-style",o.fontStyle),o.fontWeight!==F.fontWeight&&o.tspan.setAttributeNS(null,"font-weight",o.fontWeight);const ie=o.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;if(ie===c.TextRenderingMode.FILL||ie===c.TextRenderingMode.FILL_STROKE?(o.fillColor!==F.fillColor&&o.tspan.setAttributeNS(null,"fill",o.fillColor),o.fillAlpha<1&&o.tspan.setAttributeNS(null,"fill-opacity",o.fillAlpha)):o.textRenderingMode===c.TextRenderingMode.ADD_TO_PATH?o.tspan.setAttributeNS(null,"fill","transparent"):o.tspan.setAttributeNS(null,"fill","none"),ie===c.TextRenderingMode.STROKE||ie===c.TextRenderingMode.FILL_STROKE){const ge=1/(o.textMatrixScale||1);this._setStrokeAttributes(o.tspan,ge)}let de=o.textMatrix;o.textRise!==0&&(de=de.slice(),de[5]+=o.textRise),o.txtElement.setAttributeNS(null,"transform",`${u(de)} scale(${l(le)}, -1)`),o.txtElement.setAttributeNS(S,"xml:space","preserve"),o.txtElement.append(o.tspan),o.txtgrp.append(o.txtElement),this._ensureTransformGroup().append(o.txtElement)}setLeadingMoveText(a,o){this.setLeading(-o),this.moveText(a,o)}addFontStyle(a){if(!a.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const o=w(a.data,a.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${a.loadedName}"; src: url(${o}); }
`}setFont(a){const o=this.current,n=this.commonObjs.get(a[0]);let x=a[1];o.font=n,this.embedFonts&&!n.missingFile&&!this.embeddedFonts[n.loadedName]&&(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),o.fontMatrix=n.fontMatrix||c.FONT_IDENTITY_MATRIX;let C="normal";n.black?C="900":n.bold&&(C="bold");const z=n.italic?"italic":"normal";x<0?(x=-x,o.fontDirection=-1):o.fontDirection=1,o.fontSize=x,o.fontFamily=n.loadedName,o.fontWeight=C,o.fontStyle=z,o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"y",l(-o.y)),o.xcoords=[],o.ycoords=[]}endText(){var o;const a=this.current;a.textRenderingMode&c.TextRenderingMode.ADD_TO_PATH_FLAG&&((o=a.txtElement)!=null&&o.hasChildNodes())&&(a.element=a.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(a){a>0&&(this.current.lineWidth=a)}setLineCap(a){this.current.lineCap=R[a]}setLineJoin(a){this.current.lineJoin=N[a]}setMiterLimit(a){this.current.miterLimit=a}setStrokeAlpha(a){this.current.strokeAlpha=a}setStrokeRGBColor(a,o,n){this.current.strokeColor=c.Util.makeHexColor(a,o,n)}setFillAlpha(a){this.current.fillAlpha=a}setFillRGBColor(a,o,n){this.current.fillColor=c.Util.makeHexColor(a,o,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(a){this.current.strokeColor=this._makeColorN_Pattern(a)}setFillColorN(a){this.current.fillColor=this._makeColorN_Pattern(a)}shadingFill(a){const o=this.viewport.width,n=this.viewport.height,x=c.Util.inverseTransform(this.transformMatrix),C=c.Util.applyTransform([0,0],x),z=c.Util.applyTransform([0,n],x),G=c.Util.applyTransform([o,0],x),oe=c.Util.applyTransform([o,n],x),le=Math.min(C[0],z[0],G[0],oe[0]),se=Math.min(C[1],z[1],G[1],oe[1]),ne=Math.max(C[0],z[0],G[0],oe[0]),X=Math.max(C[1],z[1],G[1],oe[1]),J=this.svgFactory.createElement("svg:rect");J.setAttributeNS(null,"x",le),J.setAttributeNS(null,"y",se),J.setAttributeNS(null,"width",ne-le),J.setAttributeNS(null,"height",X-se),J.setAttributeNS(null,"fill",this._makeShadingPattern(a)),this.current.fillAlpha<1&&J.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(J)}_makeColorN_Pattern(a){return a[0]==="TilingPattern"?this._makeTilingPattern(a):this._makeShadingPattern(a)}_makeTilingPattern(a){const o=a[1],n=a[2],x=a[3]||c.IDENTITY_MATRIX,[C,z,G,oe]=a[4],le=a[5],se=a[6],ne=a[7],X=`shading${p++}`,[J,Q,ie,de]=c.Util.normalizeRect([...c.Util.applyTransform([C,z],x),...c.Util.applyTransform([G,oe],x)]),[ge,V]=c.Util.singularValueDecompose2dScale(x),f=le*ge,d=se*V,I=this.svgFactory.createElement("svg:pattern");I.setAttributeNS(null,"id",X),I.setAttributeNS(null,"patternUnits","userSpaceOnUse"),I.setAttributeNS(null,"width",f),I.setAttributeNS(null,"height",d),I.setAttributeNS(null,"x",`${J}`),I.setAttributeNS(null,"y",`${Q}`);const q=this.svg,$=this.transformMatrix,H=this.current.fillColor,i=this.current.strokeColor,g=this.svgFactory.create(ie-J,de-Q);if(this.svg=g,this.transformMatrix=x,ne===2){const E=c.Util.makeHexColor(...o);this.current.fillColor=E,this.current.strokeColor=E}return this.executeOpTree(this.convertOpList(n)),this.svg=q,this.transformMatrix=$,this.current.fillColor=H,this.current.strokeColor=i,I.append(g.childNodes[0]),this.defs.append(I),`url(#${X})`}_makeShadingPattern(a){switch(typeof a=="string"&&(a=this.objs.get(a)),a[0]){case"RadialAxial":const o=`shading${p++}`,n=a[3];let x;switch(a[1]){case"axial":const C=a[4],z=a[5];x=this.svgFactory.createElement("svg:linearGradient"),x.setAttributeNS(null,"id",o),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"x1",C[0]),x.setAttributeNS(null,"y1",C[1]),x.setAttributeNS(null,"x2",z[0]),x.setAttributeNS(null,"y2",z[1]);break;case"radial":const G=a[4],oe=a[5],le=a[6],se=a[7];x=this.svgFactory.createElement("svg:radialGradient"),x.setAttributeNS(null,"id",o),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"cx",oe[0]),x.setAttributeNS(null,"cy",oe[1]),x.setAttributeNS(null,"r",se),x.setAttributeNS(null,"fx",G[0]),x.setAttributeNS(null,"fy",G[1]),x.setAttributeNS(null,"fr",le);break;default:throw new Error(`Unknown RadialAxial type: ${a[1]}`)}for(const C of n){const z=this.svgFactory.createElement("svg:stop");z.setAttributeNS(null,"offset",C[0]),z.setAttributeNS(null,"stop-color",C[1]),x.append(z)}return this.defs.append(x),`url(#${o})`;case"Mesh":return(0,c.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${a[0]}`)}}setDash(a,o){this.current.dashArray=a,this.current.dashPhase=o}constructPath(a,o){const n=this.current;let x=n.x,C=n.y,z=[],G=0;for(const oe of a)switch(oe|0){case c.OPS.rectangle:x=o[G++],C=o[G++];const le=o[G++],se=o[G++],ne=x+le,X=C+se;z.push("M",l(x),l(C),"L",l(ne),l(C),"L",l(ne),l(X),"L",l(x),l(X),"Z");break;case c.OPS.moveTo:x=o[G++],C=o[G++],z.push("M",l(x),l(C));break;case c.OPS.lineTo:x=o[G++],C=o[G++],z.push("L",l(x),l(C));break;case c.OPS.curveTo:x=o[G+4],C=o[G+5],z.push("C",l(o[G]),l(o[G+1]),l(o[G+2]),l(o[G+3]),l(x),l(C)),G+=6;break;case c.OPS.curveTo2:z.push("C",l(x),l(C),l(o[G]),l(o[G+1]),l(o[G+2]),l(o[G+3])),x=o[G+2],C=o[G+3],G+=4;break;case c.OPS.curveTo3:x=o[G+2],C=o[G+3],z.push("C",l(o[G]),l(o[G+1]),l(x),l(C),l(x),l(C)),G+=4;break;case c.OPS.closePath:z.push("Z");break}z=z.join(" "),n.path&&a.length>0&&a[0]!==c.OPS.rectangle&&a[0]!==c.OPS.moveTo?z=n.path.getAttributeNS(null,"d")+z:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(n.path)),n.path.setAttributeNS(null,"d",z),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(x,C)}endPath(){const a=this.current;if(a.path=null,!this.pendingClip)return;if(!a.element){this.pendingClip=null;return}const o=`clippath${T++}`,n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",o),n.setAttributeNS(null,"transform",u(this.transformMatrix));const x=a.element.cloneNode(!0);if(this.pendingClip==="evenodd"?x.setAttributeNS(null,"clip-rule","evenodd"):x.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.append(x),this.defs.append(n),a.activeClipUrl){a.clipGroup=null;for(const C of this.extraStack)C.clipGroup=null;n.setAttributeNS(null,"clip-path",a.activeClipUrl)}a.activeClipUrl=`url(#${o})`,this.tgrp=null}clip(a){this.pendingClip=a}closePath(){const a=this.current;if(a.path){const o=`${a.path.getAttributeNS(null,"d")}Z`;a.path.setAttributeNS(null,"d",o)}}setLeading(a){this.current.leading=-a}setTextRise(a){this.current.textRise=a}setTextRenderingMode(a){this.current.textRenderingMode=a}setHScale(a){this.current.textHScale=a/100}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(const[o,n]of a)switch(o){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,c.warn)(`Unimplemented graphic state operator ${o}`);break}}fill(){const a=this.current;a.element&&(a.element.setAttributeNS(null,"fill",a.fillColor),a.element.setAttributeNS(null,"fill-opacity",a.fillAlpha),this.endPath())}stroke(){const a=this.current;a.element&&(this._setStrokeAttributes(a.element),a.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(a,o=1){const n=this.current;let x=n.dashArray;o!==1&&x.length>0&&(x=x.map(function(C){return o*C})),a.setAttributeNS(null,"stroke",n.strokeColor),a.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),a.setAttributeNS(null,"stroke-miterlimit",l(n.miterLimit)),a.setAttributeNS(null,"stroke-linecap",n.lineCap),a.setAttributeNS(null,"stroke-linejoin",n.lineJoin),a.setAttributeNS(null,"stroke-width",l(o*n.lineWidth)+"px"),a.setAttributeNS(null,"stroke-dasharray",x.map(l).join(" ")),a.setAttributeNS(null,"stroke-dashoffset",l(o*n.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width","1px"),a.setAttributeNS(null,"height","1px"),a.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(a)}paintImageXObject(a){const o=a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a);if(!o){(0,c.warn)(`Dependent image with object ID ${a} is not ready yet`);return}this.paintInlineImageXObject(o)}paintInlineImageXObject(a,o){const n=a.width,x=a.height,C=P(a,this.forceDataSchema,!!o),z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",l(n)),z.setAttributeNS(null,"height",l(x)),this.current.element=z,this.clip("nonzero");const G=this.svgFactory.createElement("svg:image");G.setAttributeNS(m,"xlink:href",C),G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y",l(-x)),G.setAttributeNS(null,"width",l(n)+"px"),G.setAttributeNS(null,"height",l(x)+"px"),G.setAttributeNS(null,"transform",`scale(${l(1/n)} ${l(-1/x)})`),o?o.append(G):this._ensureTransformGroup().append(G)}paintImageMaskXObject(a){const o=this.current,n=a.width,x=a.height,C=o.fillColor;o.maskId=`mask${_++}`;const z=this.svgFactory.createElement("svg:mask");z.setAttributeNS(null,"id",o.maskId);const G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",l(n)),G.setAttributeNS(null,"height",l(x)),G.setAttributeNS(null,"fill",C),G.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(z),this._ensureTransformGroup().append(G),this.paintInlineImageXObject(a,z)}paintFormXObjectBegin(a,o){if(Array.isArray(a)&&a.length===6&&this.transform(a[0],a[1],a[2],a[3],a[4],a[5]),o){const n=o[2]-o[0],x=o[3]-o[1],C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x",o[0]),C.setAttributeNS(null,"y",o[1]),C.setAttributeNS(null,"width",l(n)),C.setAttributeNS(null,"height",l(x)),this.current.element=C,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(a){const o=this.svgFactory.create(a.width,a.height),n=this.svgFactory.createElement("svg:defs");o.append(n),this.defs=n;const x=this.svgFactory.createElement("svg:g");return x.setAttributeNS(null,"transform",u(a.transform)),o.append(x),this.svg=x,o}_ensureClipGroup(){if(!this.current.clipGroup){const a=this.svgFactory.createElement("svg:g");a.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(a),this.current.clipGroup=a}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",u(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFNodeStream=void 0;var e=b(1),c=b(33);const O=require$$5,L=require$$5,F=require$$5,S=require$$5,m=/^file:\/\/\/[a-zA-Z]:\//;function R(_){const p=S.parse(_);return p.protocol==="file:"||p.host?p:/^[a-z]:[/\\]/i.test(_)?S.parse(`file:///${_}`):(p.host||(p.protocol="file:"),p)}class N{constructor(p){this.source=p,this.url=R(p.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p;return((p=this._fullRequestReader)==null?void 0:p._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new u(this):new t(this),this._fullRequestReader}getRangeReader(p,a){if(a<=this._progressiveDataLength)return null;const o=this.isFsUrl?new T(this,p,a):new l(this,p,a);return this._rangeRequestReaders.push(o),o}cancelAllRequests(p){this._fullRequestReader&&this._fullRequestReader.cancel(p);for(const a of this._rangeRequestReaders.slice(0))a.cancel(p)}}s.PDFNodeStream=N;class w{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null;const a=p.source;this._contentLength=a.length,this._loaded=0,this._filename=null,this._disableRange=a.disableRange||!1,this._rangeChunkSize=a.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!a.disableStream,this._isRangeSupported=!a.disableRange,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)(),this._headersCapability=(0,e.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=p.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",a=>{this._error(a)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P{constructor(p){this._url=p.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)();const a=p.source;this._isStreamingSupported=!a.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const p=this._readableStream.read();return p===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=p.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(p).buffer,done:!1})}cancel(p){if(!this._readableStream){this._error(p);return}this._readableStream.destroy(p)}_error(p){this._storedError=p,this._readCapability.resolve()}_setReadableStream(p){this._readableStream=p,p.on("readable",()=>{this._readCapability.resolve()}),p.on("end",()=>{p.destroy(),this._done=!0,this._readCapability.resolve()}),p.on("error",a=>{this._error(a)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function h(_,p){return{protocol:_.protocol,auth:_.auth,host:_.hostname,port:_.port,path:_.path,method:"GET",headers:p}}class t extends w{constructor(p){super(p);const a=o=>{if(o.statusCode===404){const z=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=z,this._headersCapability.reject(z);return}this._headersCapability.resolve(),this._setReadableStream(o);const n=z=>this._readableStream.headers[z.toLowerCase()],{allowRangeRequests:x,suggestedLength:C}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:p.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=x,this._contentLength=C||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(n)};this._request=null,this._url.protocol==="http:"?this._request=L.request(h(this._url,p.httpHeaders),a):this._request=F.request(h(this._url,p.httpHeaders),a),this._request.on("error",o=>{this._storedError=o,this._headersCapability.reject(o)}),this._request.end()}}class l extends P{constructor(p,a,o){super(p),this._httpHeaders={};for(const x in p.httpHeaders){const C=p.httpHeaders[x];typeof C>"u"||(this._httpHeaders[x]=C)}this._httpHeaders.Range=`bytes=${a}-${o-1}`;const n=x=>{if(x.statusCode===404){const C=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=C;return}this._setReadableStream(x)};this._request=null,this._url.protocol==="http:"?this._request=L.request(h(this._url,this._httpHeaders),n):this._request=F.request(h(this._url,this._httpHeaders),n),this._request.on("error",x=>{this._storedError=x}),this._request.end()}}class u extends w{constructor(p){super(p);let a=decodeURIComponent(this._url.path);m.test(this._url.href)&&(a=a.replace(/^\//,"")),O.lstat(a,(o,n)=>{if(o){o.code==="ENOENT"&&(o=new e.MissingPDFException(`Missing PDF "${a}".`)),this._storedError=o,this._headersCapability.reject(o);return}this._contentLength=n.size,this._setReadableStream(O.createReadStream(a)),this._headersCapability.resolve()})}}class T extends P{constructor(p,a,o){super(p);let n=decodeURIComponent(this._url.path);m.test(this._url.href)&&(n=n.replace(/^\//,"")),this._setReadableStream(O.createReadStream(n,{start:a,end:o-1}))}}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createResponseStatusError=S,s.extractFilenameFromHeader=F,s.validateRangeRequestCapabilities=L,s.validateResponseStatus=m;var e=b(1),c=b(34),O=b(8);function L({getResponseHeader:R,isHttp:N,rangeChunkSize:w,disableRange:P}){const h={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(R("Content-Length"),10);return!Number.isInteger(t)||(h.suggestedLength=t,t<=2*w)||P||!N||R("Accept-Ranges")!=="bytes"||(R("Content-Encoding")||"identity")!=="identity"||(h.allowRangeRequests=!0),h}function F(R){const N=R("Content-Disposition");if(N){let w=(0,c.getFilenameFromContentDispositionHeader)(N);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,O.isPdfFile)(w))return w}return null}function S(R,N){return R===404||R===0&&N.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+N+'".'):new e.UnexpectedResponseException(`Unexpected server response (${R}) while retrieving PDF "${N}".`,R)}function m(R){return R===200||R===206}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getFilenameFromContentDispositionHeader=c;var e=b(1);function c(O){let L=!0,F=S("filename\\*","i").exec(O);if(F){F=F[1];let t=w(F);return t=unescape(t),t=P(t),t=h(t),R(t)}if(F=N(O),F){const t=h(F);return R(t)}if(F=S("filename","i").exec(O),F){F=F[1];let t=w(F);return t=h(t),R(t)}function S(t,l){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',l)}function m(t,l){if(t){if(!/^[\x00-\xFF]+$/.test(l))return l;try{const u=new TextDecoder(t,{fatal:!0}),T=(0,e.stringToBytes)(l);l=u.decode(T),L=!1}catch{}}return l}function R(t){return L&&/[\x80-\xff]/.test(t)&&(t=m("utf-8",t),L&&(t=m("iso-8859-1",t))),t}function N(t){const l=[];let u;const T=S("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=T.exec(t))!==null;){let[,p,a,o]=u;if(p=parseInt(p,10),p in l){if(p===0)break;continue}l[p]=[a,o]}const _=[];for(let p=0;p<l.length&&p in l;++p){let[a,o]=l[p];o=w(o),a&&(o=unescape(o),p===0&&(o=P(o))),_.push(o)}return _.join("")}function w(t){if(t.startsWith('"')){const l=t.slice(1).split('\\"');for(let u=0;u<l.length;++u){const T=l[u].indexOf('"');T!==-1&&(l[u]=l[u].slice(0,T),l.length=u+1),l[u]=l[u].replace(/\\(.)/g,"$1")}t=l.join('"')}return t}function P(t){const l=t.indexOf("'");if(l===-1)return t;const u=t.slice(0,l),_=t.slice(l+1).replace(/^[^']*'/,"");return m(u,_)}function h(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(l,u,T,_){if(T==="q"||T==="Q")return _=_.replace(/_/g," "),_=_.replace(/=([0-9a-fA-F]{2})/g,function(p,a){return String.fromCharCode(parseInt(a,16))}),m(u,_);try{_=atob(_)}catch{}return m(u,_)})}return""}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFNetworkStream=void 0;var e=b(1),c=b(33);const O=200,L=206;function F(w){const P=w.response;return typeof P!="string"?P:(0,e.stringToBytes)(P).buffer}class S{constructor(P,h={}){this.url=P,this.isHttp=/^https?:/i.test(P),this.httpHeaders=this.isHttp&&h.httpHeaders||Object.create(null),this.withCredentials=h.withCredentials||!1,this.getXhr=h.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(P,h,t){const l={begin:P,end:h};for(const u in t)l[u]=t[u];return this.request(l)}requestFull(P){return this.request(P)}request(P){const h=this.getXhr(),t=this.currXhrId++,l=this.pendingRequests[t]={xhr:h};h.open("GET",this.url),h.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const T=this.httpHeaders[u];typeof T>"u"||h.setRequestHeader(u,T)}return this.isHttp&&"begin"in P&&"end"in P?(h.setRequestHeader("Range",`bytes=${P.begin}-${P.end-1}`),l.expectedStatus=L):l.expectedStatus=O,h.responseType="arraybuffer",P.onError&&(h.onerror=function(u){P.onError(h.status)}),h.onreadystatechange=this.onStateChange.bind(this,t),h.onprogress=this.onProgress.bind(this,t),l.onHeadersReceived=P.onHeadersReceived,l.onDone=P.onDone,l.onError=P.onError,l.onProgress=P.onProgress,h.send(null),t}onProgress(P,h){var l;const t=this.pendingRequests[P];t&&((l=t.onProgress)==null||l.call(t,h))}onStateChange(P,h){var p,a,o;const t=this.pendingRequests[P];if(!t)return;const l=t.xhr;if(l.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),l.readyState!==4||!(P in this.pendingRequests))return;if(delete this.pendingRequests[P],l.status===0&&this.isHttp){(p=t.onError)==null||p.call(t,l.status);return}const u=l.status||O;if(!(u===O&&t.expectedStatus===L)&&u!==t.expectedStatus){(a=t.onError)==null||a.call(t,l.status);return}const _=F(l);if(u===L){const n=l.getResponseHeader("Content-Range"),x=/bytes (\d+)-(\d+)\/(\d+)/.exec(n);t.onDone({begin:parseInt(x[1],10),chunk:_})}else _?t.onDone({begin:0,chunk:_}):(o=t.onError)==null||o.call(t,l.status)}getRequestXhr(P){return this.pendingRequests[P].xhr}isPendingRequest(P){return P in this.pendingRequests}abortRequest(P){const h=this.pendingRequests[P].xhr;delete this.pendingRequests[P],h.abort()}}class m{constructor(P){this._source=P,this._manager=new S(P.url,{httpHeaders:P.httpHeaders,withCredentials:P.withCredentials}),this._rangeChunkSize=P.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(P){const h=this._rangeRequestReaders.indexOf(P);h>=0&&this._rangeRequestReaders.splice(h,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new R(this._manager,this._source),this._fullRequestReader}getRangeReader(P,h){const t=new N(this._manager,P,h);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(P){var h;(h=this._fullRequestReader)==null||h.cancel(P);for(const t of this._rangeRequestReaders.slice(0))t.cancel(P)}}s.PDFNetworkStream=m;class R{constructor(P,h){this._manager=P;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=h.url,this._fullRequestId=P.requestFull(t),this._headersReceivedCapability=(0,e.createPromiseCapability)(),this._disableRange=h.disableRange||!1,this._contentLength=h.length,this._rangeChunkSize=h.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const P=this._fullRequestId,h=this._manager.getRequestXhr(P),t=T=>h.getResponseHeader(T),{allowRangeRequests:l,suggestedLength:u}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(P),this._headersReceivedCapability.resolve()}_onDone(P){if(P&&(this._requests.length>0?this._requests.shift().resolve({value:P.chunk,done:!1}):this._cachedChunks.push(P.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(P){this._storedError=(0,c.createResponseStatusError)(P,this._url),this._headersReceivedCapability.reject(this._storedError);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(P){var h;(h=this.onProgress)==null||h.call(this,{loaded:P.loaded,total:P.lengthComputable?P.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=(0,e.createPromiseCapability)();return this._requests.push(P),P.promise}cancel(P){this._done=!0,this._headersReceivedCapability.reject(P);for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(P,h,t){this._manager=P;const l={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=P.url,this._requestId=P.requestRange(h,t,l),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var P;(P=this.onClosed)==null||P.call(this,this)}_onDone(P){const h=P.chunk;this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunk=h,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(P){this._storedError=(0,c.createResponseStatusError)(P,this._url);for(const h of this._requests)h.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(P){var h;this.isStreamingSupported||(h=this.onProgress)==null||h.call(this,{loaded:P.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const h=this._queuedChunk;return this._queuedChunk=null,{value:h,done:!1}}if(this._done)return{value:void 0,done:!0};const P=(0,e.createPromiseCapability)();return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(v,s,b)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PDFFetchStream=void 0;var e=b(1),c=b(33);function O(R,N,w){return{method:"GET",headers:R,signal:w.signal,mode:"cors",credentials:N?"include":"same-origin",redirect:"follow"}}function L(R){const N=new Headers;for(const w in R){const P=R[w];typeof P>"u"||N.append(w,P)}return N}class F{constructor(N){this.source=N,this.isHttp=/^https?:/i.test(N.url),this.httpHeaders=this.isHttp&&N.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var N;return((N=this._fullRequestReader)==null?void 0:N._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new S(this),this._fullRequestReader}getRangeReader(N,w){if(w<=this._progressiveDataLength)return null;const P=new m(this,N,w);return this._rangeRequestReaders.push(P),P}cancelAllRequests(N){this._fullRequestReader&&this._fullRequestReader.cancel(N);for(const w of this._rangeRequestReaders.slice(0))w.cancel(N)}}s.PDFFetchStream=F;class S{constructor(N){this._stream=N,this._reader=null,this._loaded=0,this._filename=null;const w=N.source;this._withCredentials=w.withCredentials||!1,this._contentLength=w.length,this._headersCapability=(0,e.createPromiseCapability)(),this._disableRange=w.disableRange||!1,this._rangeChunkSize=w.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!w.disableStream,this._isRangeSupported=!w.disableRange,this._headers=L(this._stream.httpHeaders);const P=w.url;fetch(P,O(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,c.validateResponseStatus)(h.status))throw(0,c.createResponseStatusError)(h.status,P);this._reader=h.body.getReader(),this._headersCapability.resolve();const t=T=>h.headers.get(T),{allowRangeRequests:l,suggestedLength:u}=(0,c.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=(0,c.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:N,done:w}=await this._reader.read();return w?{value:N,done:w}:(this._loaded+=N.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){this._reader&&this._reader.cancel(N),this._abortController.abort()}}class m{constructor(N,w,P){this._stream=N,this._reader=null,this._loaded=0;const h=N.source;this._withCredentials=h.withCredentials||!1,this._readCapability=(0,e.createPromiseCapability)(),this._isStreamingSupported=!h.disableStream,this._abortController=new AbortController,this._headers=L(this._stream.httpHeaders),this._headers.append("Range",`bytes=${w}-${P-1}`);const t=h.url;fetch(t,O(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,c.validateResponseStatus)(l.status))throw(0,c.createResponseStatusError)(l.status,t);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:N,done:w}=await this._reader.read();return w?{value:N,done:w}:(this._loaded+=N.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(N).buffer,done:!1})}cancel(N){this._reader&&this._reader.cancel(N),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(v){var s=__webpack_module_cache__[v];if(s!==void 0)return s.exports;var b=__webpack_module_cache__[v]={exports:{}};return __webpack_modules__[v](b,b.exports,__w_pdfjs_require__),b.exports}var __webpack_exports__={};return(()=>{var v=__webpack_exports__;Object.defineProperty(v,"__esModule",{value:!0}),Object.defineProperty(v,"AnnotationEditorLayer",{enumerable:!0,get:function(){return c.AnnotationEditorLayer}}),Object.defineProperty(v,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return s.AnnotationEditorParamsType}}),Object.defineProperty(v,"AnnotationEditorType",{enumerable:!0,get:function(){return s.AnnotationEditorType}}),Object.defineProperty(v,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return O.AnnotationEditorUIManager}}),Object.defineProperty(v,"AnnotationLayer",{enumerable:!0,get:function(){return L.AnnotationLayer}}),Object.defineProperty(v,"AnnotationMode",{enumerable:!0,get:function(){return s.AnnotationMode}}),Object.defineProperty(v,"CMapCompressionType",{enumerable:!0,get:function(){return s.CMapCompressionType}}),Object.defineProperty(v,"GlobalWorkerOptions",{enumerable:!0,get:function(){return F.GlobalWorkerOptions}}),Object.defineProperty(v,"InvalidPDFException",{enumerable:!0,get:function(){return s.InvalidPDFException}}),Object.defineProperty(v,"LoopbackPort",{enumerable:!0,get:function(){return b.LoopbackPort}}),Object.defineProperty(v,"MissingPDFException",{enumerable:!0,get:function(){return s.MissingPDFException}}),Object.defineProperty(v,"OPS",{enumerable:!0,get:function(){return s.OPS}}),Object.defineProperty(v,"PDFDataRangeTransport",{enumerable:!0,get:function(){return b.PDFDataRangeTransport}}),Object.defineProperty(v,"PDFDateString",{enumerable:!0,get:function(){return e.PDFDateString}}),Object.defineProperty(v,"PDFWorker",{enumerable:!0,get:function(){return b.PDFWorker}}),Object.defineProperty(v,"PasswordResponses",{enumerable:!0,get:function(){return s.PasswordResponses}}),Object.defineProperty(v,"PermissionFlag",{enumerable:!0,get:function(){return s.PermissionFlag}}),Object.defineProperty(v,"PixelsPerInch",{enumerable:!0,get:function(){return e.PixelsPerInch}}),Object.defineProperty(v,"RenderingCancelledException",{enumerable:!0,get:function(){return e.RenderingCancelledException}}),Object.defineProperty(v,"SVGGraphics",{enumerable:!0,get:function(){return R.SVGGraphics}}),Object.defineProperty(v,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return s.UNSUPPORTED_FEATURES}}),Object.defineProperty(v,"UnexpectedResponseException",{enumerable:!0,get:function(){return s.UnexpectedResponseException}}),Object.defineProperty(v,"Util",{enumerable:!0,get:function(){return s.Util}}),Object.defineProperty(v,"VerbosityLevel",{enumerable:!0,get:function(){return s.VerbosityLevel}}),Object.defineProperty(v,"XfaLayer",{enumerable:!0,get:function(){return N.XfaLayer}}),Object.defineProperty(v,"build",{enumerable:!0,get:function(){return b.build}}),Object.defineProperty(v,"createPromiseCapability",{enumerable:!0,get:function(){return s.createPromiseCapability}}),Object.defineProperty(v,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return s.createValidAbsoluteUrl}}),Object.defineProperty(v,"getDocument",{enumerable:!0,get:function(){return b.getDocument}}),Object.defineProperty(v,"getFilenameFromUrl",{enumerable:!0,get:function(){return e.getFilenameFromUrl}}),Object.defineProperty(v,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return e.getPdfFilenameFromUrl}}),Object.defineProperty(v,"getXfaPageViewport",{enumerable:!0,get:function(){return e.getXfaPageViewport}}),Object.defineProperty(v,"isPdfFile",{enumerable:!0,get:function(){return e.isPdfFile}}),Object.defineProperty(v,"loadScript",{enumerable:!0,get:function(){return e.loadScript}}),Object.defineProperty(v,"renderTextLayer",{enumerable:!0,get:function(){return m.renderTextLayer}}),Object.defineProperty(v,"shadow",{enumerable:!0,get:function(){return s.shadow}}),Object.defineProperty(v,"version",{enumerable:!0,get:function(){return b.version}});var s=__w_pdfjs_require__(1),b=__w_pdfjs_require__(4),e=__w_pdfjs_require__(8),c=__w_pdfjs_require__(22),O=__w_pdfjs_require__(7),L=__w_pdfjs_require__(27),F=__w_pdfjs_require__(15),S=__w_pdfjs_require__(3),m=__w_pdfjs_require__(30),R=__w_pdfjs_require__(31),N=__w_pdfjs_require__(29);if(S.isNodeJS){const{PDFNodeStream:w}=__w_pdfjs_require__(32);(0,b.setPDFNetworkStreamFactory)(P=>new w(P))}else{const{PDFNetworkStream:w}=__w_pdfjs_require__(35),{PDFFetchStream:P}=__w_pdfjs_require__(36);(0,b.setPDFNetworkStreamFactory)(h=>(0,e.isValidFetchUrl)(h.url)?new P(h):new w(h))}})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();function _objectWithoutProperties(v,s){if(v==null)return{};var b,e,c=_objectWithoutPropertiesLoose(v,s);if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(v);for(e=0;e<O.length;e++)b=O[e],s.indexOf(b)===-1&&{}.propertyIsEnumerable.call(v,b)&&(c[b]=v[b])}return c}function _typeof(v){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},_typeof(v)}function _classCallCheck(v,s){if(!(v instanceof s))throw new TypeError("Cannot call a class as a function")}function toPrimitive(v,s){if(_typeof(v)!="object"||!v)return v;var b=v[Symbol.toPrimitive];if(b!==void 0){var e=b.call(v,s);if(_typeof(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(v)}function toPropertyKey(v){var s=toPrimitive(v,"string");return _typeof(s)=="symbol"?s:s+""}function _defineProperties(v,s){for(var b=0;b<s.length;b++){var e=s[b];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(v,toPropertyKey(e.key),e)}}function _createClass(v,s,b){return s&&_defineProperties(v.prototype,s),Object.defineProperty(v,"prototype",{writable:!1}),v}function _inherits(v,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(s&&s.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),Object.defineProperty(v,"prototype",{writable:!1}),s&&_setPrototypeOf(v,s)}function _possibleConstructorReturn(v,s){if(s&&(_typeof(s)=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(v)}function _getPrototypeOf(v){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},_getPrototypeOf(v)}function _defineProperty(v,s,b){return(s=toPropertyKey(s))in v?Object.defineProperty(v,s,{value:b,enumerable:!0,configurable:!0,writable:!0}):v[s]=b,v}var __spreadArray=function(v,s,b){if(b||arguments.length===2)for(var e=0,c=s.length,O;e<c;e++)(O||!(e in s))&&(O||(O=Array.prototype.slice.call(s,0,e)),O[e]=s[e]);return v.concat(O||Array.prototype.slice.call(s))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(v,s){var b={};return allEvents.forEach(function(e){var c=v[e];c&&(s?b[e]=function(O){return c(O,s(e))}:b[e]=c)}),b}function makeCancellablePromise(v){var s=!1,b=new Promise(function(e,c){v.then(function(O){return!s&&e(O)}).catch(function(O){return!s&&c(O)})});return{promise:b,cancel:function(){s=!0}}}function r(v){var s,b,e="";if(typeof v=="string"||typeof v=="number")e+=v;else if(typeof v=="object")if(Array.isArray(v))for(s=0;s<v.length;s++)v[s]&&(b=r(v[s]))&&(e&&(e+=" "),e+=b);else for(s in v)v[s]&&(e&&(e+=" "),e+=s);return e}function clsx(){for(var v,s,b=0,e="";b<arguments.length;)(v=arguments[b++])&&(s=r(v))&&(e&&(e+=" "),e+=s);return e}function warning(v,s){}const DocumentContext=reactExports.createContext(null);function Message(v){var s=v.children,b=v.type;return U.createElement("div",{className:"react-pdf__message react-pdf__message--".concat(b)},s)}Message.propTypes={children:PropTypes.node,type:PropTypes.oneOf(["error","loading","no-data"]).isRequired};var DEFAULT_LINK_REL="noopener noreferrer nofollow",LinkService=function(){function v(){_classCallCheck(this,v),this.externalLinkTarget=null,this.externalLinkRel=null}return _createClass(v,[{key:"setDocument",value:function(b){this.pdfDocument=b}},{key:"setViewer",value:function(b){this.pdfViewer=b}},{key:"setExternalLinkRel",value:function(b){this.externalLinkRel=b}},{key:"setExternalLinkTarget",value:function(b){this.externalLinkTarget=b}},{key:"setHistory",value:function(){}},{key:"pagesCount",get:function(){return this.pdfDocument?this.pdfDocument.numPages:0}},{key:"page",get:function(){return this.pdfViewer.currentPageNumber},set:function(b){this.pdfViewer.currentPageNumber=b}},{key:"rotation",get:function(){return 0},set:function(b){}},{key:"goToDestination",value:function(b){var e=this;new Promise(function(c){typeof b=="string"?e.pdfDocument.getDestination(b).then(c):Array.isArray(b)?c(b):b.then(c)}).then(function(c){invariant(Array.isArray(c));var O=c[0];new Promise(function(L){O instanceof Object?e.pdfDocument.getPageIndex(O).then(function(F){L(F)}).catch(function(){invariant(!1)}):typeof O=="number"?L(O):invariant(!1)}).then(function(L){var F=L+1;invariant(F>=1&&F<=e.pagesCount),e.pdfViewer.scrollPageIntoView({dest:b,pageIndex:L,pageNumber:F})})})}},{key:"navigateTo",value:function(b){this.goToDestination(b)}},{key:"goToPage",value:function(){}},{key:"addLinkAttributes",value:function(b,e,c){b.href=e,b.rel=this.externalLinkRel||DEFAULT_LINK_REL,b.target=c?"_blank":this.externalLinkTarget||""}},{key:"getDestinationHash",value:function(){return"#"}},{key:"getAnchorUrl",value:function(){return"#"}},{key:"setHash",value:function(){}},{key:"executeNamedAction",value:function(){}},{key:"cachePageRef",value:function(){}},{key:"isPageVisible",value:function(){return!0}},{key:"isPageCached",value:function(){return!0}}]),v}(),PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function _arrayWithHoles(v){if(Array.isArray(v))return v}function _iterableToArrayLimit(v,s){var b=v==null?null:typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(b!=null){var e,c,O,L,F=[],S=!0,m=!1;try{if(O=(b=b.call(v)).next,s!==0)for(;!(S=(e=O.call(b)).done)&&(F.push(e.value),F.length!==s);S=!0);}catch(R){m=!0,c=R}finally{try{if(!S&&b.return!=null&&(L=b.return(),Object(L)!==L))return}finally{if(m)throw c}}return F}}function _arrayLikeToArray(v,s){(s==null||s>v.length)&&(s=v.length);for(var b=0,e=Array(s);b<s;b++)e[b]=v[b];return e}function _unsupportedIterableToArray(v,s){if(v){if(typeof v=="string")return _arrayLikeToArray(v,s);var b={}.toString.call(v).slice(8,-1);return b==="Object"&&v.constructor&&(b=v.constructor.name),b==="Map"||b==="Set"?Array.from(v):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?_arrayLikeToArray(v,s):void 0}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(v,s){return _arrayWithHoles(v)||_iterableToArrayLimit(v,s)||_unsupportedIterableToArray(v,s)||_nonIterableRest()}var isBrowser=typeof document<"u";function isDefined(v){return typeof v<"u"}function isProvided(v){return isDefined(v)&&v!==null}function isString(v){return typeof v=="string"}function isArrayBuffer(v){return v instanceof ArrayBuffer}function isBlob(v){return invariant(isBrowser),v instanceof Blob}function isFile$1(v){return invariant(isBrowser),v instanceof File}function isDataURI(v){return isString(v)&&/^data:/.test(v)}function dataURItoByteString(v){invariant(isDataURI(v));var s=v.split(","),b=_slicedToArray(s,2),e=b[0],c=b[1],O=e.split(";");return O.indexOf("base64")!==-1?atob(c):unescape(c)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}function cancelRunningTask(v){v&&v.cancel&&v.cancel()}function makePageCallback(v,s){return Object.defineProperty(v,"width",{get:function(){return this.view[2]*s},configurable:!0}),Object.defineProperty(v,"height",{get:function(){return this.view[3]*s},configurable:!0}),Object.defineProperty(v,"originalWidth",{get:function(){return this.view[2]},configurable:!0}),Object.defineProperty(v,"originalHeight",{get:function(){return this.view[3]},configurable:!0}),v}function isCancelException(v){return v.name==="RenderingCancelledException"}function loadFromFile(v){return new Promise(function(s,b){var e=new FileReader;return e.onload=function(){return s(new Uint8Array(e.result))},e.onerror=function(c){switch(c.target.error.code){case c.target.error.NOT_FOUND_ERR:return b(new Error("Error while reading a file: File not found."));case c.target.error.NOT_READABLE_ERR:return b(new Error("Error while reading a file: File not readable."));case c.target.error.SECURITY_ERR:return b(new Error("Error while reading a file: Security error."));case c.target.error.ABORT_ERR:return b(new Error("Error while reading a file: Aborted."));default:return b(new Error("Error while reading a file."))}},e.readAsArrayBuffer(v),null})}function _arrayWithoutHoles(v){if(Array.isArray(v))return _arrayLikeToArray(v)}function _iterableToArray(v){if(typeof Symbol<"u"&&v[Symbol.iterator]!=null||v["@@iterator"]!=null)return Array.from(v)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray(v){return _arrayWithoutHoles(v)||_iterableToArray(v)||_unsupportedIterableToArray(v)||_nonIterableSpread()}var eventProps=function(){var v={};return[].concat(_toConsumableArray(mouseEvents),_toConsumableArray(touchEvents),_toConsumableArray(keyboardEvents)).forEach(function(s){v[s]=PropTypes.func}),v}(),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.object,PropTypes.string]),httpHeaders:PropTypes.object,range:PropTypes.object,url:PropTypes.string,withCredentials:PropTypes.bool})];typeof File<"u"&&fileTypes.push(PropTypes.instanceOf(File));typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));var isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes),isLinkService=PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);var isPage=PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired}),isPageIndex=function v(s,b,e){var c=s[b],O=s.pageNumber,L=s.pdf;if(!isDefined(L))return null;if(isDefined(c)){if(typeof c!="number")return new Error("`".concat(b,"` of type `").concat(_typeof(c),"` supplied to `").concat(e,"`, expected `number`."));if(c<0)return new Error("Expected `".concat(b,"` to be greater or equal to 0."));var F=L.numPages;if(c+1>F)return new Error("Expected `".concat(b,"` to be less or equal to ").concat(F-1,"."))}else if(!isDefined(O))return new Error("`".concat(b,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(e,"`."));return null},isPageNumber=function v(s,b,e){var c=s[b],O=s.pageIndex,L=s.pdf;if(!isDefined(L))return null;if(isDefined(c)){if(typeof c!="number")return new Error("`".concat(b,"` of type `").concat(_typeof(c),"` supplied to `").concat(e,"`, expected `number`."));if(c<1)return new Error("Expected `".concat(b,"` to be greater or equal to 1."));var F=L.numPages;if(c>F)return new Error("Expected `".concat(b,"` to be less or equal to ").concat(F,"."))}else if(!isDefined(O))return new Error("`".concat(b,"` not supplied. Either pageIndex or pageNumber must be supplied to `").concat(e,"`."));return null},isPdf=PropTypes.oneOfType([PropTypes.shape({getDestination:PropTypes.func.isRequired,getOutline:PropTypes.func.isRequired,getPage:PropTypes.func.isRequired,numPages:PropTypes.number.isRequired}),PropTypes.bool]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.shape({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]),_excluded=["url"];function ownKeys$3(v,s){var b=Object.keys(v);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(v);s&&(e=e.filter(function(c){return Object.getOwnPropertyDescriptor(v,c).enumerable})),b.push.apply(b,e)}return b}function _objectSpread$3(v){for(var s=1;s<arguments.length;s++){var b=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$3(Object(b),!0).forEach(function(e){_defineProperty(v,e,b[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(b)):ownKeys$3(Object(b)).forEach(function(e){Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(b,e))})}return v}function _createSuper$5(v){var s=_isNativeReflectConstruct$5();return function(){var e=_getPrototypeOf(v),c;if(s){var O=_getPrototypeOf(this).constructor;c=Reflect.construct(e,arguments,O)}else c=e.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _isNativeReflectConstruct$5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PDFDataRangeTransport=pdfExports.PDFDataRangeTransport,Document=function(v){_inherits(b,v);var s=_createSuper$5(b);function b(){var e;_classCallCheck(this,b);for(var c=arguments.length,O=new Array(c),L=0;L<c;L++)O[L]=arguments[L];return e=s.call.apply(s,[this].concat(O)),_defineProperty(_assertThisInitialized(e),"state",{pdf:null}),_defineProperty(_assertThisInitialized(e),"viewer",{scrollPageIntoView:function(S){var m=S.dest,R=S.pageIndex,N=S.pageNumber,w=e.props.onItemClick;if(w){w({dest:m,pageIndex:R,pageNumber:N});return}var P=e.pages[R];if(P){P.scrollIntoView();return}}}),_defineProperty(_assertThisInitialized(e),"linkService",new LinkService),_defineProperty(_assertThisInitialized(e),"loadDocument",function(){cancelRunningTask(e.runningTask),e.loadingTask&&e.loadingTask.destroy();var F=makeCancellablePromise(e.findDocumentSource());e.runningTask=F,F.promise.then(function(S){if(e.onSourceSuccess(),!!S){e.setState(function(h){return h.pdf?{pdf:null}:null});var m=e.props,R=m.options,N=m.onLoadProgress,w=m.onPassword,P=pdfExports.getDocument(_objectSpread$3(_objectSpread$3({},S),R));P.onPassword=w,N&&(P.onProgress=N),e.loadingTask=P,P.promise.then(function(h){e.setState(function(t){return t.pdf&&t.pdf.fingerprint===h.fingerprint?null:{pdf:h}},e.onLoadSuccess)}).catch(function(h){e.onLoadError(h)})}}).catch(function(S){e.onSourceError(S)})}),_defineProperty(_assertThisInitialized(e),"setupLinkService",function(){var F=e.props,S=F.externalLinkRel,m=F.externalLinkTarget;e.linkService.setViewer(e.viewer),e.linkService.setExternalLinkRel(S),e.linkService.setExternalLinkTarget(m)}),_defineProperty(_assertThisInitialized(e),"onSourceSuccess",function(){var F=e.props.onSourceSuccess;F&&F()}),_defineProperty(_assertThisInitialized(e),"onSourceError",function(F){var S=e.props.onSourceError;S&&S(F)}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var F=e.props.onLoadSuccess,S=e.state.pdf;F&&F(S),e.pages=new Array(S.numPages),e.linkService.setDocument(S)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(F){e.setState({pdf:!1});var S=e.props.onLoadError;S&&S(F)}),_defineProperty(_assertThisInitialized(e),"findDocumentSource",function(){return new Promise(function(F){var S=e.props.file;if(S||F(null),typeof S=="string"){if(isDataURI(S)){var m=dataURItoByteString(S);F({data:m})}F({url:S})}if(S instanceof PDFDataRangeTransport&&F({range:S}),isArrayBuffer(S)&&F({data:S}),isBrowser&&(isBlob(S)||isFile$1(S))){loadFromFile(S).then(function(P){F({data:P})});return}if(invariant(_typeof(S)==="object"),invariant(S.url||S.data||S.range),typeof S.url=="string"&&isDataURI(S.url)){var R=S.url,N=_objectWithoutProperties(S,_excluded),w=dataURItoByteString(R);F(_objectSpread$3({data:w},N))}F(S)})}),_defineProperty(_assertThisInitialized(e),"registerPage",function(F,S){e.pages[F]=S}),_defineProperty(_assertThisInitialized(e),"unregisterPage",function(F){delete e.pages[F]}),e}return _createClass(b,[{key:"componentDidMount",value:function(){this.loadDocument(),this.setupLinkService()}},{key:"componentDidUpdate",value:function(c){var O=this.props.file;O!==c.file&&this.loadDocument()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask),this.loadingTask&&this.loadingTask.destroy()}},{key:"childContext",get:function(){var c=this.linkService,O=this.registerPage,L=this.unregisterPage,F=this.props,S=F.imageResourcesPath,m=F.renderMode,R=F.rotate,N=this.state.pdf;return{imageResourcesPath:S,linkService:c,pdf:N,registerPage:O,renderMode:m,rotate:R,unregisterPage:L}}},{key:"eventProps",get:function(){var c=this;return makeEventProps(this.props,function(){return c.state.pdf})}},{key:"renderChildren",value:function(){var c=this.props.children;return U.createElement(DocumentContext.Provider,{value:this.childContext},c)}},{key:"renderContent",value:function(){var c=this.props.file,O=this.state.pdf;if(!c){var L=this.props.noData;return U.createElement(Message,{type:"no-data"},typeof L=="function"?L():L)}if(O===null){var F=this.props.loading;return U.createElement(Message,{type:"loading"},typeof F=="function"?F():F)}if(O===!1){var S=this.props.error;return U.createElement(Message,{type:"error"},typeof S=="function"?S():S)}return this.renderChildren()}},{key:"render",value:function(){var c=this.props,O=c.className,L=c.inputRef;return U.createElement("div",_extends({className:clsx("react-pdf__Document",O),ref:L},this.eventProps),this.renderContent())}}]),b}(reactExports.PureComponent);Document.defaultProps={error:"Failed to load PDF file.",loading:"Loading PDF…",noData:"No PDF file specified.",onPassword:function v(s,b){switch(b){case PasswordResponses.NEED_PASSWORD:{var e=prompt("Enter the password to open this PDF file.");s(e);break}case PasswordResponses.INCORRECT_PASSWORD:{var c=prompt("Invalid password. Please try again.");s(c);break}}}};var isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=_objectSpread$3(_objectSpread$3({},eventProps),{},{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.string,file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,rotate:PropTypes.number});var isDestination=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.any)]);PropTypes.shape({dest:isDestination,items:PropTypes.arrayOf(PropTypes.shape({dest:isDestination,title:PropTypes.string})),title:PropTypes.string}).isRequired,PropTypes.func,isPdf.isRequired;function ownKeys$2(v,s){var b=Object.keys(v);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(v);s&&(e=e.filter(function(c){return Object.getOwnPropertyDescriptor(v,c).enumerable})),b.push.apply(b,e)}return b}function _objectSpread$2(v){for(var s=1;s<arguments.length;s++){var b=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$2(Object(b),!0).forEach(function(e){_defineProperty(v,e,b[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(b)):ownKeys$2(Object(b)).forEach(function(e){Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(b,e))})}return v}_objectSpread$2({className:isClassName,inputRef:isRef,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,pdf:isPdf},eventProps);function mergeRefs(){for(var v=[],s=0;s<arguments.length;s++)v[s]=arguments[s];var b=v.filter(Boolean);if(b.length<=1){var e=b[0];return e||null}return function(O){b.forEach(function(L){typeof L=="function"?L(O):L&&(L.current=O)})}}const PageContext=reactExports.createContext(null);function _createSuper$4(v){var s=_isNativeReflectConstruct$4();return function(){var e=_getPrototypeOf(v),c;if(s){var O=_getPrototypeOf(this).constructor;c=Reflect.construct(e,arguments,O)}else c=e.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _isNativeReflectConstruct$4(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ANNOTATION_MODE=pdfExports.AnnotationMode,PageCanvasInternal=function(v){_inherits(b,v);var s=_createSuper$4(b);function b(){var e;_classCallCheck(this,b);for(var c=arguments.length,O=new Array(c),L=0;L<c;L++)O[L]=arguments[L];return e=s.call.apply(s,[this].concat(O)),_defineProperty(_assertThisInitialized(e),"canvasElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){e.renderer=null;var F=e.props,S=F.onRenderSuccess,m=F.page,R=F.scale;S&&S(makePageCallback(m,R))}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(F){if(!isCancelException(F)){var S=e.props.onRenderError;S&&S(F)}}),_defineProperty(_assertThisInitialized(e),"drawPageOnCanvas",function(){var F=e.canvasElement.current;if(!F)return null;var S=_assertThisInitialized(e),m=S.renderViewport,R=S.viewport,N=e.props,w=N.canvasBackground,P=N.page,h=N.renderForms;F.width=m.width,F.height=m.height,F.style.width="".concat(Math.floor(R.width),"px"),F.style.height="".concat(Math.floor(R.height),"px");var t={annotationMode:h?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,get canvasContext(){return F.getContext("2d",{alpha:!1})},viewport:m};w&&(t.background=w),e.cancelRenderingTask();var l=P.render(t);return e.renderer=l,l.promise.then(e.onRenderSuccess).catch(e.onRenderError)}),e}return _createClass(b,[{key:"componentDidMount",value:function(){this.drawPageOnCanvas()}},{key:"componentDidUpdate",value:function(c){var O=this.props,L=O.canvasBackground,F=O.devicePixelRatio,S=O.page,m=O.renderForms;(L!==c.canvasBackground||F!==c.devicePixelRatio||m!==c.renderForms)&&(S.cleanup(),this.drawPageOnCanvas())}},{key:"componentWillUnmount",value:function(){this.cancelRenderingTask();var c=this.canvasElement.current;c&&(c.width=0,c.height=0)}},{key:"cancelRenderingTask",value:function(){this.renderer&&(this.renderer.cancel(),this.renderer=null)}},{key:"devicePixelRatio",get:function(){var c=this.props.devicePixelRatio;return c||getDevicePixelRatio()}},{key:"renderViewport",get:function(){var c=this.devicePixelRatio,O=this.props,L=O.page,F=O.rotate,S=O.scale;return L.getViewport({scale:S*c,rotation:F})}},{key:"viewport",get:function(){var c=this.props,O=c.page,L=c.rotate,F=c.scale;return O.getViewport({scale:F,rotation:L})}},{key:"render",value:function(){var c=this.props.canvasRef;return U.createElement("canvas",{className:"react-pdf__Page__canvas",dir:"ltr",ref:mergeRefs(c,this.canvasElement),style:{display:"block",userSelect:"none"}})}}]),b}(reactExports.PureComponent);PageCanvasInternal.propTypes={canvasBackground:PropTypes.string,canvasRef:isRef,devicePixelRatio:PropTypes.number,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number.isRequired};function PageCanvas(v){return U.createElement(PageContext.Consumer,null,function(s){return U.createElement(PageCanvasInternal,_extends({},s,v))})}function _createSuper$3(v){var s=_isNativeReflectConstruct$3();return function(){var e=_getPrototypeOf(v),c;if(s){var O=_getPrototypeOf(this).constructor;c=Reflect.construct(e,arguments,O)}else c=e.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _isNativeReflectConstruct$3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var PageSVGInternal=function(v){_inherits(b,v);var s=_createSuper$3(b);function b(){var e;_classCallCheck(this,b);for(var c=arguments.length,O=new Array(c),L=0;L<c;L++)O[L]=arguments[L];return e=s.call.apply(s,[this].concat(O)),_defineProperty(_assertThisInitialized(e),"state",{svg:null}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){e.renderer=null;var F=e.props,S=F.onRenderSuccess,m=F.page,R=F.scale;S&&S(makePageCallback(m,R))}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(F){if(!isCancelException(F)){var S=e.props.onRenderError;S&&S(F)}}),_defineProperty(_assertThisInitialized(e),"renderSVG",function(){var F=e.props.page;return e.renderer=F.getOperatorList(),e.renderer.then(function(S){var m=new pdfExports.SVGGraphics(F.commonObjs,F.objs);e.renderer=m.getSVG(S,e.viewport).then(function(R){e.setState({svg:R},e.onRenderSuccess)}).catch(e.onRenderError)}).catch(e.onRenderError)}),_defineProperty(_assertThisInitialized(e),"drawPageOnContainer",function(F){var S=e.state.svg;if(!(!F||!S)){F.firstElementChild||F.appendChild(S);var m=e.viewport,R=m.width,N=m.height;S.setAttribute("width",R),S.setAttribute("height",N)}}),e}return _createClass(b,[{key:"componentDidMount",value:function(){this.renderSVG()}},{key:"viewport",get:function(){var c=this.props,O=c.page,L=c.rotate,F=c.scale;return O.getViewport({scale:F,rotation:L})}},{key:"render",value:function(){var c=this,O=this.viewport,L=O.width,F=O.height;return U.createElement("div",{className:"react-pdf__Page__svg",ref:function(m){return c.drawPageOnContainer(m)},style:{display:"block",backgroundColor:"white",overflow:"hidden",width:L,height:F,userSelect:"none"}})}}]),b}(reactExports.PureComponent);PageSVGInternal.propTypes={onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,page:isPage.isRequired,rotate:isRotate,scale:PropTypes.number.isRequired};function PageSVG(v){return U.createElement(PageContext.Consumer,null,function(s){return U.createElement(PageSVGInternal,_extends({},s,v))})}function ownKeys$1(v,s){var b=Object.keys(v);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(v);s&&(e=e.filter(function(c){return Object.getOwnPropertyDescriptor(v,c).enumerable})),b.push.apply(b,e)}return b}function _objectSpread$1(v){for(var s=1;s<arguments.length;s++){var b=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$1(Object(b),!0).forEach(function(e){_defineProperty(v,e,b[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(b)):ownKeys$1(Object(b)).forEach(function(e){Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(b,e))})}return v}function _createSuper$2(v){var s=_isNativeReflectConstruct$2();return function(){var e=_getPrototypeOf(v),c;if(s){var O=_getPrototypeOf(this).constructor;c=Reflect.construct(e,arguments,O)}else c=e.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _isNativeReflectConstruct$2(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var TextLayerInternal=function(v){_inherits(b,v);var s=_createSuper$2(b);function b(){var e;_classCallCheck(this,b);for(var c=arguments.length,O=new Array(c),L=0;L<c;L++)O[L]=arguments[L];return e=s.call.apply(s,[this].concat(O)),_defineProperty(_assertThisInitialized(e),"state",{textContent:null}),_defineProperty(_assertThisInitialized(e),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"endElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"loadTextContent",function(){var F=e.props.page,S=makeCancellablePromise(F.getTextContent());e.runningTask=S,S.promise.then(function(m){e.setState({textContent:m},e.onLoadSuccess)}).catch(function(m){e.onLoadError(m)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var F=e.props.onGetTextSuccess,S=e.state.textContent;F&&F(S)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(F){e.setState({textItems:!1});var S=e.props.onGetTextError;S&&S(F)}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){var F=e.props.onRenderTextLayerSuccess;F&&F()}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(F){var S=e.props.onRenderTextLayerError;S&&S(F)}),_defineProperty(_assertThisInitialized(e),"onMouseDown",function(){var F=e.endElement.current;F&&F.classList.add("active")}),_defineProperty(_assertThisInitialized(e),"onMouseUp",function(){var F=e.endElement.current;F&&F.classList.remove("active")}),e}return _createClass(b,[{key:"componentDidMount",value:function(){var c=this.props.page;invariant(c),parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10),this.loadTextContent()}},{key:"componentDidUpdate",value:function(c){var O=this.props.page;c.page&&O!==c.page&&this.loadTextContent()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var c=this.props,O=c.page,L=c.rotate,F=c.scale;return O.getViewport({scale:F,rotation:L})}},{key:"unrotatedViewport",get:function(){var c=this.props,O=c.page,L=c.scale;return O.getViewport({scale:L})}},{key:"rotate",get:function(){var c=this.props,O=c.page,L=c.rotate;return L-O.rotate}},{key:"renderTextLayer",value:function(){var c=this,O=this.state.textContent;if(!O)return null;var L=this.layerElement.current,F=this.viewport,S=this.props,m=S.customTextRenderer,R=S.pageIndex,N=S.pageNumber;cancelRunningTask(this.runningTask),L.innerHTML="";var w={container:L,textContent:O,viewport:F},P=pdfExports.renderTextLayer(w);this.runningTask=P,P.promise.then(function(){var h=document.createElement("div");if(h.className="endOfContent",L.append(h),c.endElement.current=h,m){var t=0;O.items.forEach(function(l,u){var T=c.layerElement.current.children[t],_=m(_objectSpread$1({pageIndex:R,pageNumber:N,itemIndex:u},l));T.innerHTML=_,t+=l.str&&l.hasEOL?2:1})}c.onRenderSuccess()}).catch(function(h){c.onRenderError(h)})}},{key:"render",value:function(){return U.createElement("div",{className:"react-pdf__Page__textContent textLayer",onMouseUp:this.onMouseUp,onMouseDown:this.onMouseDown,ref:this.layerElement},this.renderTextLayer())}}]),b}(reactExports.PureComponent);TextLayerInternal.propTypes={customTextRenderer:PropTypes.func,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,page:isPage.isRequired,pageIndex:PropTypes.number.isRequired,pageNumber:PropTypes.number.isRequired,rotate:isRotate,scale:PropTypes.number};function TextLayer(v){return U.createElement(PageContext.Consumer,null,function(s){return U.createElement(TextLayerInternal,_extends({},s,v))})}function _createSuper$1(v){var s=_isNativeReflectConstruct$1();return function(){var e=_getPrototypeOf(v),c;if(s){var O=_getPrototypeOf(this).constructor;c=Reflect.construct(e,arguments,O)}else c=e.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _isNativeReflectConstruct$1(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var AnnotationLayerInternal=function(v){_inherits(b,v);var s=_createSuper$1(b);function b(){var e;_classCallCheck(this,b);for(var c=arguments.length,O=new Array(c),L=0;L<c;L++)O[L]=arguments[L];return e=s.call.apply(s,[this].concat(O)),_defineProperty(_assertThisInitialized(e),"state",{annotations:null}),_defineProperty(_assertThisInitialized(e),"layerElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"loadAnnotations",function(){var F=e.props.page,S=makeCancellablePromise(F.getAnnotations());e.runningTask=S,S.promise.then(function(m){e.setState({annotations:m},e.onLoadSuccess)}).catch(function(m){e.onLoadError(m)})}),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var F=e.props.onGetAnnotationsSuccess,S=e.state.annotations;F&&F(S)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(F){e.setState({annotations:!1});var S=e.props.onGetAnnotationsError;S&&S(F)}),_defineProperty(_assertThisInitialized(e),"onRenderSuccess",function(){var F=e.props.onRenderAnnotationLayerSuccess;F&&F()}),_defineProperty(_assertThisInitialized(e),"onRenderError",function(F){var S=e.props.onRenderAnnotationLayerError;S&&S(F)}),e}return _createClass(b,[{key:"componentDidMount",value:function(){var c=this.props.page;invariant(c),parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10),this.loadAnnotations()}},{key:"componentDidUpdate",value:function(c){var O=this.props,L=O.page,F=O.renderForms;(c.page&&L!==c.page||F!==c.renderForms)&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){cancelRunningTask(this.runningTask)}},{key:"viewport",get:function(){var c=this.props,O=c.page,L=c.rotate,F=c.scale;return O.getViewport({scale:F,rotation:L})}},{key:"renderAnnotationLayer",value:function(){var c=this.state.annotations;if(c){var O=this.props,L=O.imageResourcesPath,F=O.linkService,S=O.page,m=O.renderForms,R=this.viewport.clone({dontFlip:!0}),N={annotations:c,div:this.layerElement.current,imageResourcesPath:L,linkService:F,page:S,renderForms:m,viewport:R};this.layerElement.current.innerHTML="";try{pdfExports.AnnotationLayer.render(N),this.onRenderSuccess()}catch(w){this.onRenderError(w)}}}},{key:"render",value:function(){return U.createElement("div",{className:"react-pdf__Page__annotations annotationLayer",ref:this.layerElement},this.renderAnnotationLayer())}}]),b}(reactExports.PureComponent);AnnotationLayerInternal.propTypes={imageResourcesPath:PropTypes.string,linkService:isLinkService.isRequired,onGetAnnotationsError:PropTypes.func,onGetAnnotationsSuccess:PropTypes.func,onRenderAnnotationLayerError:PropTypes.func,onRenderAnnotationLayerSuccess:PropTypes.func,page:isPage,renderForms:PropTypes.bool,rotate:isRotate,scale:PropTypes.number};var AnnotationLayer=function v(s){return U.createElement(DocumentContext.Consumer,null,function(b){return U.createElement(PageContext.Consumer,null,function(e){return U.createElement(AnnotationLayerInternal,_extends({},b,e,s))})})};function ownKeys(v,s){var b=Object.keys(v);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(v);s&&(e=e.filter(function(c){return Object.getOwnPropertyDescriptor(v,c).enumerable})),b.push.apply(b,e)}return b}function _objectSpread(v){for(var s=1;s<arguments.length;s++){var b=arguments[s]!=null?arguments[s]:{};s%2?ownKeys(Object(b),!0).forEach(function(e){_defineProperty(v,e,b[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(e){Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(b,e))})}return v}function _createSuper(v){var s=_isNativeReflectConstruct();return function(){var e=_getPrototypeOf(v),c;if(s){var O=_getPrototypeOf(this).constructor;c=Reflect.construct(e,arguments,O)}else c=e.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var defaultScale=1,PageInternal=function(v){_inherits(b,v);var s=_createSuper(b);function b(){var e;_classCallCheck(this,b);for(var c=arguments.length,O=new Array(c),L=0;L<c;L++)O[L]=arguments[L];return e=s.call.apply(s,[this].concat(O)),_defineProperty(_assertThisInitialized(e),"state",{page:null}),_defineProperty(_assertThisInitialized(e),"pageElement",reactExports.createRef()),_defineProperty(_assertThisInitialized(e),"onLoadSuccess",function(){var F=e.props,S=F.onLoadSuccess,m=F.registerPage,R=e.state.page;S&&S(makePageCallback(R,e.scale)),m&&m(e.pageIndex,e.pageElement.current)}),_defineProperty(_assertThisInitialized(e),"onLoadError",function(F){e.setState({page:!1});var S=e.props.onLoadError;S&&S(F)}),_defineProperty(_assertThisInitialized(e),"loadPage",function(){var F=e.props.pdf,S=e.getPageNumber();if(S){e.setState(function(R){return R.page?{page:null}:null});var m=makeCancellablePromise(F.getPage(S));e.runningTask=m,m.promise.then(function(R){e.setState({page:R},e.onLoadSuccess)}).catch(function(R){e.onLoadError(R)})}}),e}return _createClass(b,[{key:"componentDidMount",value:function(){var c=this.props.pdf;invariant(c),this.loadPage()}},{key:"componentDidUpdate",value:function(c){var O=this.props.pdf;if(c.pdf&&O!==c.pdf||this.getPageNumber()!==this.getPageNumber(c)){var L=this.props.unregisterPage;L&&L(this.getPageIndex(c)),this.loadPage()}}},{key:"componentWillUnmount",value:function(){var c=this.props.unregisterPage;c&&c(this.pageIndex),cancelRunningTask(this.runningTask)}},{key:"childContext",get:function(){var c=this.pageIndex,O=this.pageNumber,L=this.state.page;if(!L)return{};var F=this.props,S=F.canvasBackground,m=F.customTextRenderer,R=F.devicePixelRatio,N=F.onGetAnnotationsError,w=F.onGetAnnotationsSuccess,P=F.onGetTextError,h=F.onGetTextSuccess,t=F.onRenderAnnotationLayerError,l=F.onRenderAnnotationLayerSuccess,u=F.onRenderError,T=F.onRenderSuccess,_=F.onRenderTextLayerError,p=F.onRenderTextLayerSuccess,a=F.renderForms,o=F.renderInteractiveForms;return{canvasBackground:S,customTextRenderer:m,devicePixelRatio:R,onGetAnnotationsError:N,onGetAnnotationsSuccess:w,onGetTextError:P,onGetTextSuccess:h,onRenderAnnotationLayerError:t,onRenderAnnotationLayerSuccess:l,onRenderError:u,onRenderSuccess:T,onRenderTextLayerError:_,onRenderTextLayerSuccess:p,page:L,pageIndex:c,pageNumber:O,renderForms:a??o,rotate:this.rotate,scale:this.scale}}},{key:"getPageIndex",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(c.pageNumber)?c.pageNumber-1:isProvided(c.pageIndex)?c.pageIndex:null}},{key:"getPageNumber",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return isProvided(c.pageNumber)?c.pageNumber:isProvided(c.pageIndex)?c.pageIndex+1:null}},{key:"pageIndex",get:function(){return this.getPageIndex()}},{key:"pageNumber",get:function(){return this.getPageNumber()}},{key:"rotate",get:function(){var c=this.props.rotate;if(isProvided(c))return c;var O=this.state.page;return O?O.rotate:null}},{key:"scale",get:function(){var c=this.state.page;if(!c)return null;var O=this.props,L=O.scale,F=O.width,S=O.height,m=this.rotate,R=1,N=L===null?defaultScale:L;if(F||S){var w=c.getViewport({scale:1,rotation:m});R=F?F/w.width:S/w.height}return N*R}},{key:"eventProps",get:function(){var c=this;return makeEventProps(this.props,function(){var O=c.state.page;return O&&makePageCallback(O,c.scale)})}},{key:"pageKey",get:function(){return"".concat(this.pageIndex,"@").concat(this.scale,"/").concat(this.rotate)}},{key:"pageKeyNoScale",get:function(){return"".concat(this.pageIndex,"/").concat(this.rotate)}},{key:"renderMainLayer",value:function(){var c=this.props,O=c.canvasRef,L=c.renderMode;switch(L){case"none":return null;case"svg":return U.createElement(PageSVG,{key:"".concat(this.pageKeyNoScale,"_svg")});case"canvas":default:return U.createElement(PageCanvas,{key:"".concat(this.pageKey,"_canvas"),canvasRef:O})}}},{key:"renderTextLayer",value:function(){var c=this.props.renderTextLayer;return c?U.createElement(TextLayer,{key:"".concat(this.pageKey,"_text")}):null}},{key:"renderAnnotationLayer",value:function(){var c=this.props.renderAnnotationLayer;return c?U.createElement(AnnotationLayer,{key:"".concat(this.pageKey,"_annotations")}):null}},{key:"renderChildren",value:function(){var c=this.props.children;return U.createElement(PageContext.Provider,{value:this.childContext},this.renderMainLayer(),this.renderTextLayer(),this.renderAnnotationLayer(),c)}},{key:"renderContent",value:function(){var c=this.pageNumber,O=this.props.pdf,L=this.state.page;if(!c){var F=this.props.noData;return U.createElement(Message,{type:"no-data"},typeof F=="function"?F():F)}if(O===null||L===null){var S=this.props.loading;return U.createElement(Message,{type:"loading"},typeof S=="function"?S():S)}if(O===!1||L===!1){var m=this.props.error;return U.createElement(Message,{type:"error"},typeof m=="function"?m():m)}return this.renderChildren()}},{key:"render",value:function(){var c=this.pageNumber,O=this.props,L=O.className,F=O.inputRef;return U.createElement("div",_extends({className:clsx("react-pdf__Page",L),"data-page-number":c,ref:mergeRefs(F,this.pageElement),style:{position:"relative",minWidth:"min-content",minHeight:"min-content"}},this.eventProps),this.renderContent())}}]),b}(reactExports.PureComponent);PageInternal.defaultProps={error:"Failed to load the page.",loading:"Loading page…",noData:"No page specified.",renderAnnotationLayer:!0,renderMode:"canvas",renderTextLayer:!0,scale:defaultScale};var isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);PageInternal.propTypes=_objectSpread(_objectSpread({},eventProps),{},{canvasBackground:PropTypes.string,children:PropTypes.node,className:isClassName,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,registerPage:PropTypes.func,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderInteractiveForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,unregisterPage:PropTypes.func,width:PropTypes.number});function Page(v,s){return U.createElement(DocumentContext.Consumer,null,function(b){return U.createElement(PageInternal,_extends({ref:s},b,v))})}const Page$1=U.forwardRef(Page);pdfExports.GlobalWorkerOptions.workerSrc="pdf.worker.js";function ArrowUpTrayIcon({title:v,titleId:s,...b},e){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":s},b),v?reactExports.createElement("title",{id:s},v):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const ForwardRef$5=reactExports.forwardRef(ArrowUpTrayIcon);function CheckCircleIcon({title:v,titleId:s,...b},e){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":s},b),v?reactExports.createElement("title",{id:s},v):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ForwardRef$4=reactExports.forwardRef(CheckCircleIcon);function CurrencyDollarIcon({title:v,titleId:s,...b},e){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":s},b),v?reactExports.createElement("title",{id:s},v):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ForwardRef$3=reactExports.forwardRef(CurrencyDollarIcon);function DocumentCheckIcon({title:v,titleId:s,...b},e){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":s},b),v?reactExports.createElement("title",{id:s},v):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"}))}const ForwardRef$2=reactExports.forwardRef(DocumentCheckIcon);function ExclamationCircleIcon({title:v,titleId:s,...b},e){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":s},b),v?reactExports.createElement("title",{id:s},v):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const ForwardRef$1=reactExports.forwardRef(ExclamationCircleIcon);function XCircleIcon({title:v,titleId:s,...b},e){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":s},b),v?reactExports.createElement("title",{id:s},v):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ForwardRef=reactExports.forwardRef(XCircleIcon);pdfExports.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;const InspectionManagement=()=>{const[v,s]=reactExports.useState([]),[b,e]=reactExports.useState(null),[c,O]=reactExports.useState(""),[L,F]=reactExports.useState(""),[S,m]=reactExports.useState(null),[R,N]=reactExports.useState(!1),[w,P]=reactExports.useState(null),[h,t]=reactExports.useState(!1),[l,u]=reactExports.useState(null),[T,_]=reactExports.useState(49),[p,a]=reactExports.useState(!1),[o,n]=reactExports.useState(""),[x,C]=reactExports.useState(""),[z,G]=reactExports.useState(!1),[oe,le]=reactExports.useState(null),[se,ne]=reactExports.useState(null),[X,J]=reactExports.useState(1),[Q,ie]=reactExports.useState(0),[de,ge]=reactExports.useState(null),[V,f]=reactExports.useState("all"),[d,I]=reactExports.useState("");reactExports.useEffect(()=>{H(),q()},[]);const q=async()=>{var K,B;try{const Y=localStorage.getItem("token");if(!Y){n("جلسة المستخدم منتهية. الرجاء تسجيل الدخول مرة أخرى");return}const Z=await axios.get("/api/admin/inspection/fee",{headers:{Authorization:`Bearer ${Y}`,"Content-Type":"application/json"}});Z.data&&Z.data.fee!==void 0?_(Z.data.fee):(console.error("Invalid response format:",Z.data),n("فشل في جلب رسوم الفحص. الرجاء تحديث الصفحة"))}catch(Y){console.error("Error fetching inspection fee:",{message:Y.message,response:(K=Y.response)==null?void 0:K.data,status:(B=Y.response)==null?void 0:B.status}),n("فشل في جلب رسوم الفحص. الرجاء تحديث الصفحة")}},$=async()=>{var B,Y,Z,ae,ue,re;const K=parseFloat(T);if(isNaN(K)||K<0){n("الرجاء إدخال قيمة صحيحة");return}n("");try{const be=localStorage.getItem("token");if(!be){n("جلسة المستخدم منتهية. الرجاء تسجيل الدخول مرة أخرى");return}const _e=await axios.put("/api/admin/inspection/fee",{fee:K},{headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});_e.data&&_e.data.success?(_(K),a(!1)):n("فشل في تحديث رسوم الفحص. الرجاء المحاولة مرة أخرى")}catch(be){console.error("Error updating inspection fee:",{message:be.message,response:(B=be.response)==null?void 0:B.data,status:(Y=be.response)==null?void 0:Y.status});const _e=((ae=(Z=be.response)==null?void 0:Z.data)==null?void 0:ae.message)||((re=(ue=be.response)==null?void 0:ue.data)==null?void 0:re.error)||"فشل في تحديث رسوم الفحص. الرجاء المحاولة مرة أخرى";n(_e)}},H=async()=>{var K,B,Y,Z,ae;try{N(!0),P(null);const ue=localStorage.getItem("token");if(!ue){P("جلسة المستخدم منتهية. الرجاء تسجيل الدخول مرة أخرى");return}const re=await axios.get("/api/admin/inspection/orders",{headers:{Authorization:`Bearer ${ue}`,"Content-Type":"application/json"}});re.data&&re.data.orders?s(re.data.orders):s([])}catch(ue){console.error("Error fetching orders:",ue);const re=((Y=(B=(K=ue.response)==null?void 0:K.data)==null?void 0:B.error)==null?void 0:Y.sqlMessage)||((ae=(Z=ue.response)==null?void 0:Z.data)==null?void 0:ae.message)||"فشل في جلب الطلبات. الرجاء المحاولة مرة أخرى";P(re)}finally{N(!1)}},i=async K=>{var B,Y,Z,ae,ue;try{P(null);const re=localStorage.getItem("token");if(!re){P("جلسة المستخدم منتهية. الرجاء تسجيل الدخول مرة أخرى");return}await axios.post(`/api/admin/inspection/orders/${K}/start`,{},{headers:{Authorization:`Bearer ${re}`,"Content-Type":"application/json"}}),s(_e=>_e.map(me=>me.id===K?{...me,status:"pending"}:me));const be=v.find(_e=>_e.id===K);be&&e({...be,status:"pending"})}catch(re){console.error("Error starting inspection:",re);const be=((Z=(Y=(B=re.response)==null?void 0:B.data)==null?void 0:Y.error)==null?void 0:Z.sqlMessage)||((ue=(ae=re.response)==null?void 0:ae.data)==null?void 0:ue.message)||"فشل في بدء عملية الفحص. الرجاء المحاولة مرة أخرى";P(be),H()}},g=K=>K?K.type!=="application/pdf"?(C("يجب أن يكون الملف بصيغة PDF"),!1):K.size>10*1024*1024?(C("حجم الملف يجب أن لا يتجاوز 10 ميجابايت"),!1):(C(""),!0):(C("يرجى اختيار ملف"),!1);function E({numPages:K}){ne(K),ge(null)}function A(K){console.error("Error while loading document:",K),ge("Failed to load PDF file")}const k=K=>{const B=K.target.files[0];if(g(B)){m(B);const Y=URL.createObjectURL(B);le(Y),ge(null),C("")}else K.target.value=null,m(null),le(null)};reactExports.useEffect(()=>()=>{oe&&URL.revokeObjectURL(oe)},[oe]);const W=async K=>{var B,Y,Z,ae;try{if(!S||!c){P("الرجاء تعبئة رقم هاتف الفاحص وإرفاق ملف التقرير");return}if(!/^(05)[0-9]{8}$/.test(c)){P("رقم الهاتف يجب أن يبدأ ب 05 ويتكون من 10 أرقام");return}P(null),G(!0),ie(0);const re=localStorage.getItem("token");if(!re){P("جلسة المستخدم منتهية. الرجاء تسجيل الدخول مرة أخرى");return}const be=new FormData;be.append("report",S),be.append("inspectionStatus",K),be.append("inspectorPhone",c),L&&L.trim()&&be.append("inspectorNotes",L.trim());const _e=await axios.post(`/api/admin/inspection/orders/${b.id}/report`,be,{headers:{Authorization:`Bearer ${re}`,"Content-Type":"multipart/form-data"},onUploadProgress:me=>{const ve=Math.round(me.loaded*100/me.total);ie(ve)}});if(_e.data&&_e.data.reportUrl)e(null),O(""),F(""),m(null),le(null),ie(0),await H();else throw new Error("Invalid response format")}catch(ue){console.error("Error submitting report:",ue);let re="فشل في رفع التقرير. ";(Y=(B=ue.response)==null?void 0:B.data)!=null&&Y.message?re+=ue.response.data.message:((Z=ue.response)==null?void 0:Z.status)===413?re+="حجم الملف كبير جداً. الحد الأقصى هو 10 ميجابايت":((ae=ue.response)==null?void 0:ae.status)===415?re+="نوع الملف غير مدعوم. يرجى رفع ملف PDF فقط":re+="الرجاء المحاولة مرة أخرى",P(re)}finally{G(!1)}},M=async K=>{var B;try{const Y=localStorage.getItem("token");if(!Y){P("جلسة المستخدم منتهية. الرجاء تسجيل الدخول مرة أخرى");return}u(K),P(null);const Z=await axios.get(`/api/admin/inspection/orders/${K}/report`,{headers:{Authorization:`Bearer ${Y}`}});Z.data&&Z.data.report&&Z.data.report.report_file_path?window.open(Z.data.report.report_file_path,"_blank"):P("تقرير الفحص غير موجود")}catch(Y){console.error("Error downloading report:",Y),((B=Y.response)==null?void 0:B.status)===404?P("تقرير الفحص غير موجود"):P("فشل في تحميل التقرير. الرجاء المحاولة مرة أخرى")}finally{u(null)}},y=U.useMemo(()=>{const K=v.filter(Y=>String(Y.payment_status).toLowerCase()==="paid");let B=h?K.filter(Y=>Y.status==="passed"||Y.status==="failed"):K.filter(Y=>Y.status==="pending");if(V!=="all"&&(B=B.filter(Y=>Y.status===V)),d.trim()!==""){const Y=d.trim().toLowerCase();B=B.filter(Z=>{const ae=String(Z.id).includes(Y),ue=`${Z.buyer_first_name||""} ${Z.buyer_last_name||""}`.toLowerCase(),re=(Z.buyer_phone||"").toLowerCase();return ae||ue.includes(Y)||re.includes(Y)})}return B},[v,h,V,d]),j=K=>{switch(K){case"passed":return{text:"تم الفحص - القطعة سليمة",className:"bg-green-100 text-green-800"};case"failed":return{text:"تم الفحص - القطعة غير صالحة",className:"bg-red-100 text-red-800"};default:return{text:"بانتظار الفحص",className:"bg-yellow-100 text-yellow-800"}}};return R?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center min-h-screen",children:jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(HelmetExport,{children:jsxRuntimeExports.jsx("title",{children:"فحص الطلبات"})}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 py-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>t(!h),className:`inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${h?"bg-gray-600 hover:bg-gray-700":"bg-indigo-600 hover:bg-indigo-700"}`,children:[jsxRuntimeExports.jsx(ForwardRef$6,{className:"h-5 w-5 ml-2"}),h?"عرض الطلبات المعلقة":"عرض الطلبات المفحوصة"]}),b&&jsxRuntimeExports.jsxs("button",{onClick:()=>e(null),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L4.414 9H17a1 1 0 110 2H4.414l5.293 5.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"العودة إلى القائمة"]})]}),jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-900 text-right",children:"إدارة فحص الطلبات"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(ForwardRef$3,{className:"h-6 w-6 text-gray-500"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold",children:"رسوم الفحص"})]}),p?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("input",{type:"number",value:T,onChange:K=>_(K.target.value),className:"w-32 border rounded-lg p-2 text-right",min:"0",step:"0.01"}),jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"ر.س"}),jsxRuntimeExports.jsx("button",{onClick:$,className:"bg-green-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-green-700 transition-colors",children:"حفظ"}),jsxRuntimeExports.jsx("button",{onClick:()=>{a(!1),n(""),q()},className:"bg-gray-100 text-gray-600 px-4 py-2 rounded-lg text-sm hover:bg-gray-200 transition-colors",children:"إلغاء"})]}):jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsxs("span",{className:"text-xl font-semibold",children:[T," ر.س"]}),jsxRuntimeExports.jsx("button",{onClick:()=>a(!0),className:"bg-blue-100 text-blue-600 px-4 py-2 rounded-lg text-sm hover:bg-blue-200 transition-colors",children:"تعديل"})]})]}),o&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-sm mt-2 text-right",children:o})]}),w&&jsxRuntimeExports.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4 text-right",children:w}),b?jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[jsxRuntimeExports.jsx("div",{className:"mb-8",children:jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-right",children:["تقرير الفحص - طلب رقم ",b.id]})}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 text-right mb-2",children:"رقم هاتف الفاحص"}),jsxRuntimeExports.jsx("input",{type:"tel",className:"w-full border-gray-300 rounded-md shadow-sm text-right",value:c,onChange:K=>O(K.target.value),placeholder:"05xxxxxxxx",dir:"rtl"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 text-right mb-2",children:"ملاحظات الفحص"}),jsxRuntimeExports.jsx("textarea",{className:"w-full border-gray-300 rounded-md shadow-sm text-right",value:L,onChange:K=>F(K.target.value),rows:"4",dir:"rtl"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 text-right mb-2",children:"تقرير الفحص (PDF)"}),jsxRuntimeExports.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md relative",children:jsxRuntimeExports.jsx("div",{className:"space-y-1 text-center",children:S?jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["تم اختيار: ",S.name]}),oe&&jsxRuntimeExports.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[jsxRuntimeExports.jsx(Document,{file:oe,onLoadSuccess:E,onLoadError:A,loading:jsxRuntimeExports.jsxs("div",{className:"text-center py-4",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mx-auto"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"جاري تحميل الملف..."})]}),error:jsxRuntimeExports.jsx("div",{className:"text-center py-4 text-red-600",children:jsxRuntimeExports.jsx("p",{children:de||"حدث خطأ في تحميل الملف"})}),children:jsxRuntimeExports.jsx(Page$1,{pageNumber:X,width:300,renderTextLayer:!0,renderAnnotationLayer:!0})}),se>0&&jsxRuntimeExports.jsxs("div",{className:"mt-2 flex justify-center items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>J(Math.max(1,X-1)),disabled:X<=1,className:"px-2 py-1 text-sm bg-gray-100 rounded disabled:opacity-50",children:"السابق"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600",children:["صفحة ",X," من ",se]}),jsxRuntimeExports.jsx("button",{onClick:()=>J(Math.min(se,X+1)),disabled:X>=se,className:"px-2 py-1 text-sm bg-gray-100 rounded disabled:opacity-50",children:"التالي"})]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{m(null),le(null),ne(null),J(1),ge(null)},className:"mt-4 text-sm text-red-600 hover:text-red-800",children:"إزالة الملف"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ForwardRef$5,{className:"mx-auto h-12 w-12 text-gray-400"}),jsxRuntimeExports.jsx("div",{className:"flex text-sm text-gray-600",children:jsxRuntimeExports.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500",children:[jsxRuntimeExports.jsx("span",{children:"اختر ملف PDF"}),jsxRuntimeExports.jsx("input",{id:"file-upload",name:"file-upload",type:"file",accept:".pdf,application/pdf",className:"sr-only",onChange:k,disabled:z})]})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"PDF حتى 10 ميجابايت"})]})})}),x&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-red-600 flex items-center justify-end mt-2",children:[jsxRuntimeExports.jsx(ForwardRef$1,{className:"h-5 w-5 ml-1"}),x]}),z&&jsxRuntimeExports.jsxs("div",{className:"mt-2",children:[jsxRuntimeExports.jsx("div",{className:"bg-gray-200 rounded-full h-2.5",children:jsxRuntimeExports.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${Q}%`}})}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 text-center mt-1",children:[Q,"%"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-4",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>W("failed"),disabled:z,className:`inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${z?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:[jsxRuntimeExports.jsx(ForwardRef,{className:"h-5 w-5 ml-2"}),z?"جاري الرفع...":"القطعة غير صالحة"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>W("passed"),disabled:z,className:`inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${z?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:[jsxRuntimeExports.jsx(ForwardRef$4,{className:"h-5 w-5 ml-2"}),z?"جاري الرفع...":"القطعة سليمة"]})]})]})]}):jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx("label",{htmlFor:"status-filter",className:"text-sm font-medium text-gray-700",children:"الحالة:"}),jsxRuntimeExports.jsxs("select",{id:"status-filter",value:V,onChange:K=>f(K.target.value),className:"border rounded-md p-2 text-sm",children:[jsxRuntimeExports.jsx("option",{value:"all",children:"الكل"}),jsxRuntimeExports.jsx("option",{value:"pending",children:"بانتظار الفحص"}),jsxRuntimeExports.jsx("option",{value:"passed",children:"تم الفحص - القطعة سليمة"}),jsxRuntimeExports.jsx("option",{value:"failed",children:"تم الفحص - القطعة غير صالحة"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center",children:[jsxRuntimeExports.jsx("label",{htmlFor:"search-text",className:"text-sm font-medium text-gray-700",children:"بحث:"}),jsxRuntimeExports.jsx("input",{id:"search-text",type:"text",value:d,onChange:K=>I(K.target.value),placeholder:"رقم الطلب أو اسم المشتري أو رقم الهاتف",className:"border rounded-md p-2 text-sm w-64"})]})]}),jsxRuntimeExports.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[jsxRuntimeExports.jsx("thead",{className:"bg-gray-50",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"رقم الطلب"}),jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشتري"}),jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"القطع المطلوبة"}),jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"السعر الإجمالي"}),jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الطلب"}),jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),jsxRuntimeExports.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(K=>{var Z;const B=j(K.status),Y=l===K.id;return jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:K.id}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 text-right",children:jsxRuntimeExports.jsxs("div",{className:"font-medium text-gray-900",children:[K.buyer_first_name," ",K.buyer_last_name]})}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 text-right",children:jsxRuntimeExports.jsx("div",{className:"space-y-1",children:(Z=K.products)==null?void 0:Z.map((ae,ue)=>jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-gray-900",children:ae.title}),jsxRuntimeExports.jsxs("div",{className:"text-gray-500",children:[ae.part_name," (الكمية: ",ae.quantity,")",jsxRuntimeExports.jsxs("div",{className:"text-xs text-gray-400",children:["البائع: ",ae.seller_email]})]})]},`${K.id}-${ae.title}-${ue}`))})}),jsxRuntimeExports.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[K.total_price," ر.س"]}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:new Date(K.created_at).toLocaleDateString("ar",{year:"numeric",month:"long",day:"numeric",calendar:"gregory"})}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:jsxRuntimeExports.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${B.className}`,children:B.text})}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:K.status==="pending"?jsxRuntimeExports.jsxs("button",{onClick:()=>i(K.id),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[jsxRuntimeExports.jsx(ForwardRef$2,{className:"h-4 w-4 ml-2"}),"بدء الفحص"]}):jsxRuntimeExports.jsx("button",{onClick:()=>M(K.id),disabled:Y,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white ${Y?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:Y?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("svg",{className:"animate-spin h-4 w-4 ml-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[jsxRuntimeExports.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),jsxRuntimeExports.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري التحميل..."]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ForwardRef$7,{className:"h-4 w-4 ml-2"}),"تحميل التقرير"]})})})]},K.id)})})]})]})]})]})};export{InspectionManagement as default};
