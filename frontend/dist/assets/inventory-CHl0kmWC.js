import{r,a as m,j as e,y}from"./index-D16p3XyI.js";import{H as I}from"./Helmet-Ddbi4KVR.js";import{P as f}from"./plus-B5m47POj.js";import{S as E}from"./search-BP--WMlP.js";import{T as k}from"./trash-2-Cg1fUHpm.js";import"./createLucideIcon-OCKor7qf.js";const H=()=>{const[x,h]=r.useState([]),[j,v]=r.useState(!0),[F,b]=r.useState(null),[o,N]=r.useState(""),[i,w]=r.useState("created_at"),[d,S]=r.useState("desc"),[p,u]=r.useState(null),[c,_]=r.useState("all");r.useEffect(()=>{C()},[i,d]);const C=async()=>{var t,l;try{const s=localStorage.getItem("token"),a=await m.get(`/api/seller/inventory?sort=${i}&order=${d}`,{headers:{Authorization:`Bearer ${s}`}});h(a.data.products||[])}catch(s){console.error("Error fetching inventory:",s),b(((l=(t=s.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to fetch inventory")}finally{v(!1)}},$=async t=>{var l,s;if(!window.confirm("هل أنت متأكد من حذف هذا المنتج؟")){y.error("تم إلغاء الحذف");return}try{u(t);const a=localStorage.getItem("token");await m.delete(`/api/seller/inventory/${t}`,{headers:{Authorization:`Bearer ${a}`}}),h(x.filter(n=>n.product_id!==t))}catch(a){y.error(((s=(l=a.response)==null?void 0:l.data)==null?void 0:s.message)||"Failed to delete product")}finally{u(null)}},g=x.filter(t=>{var a,n;const l=(((a=t.title)==null?void 0:a.toLowerCase())||"").includes(o.toLowerCase())||(((n=t.part_name)==null?void 0:n.toLowerCase())||"").includes(o.toLowerCase()),s=c==="all"?!0:c==="sold"?t.status==="sold":t.status!=="sold";return l&&s});return j?e.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.jsxs(e.Fragment,{children:[e.jsx(I,{children:e.jsx("title",{children:"مخزون البائع"})}),e.jsxs("div",{className:"animate-fadeIn p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"المخزون"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"عرض المنتجات المتوفرة"})]}),e.jsxs("a",{href:"/seller/upload",className:"px-5 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-2 text-sm font-medium",children:[e.jsx(f,{className:"h-5 w-5"}),"إضافة قطعة جديدة"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(E,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"البحث في المخزون...",value:o,onChange:t=>N(t.target.value),className:"w-full pl-4 pr-10 py-2.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 transition-all duration-200"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("select",{value:c,onChange:t=>_(t.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 transition-all duration-200 bg-white",children:[e.jsx("option",{value:"all",children:"جميع المنتجات"}),e.jsx("option",{value:"available",children:"المنتجات المتوفرة"}),e.jsx("option",{value:"sold",children:"المنتجات المباعة"})]}),e.jsxs("select",{value:i,onChange:t=>w(t.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 transition-all duration-200 bg-white",children:[e.jsx("option",{value:"created_at",children:"تاريخ الإضافة"}),e.jsx("option",{value:"price",children:"السعر"})]}),e.jsxs("select",{value:d,onChange:t=>S(t.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-100 focus:border-indigo-300 transition-all duration-200 bg-white",children:[e.jsx("option",{value:"desc",children:"تنازلي"}),e.jsx("option",{value:"asc",children:"تصاعدي"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"القطعة"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"السيارة"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"السعر"}),e.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:"الحالة"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"حذف المنتج"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.title||"غير محدد"}),e.jsx("p",{className:"text-sm text-gray-500",children:t.part_name||"غير محدد"})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900",children:t.company_name||"غير محدد"}),e.jsx("p",{className:"text-sm text-gray-500",children:t.car_name||"غير محدد"})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("span",{className:"font-medium text-gray-900",children:t.price?`${t.price} ر.س`:"غير محدد"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.approval_status==="approved"?"bg-green-100 text-green-800":t.approval_status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.approval_status==="approved"?"معتمد":t.approval_status==="pending"?"قيد المراجعة":"مرفوض"}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="sold"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:t.status==="sold"?"مباع":"متوفر"})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>$(t.product_id),disabled:p===t.product_id,className:`text-red-600 hover:text-red-800 transition-colors p-2 rounded-full hover:bg-red-50 ${p===t.product_id?"opacity-50 cursor-not-allowed":""}`,title:"حذف المنتج",children:e.jsx(k,{className:"h-5 w-5"})})})]},t.product_id))})]})}),g.length===0&&e.jsxs("div",{className:"text-center text-gray-500 py-12",children:[e.jsx(f,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg font-medium",children:"لا توجد منتجات"}),e.jsx("p",{className:"text-sm",children:"قم بإضافة منتجات جديدة لعرضها هنا"})]})]})]})]})};export{H as default};
