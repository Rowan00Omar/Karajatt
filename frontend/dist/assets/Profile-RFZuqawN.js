import{c as I,r as o,j as e,L as $,a as g,y as p}from"./index-DotS8Uwj.js";import{R as D}from"./Reviews-aq7TI4GA.js";import{B as y}from"./Button-DvXxWnOi.js";import{I as m}from"./Input-DdCekiyv.js";import{H as P}from"./Helmet-BBvg7tzo.js";import{K as A}from"./key-round-CuGH0QQw.js";import{S as B}from"./star-Cp57n0Ry.js";import{L as h}from"./dialog-BGz-LZnX.js";import"./createLucideIcon-D9q1tf3H.js";import"./index-7yjEsgeT.js";const q=()=>{const b=I(),n=localStorage.getItem("token"),[c,v]=o.useState(null),[w,k]=o.useState(!0),[f,S]=o.useState(null),[C,u]=o.useState(!1),[r,j]=o.useState(!1),[a,d]=o.useState({name:"",email:"",phone:"",address:"",bankName:"",accountNumber:""});o.useEffect(()=>{(async()=>{var t,l;if(!n){b("/login");return}try{const N=JSON.parse(atob(n.split(".")[1])).id,i=await g.get(`/api/seller/profile/${N}`,{headers:{Authorization:`Bearer ${n}`}});v(i.data),d({name:i.data.name,email:i.data.email,phone:i.data.phone_number||"",address:i.data.address||"",bankName:i.data.bank_name||"",accountNumber:i.data.account_number||""})}catch(x){S(((l=(t=x.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to fetch information"),console.error("Error fetching data:",x)}finally{k(!1)}})()},[n,b]);const _=async()=>{var s,t;try{const x=JSON.parse(atob(n.split(".")[1])).id,N=await g.put(`/api/seller/profile/${x}`,{name:a.name,email:a.email,phone_number:a.phone,address:a.address,bank_name:a.bankName,account_number:a.accountNumber},{headers:{Authorization:`Bearer ${n}`}});p.success("تم تحديث المعلومات بنجاح"),j(!1),window.location.reload()}catch(l){p.error(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to update information")}},E=async()=>{var s,t;try{const l=localStorage.getItem("token");await g.delete("/api/seller/profile",{headers:{Authorization:`Bearer ${l}`}}),localStorage.removeItem("token"),window.location.href="/"}catch(l){p.error(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete account")}};return w?e.jsx("div",{className:"text-center py-8",children:"جاري التحميل..."}):f?e.jsx("div",{className:"text-red-500 text-center py-8",children:f}):c?e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx("title",{children:"الملف الشخصي"})}),e.jsxs("div",{className:"space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"الملف الشخصي والمعلومات البنكية"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs($,{to:`/reset-forgotten-password/${n}`,className:"w-full sm:w-fit bg-indigo-600 hover:bg-indigo-700 text-white py-2.5 px-4 rounded-lg transition flex items-center justify-center sm:justify-start gap-2 text-sm sm:text-base",children:[e.jsx(A,{className:"w-4 sm:w-5 h-4 sm:h-5"}),"تغيير كلمة المرور"]}),e.jsx(y,{onClick:()=>r?_():j(!0),className:"px-4 py-2 rounded-md",children:r?"حفظ التغييرات":"تعديل المعلومات"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"المعلومات الشخصية"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الاسم"}),e.jsx(m,{type:"text",value:a.name,onChange:s=>d({...a,name:s.target.value}),disabled:!r,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"البريد الإلكتروني"}),e.jsx(m,{type:"email",value:a.email,onChange:s=>d({...a,email:s.target.value}),disabled:!r,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الهاتف"}),e.jsx(m,{type:"tel",value:a.phone,onChange:s=>d({...a,phone:s.target.value}),disabled:!r,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"العنوان"}),e.jsx(m,{type:"text",value:a.address,onChange:s=>d({...a,address:s.target.value}),disabled:!r,className:"w-full"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"المعلومات البنكية"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم البنك"}),e.jsx(m,{type:"text",value:a.bankName,onChange:s=>d({...a,bankName:s.target.value}),disabled:!r,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الحساب"}),e.jsx(m,{type:"text",value:a.accountNumber,onChange:s=>d({...a,accountNumber:s.target.value}),disabled:!r,className:"w-full"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"الإحصائيات"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-600",children:"التقييم العام"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((s,t)=>e.jsx(B,{className:`w-5 h-5 ${t<Math.round(c.average_rating)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},t))}),e.jsxs("span",{className:"text-lg font-semibold",children:[c.average_rating," من 5"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-600",children:"عدد المنتجات"}),e.jsx("p",{className:"text-2xl font-semibold",children:c.total_products})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-600",children:"عدد التقييمات"}),e.jsx("p",{className:"text-2xl font-semibold",children:c.total_reviews})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"التقييمات"}),e.jsx(D,{type:"seller",id:c.id})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(y,{onClick:()=>u(!0),className:"bg-red-600 hover:bg-red-700 text-white",children:"حذف الحساب"})}),e.jsxs(h,{open:C,onClose:()=>u(!1),className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(h.Panel,{className:"mx-auto max-w-sm rounded-lg bg-white p-6",children:[e.jsx(h.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"تأكيد حذف الحساب"}),e.jsx(h.Description,{className:"text-sm text-gray-500 mb-6",children:"هل أنت متأكد من رغبتك في حذف حسابك؟ هذا الإجراء لا يمكن التراجع عنه."}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 rounded-md",children:"إلغاء"}),e.jsx("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md",children:"حذف الحساب"})]})]})})]})]})]}):e.jsx("div",{className:"text-center py-8",children:"لم يتم العثور على البائع"})};export{q as default};
