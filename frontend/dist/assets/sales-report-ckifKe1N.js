import{U as b,r as k,a as J,j as n}from"./index-diZV0YSE.js";import{H as ft}from"./Helmet-DBvIfVxX.js";import{C as yt}from"./calendar-BjSemQl-.js";import{D as vt}from"./dollar-sign-CdSGnlHJ.js";import{P as xt}from"./package-4ujoN_Zj.js";import{T as gt}from"./trending-up-Cmqf4Ncg.js";import{j as bt,D as jt,p as At,E as St,L as G,f as z,a as wt,A as Pt,b as I,e as Nt,c as H,h as kt,g as Et,k as ot,u as Ot,G as Dt,l as Q,n as st,X as M,Y,o as lt,B as ct,R as Z,C as tt,T as et}from"./generateCategoricalChart-BU5fAFsD.js";import{c as rt}from"./clsx-B-dksMZM.js";import"./createLucideIcon-Cq23c9UE.js";import"./tiny-invariant-CopsF_GD.js";var _t=["type","layout","connectNulls","ref"],Ct=["key"];function _(t){"@babel/helpers - typeof";return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_(t)}function at(t,r){if(t==null)return{};var a=Lt(t,r),e,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(i=0;i<l.length;i++)e=l[i],!(r.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(t,e)&&(a[e]=t[e])}return a}function Lt(t,r){if(t==null)return{};var a={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){if(r.indexOf(e)>=0)continue;a[e]=t[e]}return a}function $(){return $=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(t[e]=a[e])}return t},$.apply(this,arguments)}function nt(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),a.push.apply(a,e)}return a}function A(t){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?nt(Object(a),!0).forEach(function(e){S(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):nt(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function D(t){return It(t)||Ft(t)||Bt(t)||Tt()}function Tt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bt(t,r){if(t){if(typeof t=="string")return X(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return X(t,r)}}function Ft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function It(t){if(Array.isArray(t))return X(t)}function X(t,r){(r==null||r>t.length)&&(r=t.length);for(var a=0,e=new Array(r);a<r;a++)e[a]=t[a];return e}function $t(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function it(t,r){for(var a=0;a<r.length;a++){var e=r[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,dt(e.key),e)}}function Rt(t,r,a){return r&&it(t.prototype,r),a&&it(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wt(t,r,a){return r=U(r),Kt(t,ut()?Reflect.construct(r,a||[],U(t).constructor):r.apply(t,a))}function Kt(t,r){if(r&&(_(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zt(t)}function zt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ut=function(){return!!t})()}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},U(t)}function Mt(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&q(t,r)}function q(t,r){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},q(t,r)}function S(t,r,a){return r=dt(r),r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function dt(t){var r=Yt(t,"string");return _(r)=="symbol"?r:r+""}function Yt(t,r){if(_(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var e=a.call(t,r);if(_(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var R=function(t){function r(){var a;$t(this,r);for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];return a=Wt(this,r,[].concat(i)),S(a,"state",{isAnimationFinished:!0,totalLength:0}),S(a,"generateSimpleStrokeDasharray",function(o,c){return"".concat(c,"px ").concat(o-c,"px")}),S(a,"getStrokeDasharray",function(o,c,d){var h=d.reduce(function(m,g){return m+g});if(!h)return a.generateSimpleStrokeDasharray(c,o);for(var y=Math.floor(o/h),v=o%h,p=c-o,f=[],u=0,x=0;u<d.length;x+=d[u],++u)if(x+d[u]>v){f=[].concat(D(d.slice(0,u)),[v-x]);break}var s=f.length%2===0?[0,p]:[p];return[].concat(D(r.repeat(d,y)),D(f),s).map(function(m){return"".concat(m,"px")}).join(", ")}),S(a,"id",Ot("recharts-line-")),S(a,"pathRef",function(o){a.mainCurve=o}),S(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),S(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}return Mt(r,t),Rt(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();this.setState({totalLength:e})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();e!==this.state.totalLength&&this.setState({totalLength:e})}}},{key:"getTotalLength",value:function(){var e=this.mainCurve;try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(e,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,o=l.points,c=l.xAxis,d=l.yAxis,h=l.layout,y=l.children,v=At(y,St);if(!v)return null;var p=function(x,s){return{x:x.x,y:x.y,value:x.value,errorVal:ot(x.payload,s)}},f={clipPath:e?"url(#clipPath-".concat(i,")"):null};return b.createElement(G,f,v.map(function(u){return b.cloneElement(u,{key:"bar-".concat(u.props.dataKey),data:o,xAxis:c,yAxis:d,layout:h,dataPointFormatter:p})}))}},{key:"renderDots",value:function(e,i,l){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,d=c.dot,h=c.points,y=c.dataKey,v=z(this.props,!1),p=z(d,!0),f=h.map(function(x,s){var m=A(A(A({key:"dot-".concat(s),r:3},v),p),{},{index:s,cx:x.x,cy:x.y,value:x.value,dataKey:y,payload:x.payload,points:h});return r.renderDotItem(d,m)}),u={clipPath:e?"url(#clipPath-".concat(i?"":"dots-").concat(l,")"):null};return b.createElement(G,$({className:"recharts-line-dots",key:"dots"},u),f)}},{key:"renderCurveStatically",value:function(e,i,l,o){var c=this.props,d=c.type,h=c.layout,y=c.connectNulls;c.ref;var v=at(c,_t),p=A(A(A({},z(v,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(l,")"):null,points:e},o),{},{type:d,layout:h,connectNulls:y});return b.createElement(wt,$({},p,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(e,i){var l=this,o=this.props,c=o.points,d=o.strokeDasharray,h=o.isAnimationActive,y=o.animationBegin,v=o.animationDuration,p=o.animationEasing,f=o.animationId,u=o.animateNewValues,x=o.width,s=o.height,m=this.state,g=m.prevPoints,P=m.totalLength;return b.createElement(Pt,{begin:y,duration:v,isActive:h,easing:p,from:{t:0},to:{t:1},key:"line-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(E){var w=E.t;if(g){var C=g.length/c.length,N=c.map(function(j,V){var B=Math.floor(V*C);if(g[B]){var F=g[B],O=I(F.x,j.x),pt=I(F.y,j.y);return A(A({},j),{},{x:O(w),y:pt(w)})}if(u){var ht=I(x*2,j.x),mt=I(s/2,j.y);return A(A({},j),{},{x:ht(w),y:mt(w)})}return A(A({},j),{},{x:j.x,y:j.y})});return l.renderCurveStatically(N,e,i)}var W=I(0,P),L=W(w),T;if(d){var K="".concat(d).split(/[,\s]+/gim).map(function(j){return parseFloat(j)});T=l.getStrokeDasharray(L,P,K)}else T=l.generateSimpleStrokeDasharray(P,L);return l.renderCurveStatically(c,e,i,{strokeDasharray:T})})}},{key:"renderCurve",value:function(e,i){var l=this.props,o=l.points,c=l.isAnimationActive,d=this.state,h=d.prevPoints,y=d.totalLength;return c&&o&&o.length&&(!h&&y>0||!Nt(h,o))?this.renderCurveWithAnimation(e,i):this.renderCurveStatically(o,e,i)}},{key:"render",value:function(){var e,i=this.props,l=i.hide,o=i.dot,c=i.points,d=i.className,h=i.xAxis,y=i.yAxis,v=i.top,p=i.left,f=i.width,u=i.height,x=i.isAnimationActive,s=i.id;if(l||!c||!c.length)return null;var m=this.state.isAnimationFinished,g=c.length===1,P=rt("recharts-line",d),E=h&&h.allowDataOverflow,w=y&&y.allowDataOverflow,C=E||w,N=H(s)?this.id:s,W=(e=z(o,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},L=W.r,T=L===void 0?3:L,K=W.strokeWidth,j=K===void 0?2:K,V=kt(o)?o:{},B=V.clipDot,F=B===void 0?!0:B,O=T*2+j;return b.createElement(G,{className:P},E||w?b.createElement("defs",null,b.createElement("clipPath",{id:"clipPath-".concat(N)},b.createElement("rect",{x:E?p:p-f/2,y:w?v:v-u/2,width:E?f:f*2,height:w?u:u*2})),!F&&b.createElement("clipPath",{id:"clipPath-dots-".concat(N)},b.createElement("rect",{x:p-O/2,y:v-O/2,width:f+O,height:u+O}))):null,!g&&this.renderCurve(C,N),this.renderErrorBar(C,N),(g||o)&&this.renderDots(C,F,N),(!x||m)&&Et.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(e,i){return e.animationId!==i.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:i.curPoints}:e.points!==i.curPoints?{curPoints:e.points}:null}},{key:"repeat",value:function(e,i){for(var l=e.length%2!==0?[].concat(D(e),[0]):e,o=[],c=0;c<i;++c)o=[].concat(D(o),D(l));return o}},{key:"renderDotItem",value:function(e,i){var l;if(b.isValidElement(e))l=b.cloneElement(e,i);else if(bt(e))l=e(i);else{var o=i.key,c=at(i,Ct),d=rt("recharts-line-dot",typeof e!="boolean"?e.className:"");l=b.createElement(jt,$({key:o},c,{className:d}))}return l}}])}(k.PureComponent);S(R,"displayName","Line");S(R,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Dt.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});S(R,"getComposedData",function(t){var r=t.props,a=t.xAxis,e=t.yAxis,i=t.xAxisTicks,l=t.yAxisTicks,o=t.dataKey,c=t.bandSize,d=t.displayedData,h=t.offset,y=r.layout,v=d.map(function(p,f){var u=ot(p,o);return y==="horizontal"?{x:Q({axis:a,ticks:i,bandSize:c,entry:p,index:f}),y:H(u)?null:e.scale(u),value:u,payload:p}:{x:H(u)?null:a.scale(u),y:Q({axis:e,ticks:l,bandSize:c,entry:p,index:f}),value:u,payload:p}});return A({points:v,layout:y},h)});var Ut=st({chartName:"LineChart",GraphicalChild:R,axisComponents:[{axisType:"xAxis",AxisComp:M},{axisType:"yAxis",AxisComp:Y}],formatAxisMap:lt}),Vt=st({chartName:"BarChart",GraphicalChild:ct,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:M},{axisType:"yAxis",AxisComp:Y}],formatAxisMap:lt});function ae(){const[t,r]=k.useState([]),[a,e]=k.useState(!0),[i,l]=k.useState(null),[o,c]=k.useState(new Date().getFullYear()),[d,h]=k.useState([]);k.useEffect(()=>{y(),v()},[o]);const y=async()=>{var s,m;try{const g=localStorage.getItem("token"),P=await J.get(`/api/seller/sales-report/${o}`,{headers:{Authorization:`Bearer ${g}`}});r(P.data.sales||[])}catch(g){console.error("Error fetching sales report:",g),l(((m=(s=g.response)==null?void 0:s.data)==null?void 0:m.message)||"Failed to fetch sales report")}finally{e(!1)}},v=async()=>{try{const s=localStorage.getItem("token"),m=await J.get("/api/seller/best-selling",{headers:{Authorization:`Bearer ${s}`}});h(m.data.products||[])}catch(s){console.error("Error fetching best selling products:",s)}},p=["يناير","فبراير","مارس","إبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"];if(a)return n.jsx("div",{className:"flex justify-center items-center min-h-[400px]",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})});if(i)return n.jsxs("div",{className:"text-red-600 text-center",children:[n.jsx("p",{className:"text-xl font-semibold mb-2",children:"خطأ"}),n.jsx("p",{children:i})]});const f=t.reduce((s,m)=>s+m.revenue,0),u=t.reduce((s,m)=>s+m.total_sales,0),x=f/t.filter(s=>s.revenue>0).length||0;return n.jsxs(n.Fragment,{children:[n.jsx(ft,{children:n.jsx("title",{children:"تقرير المبيعات (بائع)"})}),n.jsxs("div",{className:"animate-fadeIn p-6 max-w-7xl mx-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-8",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"تقرير المبيعات"}),n.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"تحليل أداء المبيعات والإيرادات"})]}),n.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-lg border border-gray-200 px-3 py-2",children:[n.jsx(yt,{className:"h-5 w-5 text-gray-400"}),n.jsx("select",{value:o,onChange:s=>c(Number(s.target.value)),className:"border-0 py-1 text-gray-900 focus:ring-0 text-sm",children:[...Array(5)].map((s,m)=>{const g=new Date().getFullYear()-m;return n.jsx("option",{value:g,children:g},g)})})]})]}),n.jsxs("div",{className:"grid gap-6 md:grid-cols-3 mb-8",children:[n.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:n.jsx(vt,{className:"h-6 w-6 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-500",children:"إجمالي الإيرادات"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[f.toLocaleString()," ر.س"]})]})]})}),n.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:n.jsx(xt,{className:"h-6 w-6 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-500",children:"إجمالي المبيعات"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[u.toLocaleString()," قطعة"]})]})]})}),n.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:n.jsx(gt,{className:"h-6 w-6 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-500",children:"متوسط الإيرادات الشهرية"}),n.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[x.toLocaleString()," ر.س"]})]})]})})]}),n.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-8",children:[n.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[n.jsx("h3",{className:"text-lg font-semibold mb-6",children:"الإيرادات الشهرية"}),n.jsx("div",{className:"h-[300px]",children:n.jsx(Z,{width:"100%",height:"100%",children:n.jsxs(Ut,{data:t,children:[n.jsx(tt,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),n.jsx(M,{dataKey:"month",tickFormatter:s=>p[s-1],stroke:"#6B7280"}),n.jsx(Y,{stroke:"#6B7280",tickFormatter:s=>`${s.toLocaleString()} ر.س`}),n.jsx(et,{formatter:s=>[`${s.toLocaleString()} ر.س`,"الإيرادات"],labelFormatter:s=>p[s-1],contentStyle:{textAlign:"right",direction:"rtl"}}),n.jsx(R,{type:"monotone",dataKey:"revenue",stroke:"#4F46E5",strokeWidth:2,dot:{fill:"#4F46E5",strokeWidth:2},activeDot:{r:6,fill:"#4F46E5"}})]})})})]}),n.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[n.jsx("h3",{className:"text-lg font-semibold mb-6",children:"المبيعات الشهرية"}),n.jsx("div",{className:"h-[300px]",children:n.jsx(Z,{width:"100%",height:"100%",children:n.jsxs(Vt,{data:t,children:[n.jsx(tt,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),n.jsx(M,{dataKey:"month",tickFormatter:s=>p[s-1],stroke:"#6B7280"}),n.jsx(Y,{stroke:"#6B7280",tickFormatter:s=>`${s} قطعة`}),n.jsx(et,{formatter:s=>[`${s} قطعة`,"المبيعات"],labelFormatter:s=>p[s-1],contentStyle:{textAlign:"right",direction:"rtl"}}),n.jsx(ct,{dataKey:"total_sales",fill:"#10B981",radius:[4,4,0,0]})]})})})]})]})]})]})}export{ae as default};
