import{r as l,d as C,c as I,j as e,a as P}from"./index-Dn0qhe6D.js";import{I as g}from"./Input-CPFVIBKQ.js";import{B as R}from"./Button-BtIySsyH.js";import{X as B}from"./x-BxmEdPPq.js";import{K as E}from"./key-round-BNV82ixm.js";import"./createLucideIcon-BBubB0Ge.js";const F=()=>{const[c,j]=l.useState(""),[o,v]=l.useState(""),[u,w]=l.useState(""),[x,f]=l.useState(""),[p,a]=l.useState(""),[n,r]=l.useState(!1),{token:y}=C(),t=I(),i=!!localStorage.getItem("token"),N=()=>{const s=localStorage.getItem("userRole");t(s==="seller"?"/seller":s==="user"?"/user":s==="admin"?"/admin":"/login")},S=async s=>{var h,b;if(s.preventDefault(),a(""),f(""),r(!0),i&&!c){a("يرجى إدخال كلمة المرور الحالية"),r(!1);return}if(!o||!u){a("يرجى تعبئة جميع الحقول"),r(!1);return}if(o!==u){a("كلمات المرور غير متطابقة"),r(!1);return}if(o.length<8){a("يجب أن تكون كلمة المرور 8 أحرف على الأقل"),r(!1);return}try{const d=localStorage.getItem("token"),k=await P.post("/api/auth/reset-password",{token:y||d,password:o,...i&&{currentPassword:c}},{headers:d?{Authorization:`Bearer ${d}`}:{}});f(k.data.message||"تم تغيير كلمة المرور بنجاح"),setTimeout(()=>{const m=localStorage.getItem("userRole");t(m==="seller"?"/seller":m==="user"?"/user":m==="admin"?"/admin":"/login")},2e3)}catch(d){a(((b=(h=d.response)==null?void 0:h.data)==null?void 0:b.message)||"حدث خطأ أثناء تغيير كلمة المرور")}finally{r(!1)}};return e.jsx("div",{className:"fixed inset-0 flex flex-col justify-center items-center bg-gray-900/30 backdrop-blur-md px-4 py-12 sm:px-6 lg:px-8",children:e.jsx("div",{className:"w-full max-w-md relative",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow-2xl sm:rounded-2xl sm:px-10",children:[e.jsx("button",{onClick:N,className:"absolute top-4 left-4 text-gray-400 hover:text-gray-500 transition-colors",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsxs("form",{className:"space-y-6",onSubmit:S,dir:"rtl",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"bg-indigo-100 p-3 rounded-full",children:e.jsx(E,{className:"text-indigo-600",size:32})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:i?"تغيير كلمة المرور":"إعادة تعيين كلمة المرور"}),e.jsx("p",{className:"text-gray-600 text-center",children:i?"قم بإدخال كلمة المرور الحالية والجديدة":"أدخل كلمة المرور الجديدة"})]}),x&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg",children:x}),p&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg",children:p}),e.jsxs("div",{className:"space-y-4",children:[i&&e.jsx("div",{children:e.jsx(g,{type:"password",placeholder:"كلمة المرور الحالية",value:c,onChange:s=>j(s.target.value),className:"w-full",disabled:n})}),e.jsx("div",{children:e.jsx(g,{type:"password",placeholder:"كلمة المرور الجديدة",value:o,onChange:s=>v(s.target.value),className:"w-full",disabled:n})}),e.jsx("div",{children:e.jsx(g,{type:"password",placeholder:"تأكيد كلمة المرور",value:u,onChange:s=>w(s.target.value),className:"w-full",disabled:n})})]}),e.jsx(R,{type:"submit",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",disabled:n,children:n?"جاري التغيير...":"تغيير كلمة المرور"})]})]})})})};export{F as default};
